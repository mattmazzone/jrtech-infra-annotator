var Po=r=>{throw TypeError(r)};var Ri=(r,e,t)=>e.has(r)||Po("Cannot "+t);var be=(r,e,t)=>(Ri(r,e,"read from private field"),t?t.call(r):e.get(r)),bt=(r,e,t)=>e.has(r)?Po("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Ve=(r,e,t,s)=>(Ri(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),wt=(r,e,t)=>(Ri(r,e,"access private method"),t);var Mo=(r,e,t,s)=>({set _(n){Ve(r,e,n,t)},get _(){return be(r,e,s)}});import{i as $r,p as Xa,F as Kt,s as Et,r as ui,t as _e,g as qr,o as Hr,e as Ya,a as sr,w as Ae,b as mt,c as Ka,d as et,f as U,h as z,j as tt,u as y,n as De,k as id,l as Za,m as Ja,q as gn,v as rd,x as L,y as ht,z as dt,C as Qa,A as ee,B as od,D as N,E as I,G as P,H as $,I as R,J as Bt,K as zr,L as Ke,M as mn,T as ad,N as ft,O as qt,P as ld,Q as fe,R as yn,S as hi,U as Ur,V as el,W as bs,X as tl,Y as tn,Z as cd,_ as pe,$ as ut,a0 as dd,a1 as sl,a2 as Mt,a3 as vn,a4 as ne,a5 as ud,a6 as Pn,a7 as nr,a8 as Do,a9 as hd}from"./index-DdILXSVa.js";function Io(r){return typeof r=="string"?`'${r}'`:new fd().serialize(r)}const fd=function(){class r{#e=new Map;compare(t,s){const n=typeof t,i=typeof s;return n==="string"&&i==="string"?t.localeCompare(s):n==="number"&&i==="number"?t-s:String.prototype.localeCompare.call(this.serialize(t,!0),this.serialize(s,!0))}serialize(t,s){if(t===null)return"null";switch(typeof t){case"string":return s?t:`'${t}'`;case"bigint":return`${t}n`;case"object":return this.$object(t);case"function":return this.$function(t)}return String(t)}serializeObject(t){const s=Object.prototype.toString.call(t);if(s!=="[object Object]")return this.serializeBuiltInType(s.length<10?`unknown:${s}`:s.slice(8,-1),t);const n=t.constructor,i=n===Object||n===void 0?"":n.name;if(i!==""&&globalThis[i]===n)return this.serializeBuiltInType(i,t);if(typeof t.toJSON=="function"){const o=t.toJSON();return i+(o!==null&&typeof o=="object"?this.$object(o):`(${this.serialize(o)})`)}return this.serializeObjectEntries(i,Object.entries(t))}serializeBuiltInType(t,s){const n=this["$"+t];if(n)return n.call(this,s);if(typeof s?.entries=="function")return this.serializeObjectEntries(t,s.entries());throw new Error(`Cannot serialize ${t}`)}serializeObjectEntries(t,s){const n=Array.from(s).sort((o,a)=>this.compare(o[0],a[0]));let i=`${t}{`;for(let o=0;o<n.length;o++){const[a,l]=n[o];i+=`${this.serialize(a,!0)}:${this.serialize(l)}`,o<n.length-1&&(i+=",")}return i+"}"}$object(t){let s=this.#e.get(t);return s===void 0&&(this.#e.set(t,`#${this.#e.size}`),s=this.serializeObject(t),this.#e.set(t,s)),s}$function(t){const s=Function.prototype.toString.call(t);return s.slice(-15)==="[native code] }"?`${t.name||""}()[native]`:`${t.name}(${t.length})${s.replace(/\s*\n\s*/g,"")}`}$Array(t){let s="[";for(let n=0;n<t.length;n++)s+=this.serialize(t[n]),n<t.length-1&&(s+=",");return s+"]"}$Date(t){try{return`Date(${t.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(t){return`ArrayBuffer[${new Uint8Array(t).join(",")}]`}$Set(t){return`Set${this.$Array(Array.from(t).sort((s,n)=>this.compare(s,n)))}`}$Map(t){return this.serializeObjectEntries("Map",t.entries())}}for(const e of["Error","RegExp","URL"])r.prototype["$"+e]=function(t){return`${e}(${t})`};for(const e of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])r.prototype["$"+e]=function(t){return`${e}[${t.join(",")}]`};for(const e of["BigInt64Array","BigUint64Array"])r.prototype["$"+e]=function(t){return`${e}[${t.join("n,")}${t.length>0?"n":""}]`};return r}();function rn(r,e){return r===e||Io(r)===Io(e)}function Be(r,e){const t=typeof r=="string"&&!e?`${r}Context`:e,s=Symbol(t);return[o=>{const a=$r(s,o);if(a||a===null)return a;throw new Error(`Injection \`${s.toString()}\` not found. Component must be used within ${Array.isArray(r)?`one of the following components: ${r.join(", ")}`:`\`${r}\``}`)},o=>(Xa(s,o),o)]}function Xe(){let r=document.activeElement;if(r==null)return null;for(;r!=null&&r.shadowRoot!=null&&r.shadowRoot.activeElement!=null;)r=r.shadowRoot.activeElement;return r}function nl(r,e,t){const s=t.originalEvent.target,n=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),s.dispatchEvent(n)}function ir(r){return r==null}function rr(r,e){return ir(r)?!1:Array.isArray(r)?r.some(t=>rn(t,e)):rn(r,e)}function jr(r){return r?r.flatMap(e=>e.type===Kt?jr(e.children):[e]):[]}const pd=["INPUT","TEXTAREA"];function il(r,e,t,s={}){if(!e||s.enableIgnoredElement&&pd.includes(e.nodeName))return null;const{arrowKeyOptions:n="both",attributeName:i="[data-reka-collection-item]",itemsArray:o=[],loop:a=!0,dir:l="ltr",preventScroll:c=!0,focus:d=!1}=s,[u,h,f,p,g,m]=[r.key==="ArrowRight",r.key==="ArrowLeft",r.key==="ArrowUp",r.key==="ArrowDown",r.key==="Home",r.key==="End"],v=f||p,_=u||h;if(!g&&!m&&(!v&&!_||n==="vertical"&&_||n==="horizontal"&&v))return null;const w=t?Array.from(t.querySelectorAll(i)):o;if(!w.length)return null;c&&r.preventDefault();let x=null;return _||v?x=rl(w,e,{goForward:v?p:l==="ltr"?u:h,loop:a}):g?x=w.at(0)||null:m&&(x=w.at(-1)||null),d&&x?.focus(),x}function rl(r,e,t,s=r.length){if(--s===0)return null;const n=r.indexOf(e),i=t.goForward?n+1:n-1;if(!t.loop&&(i<0||i>=r.length))return null;const o=(i+r.length)%r.length,a=r[o];return a?a.hasAttribute("disabled")&&a.getAttribute("disabled")!=="false"?rl(r,a,t,s):a:null}const[ol,jw]=Be("ConfigProvider");function gd(r,e){var t;const s=Et();return et(()=>{s.value=r()},{...e,flush:(t=void 0)!=null?t:"sync"}),ui(s)}function bn(r){return qr()?(Hr(r),!0):!1}function md(){const r=new Set,e=i=>{r.delete(i)};return{on:i=>{r.add(i);const o=()=>e(i);return bn(o),{off:o}},off:e,trigger:(...i)=>Promise.all(Array.from(r).map(o=>o(...i))),clear:()=>{r.clear()}}}function yd(r){let e=!1,t;const s=Ya(!0);return(...n)=>(e||(t=s.run(()=>r(...n)),e=!0),t)}function al(r){let e=0,t,s;const n=()=>{e-=1,s&&e<=0&&(s.stop(),t=void 0,s=void 0)};return(...i)=>(e+=1,s||(s=Ya(!0),t=s.run(()=>r(...i))),bn(n),t)}const Ht=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const vd=r=>typeof r<"u",bd=Object.prototype.toString,wd=r=>bd.call(r)==="[object Object]",Ro=_d();function _d(){var r,e;return Ht&&((r=window?.navigator)==null?void 0:r.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window?.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window?.navigator.userAgent))}function Ad(r){return mt()}function Oi(r){return Array.isArray(r)?r:[r]}function ll(r,e=1e4){return Ka((t,s)=>{let n=_e(r),i;const o=()=>setTimeout(()=>{n=_e(r),s()},_e(e));return bn(()=>{clearTimeout(i)}),{get(){return t(),n},set(a){n=a,s(),clearTimeout(i),i=o()}}})}const xd=_e;function Sd(r,e){Ad()&&sr(r,e)}function cl(r,e,t={}){const{immediate:s=!0,immediateCallback:n=!1}=t,i=Et(!1);let o=null;function a(){o&&(clearTimeout(o),o=null)}function l(){i.value=!1,a()}function c(...d){n&&r(),a(),i.value=!0,o=setTimeout(()=>{i.value=!1,o=null,r(...d)},_e(e))}return s&&(i.value=!0,Ht&&c()),bn(l),{isPending:ui(i),start:c,stop:l}}function Cd(r,e,t){return Ae(r,e,{...t,immediate:!0})}const Vr=Ht?window:void 0;function fs(r){var e;const t=_e(r);return(e=t?.$el)!=null?e:t}function cs(...r){const e=[],t=()=>{e.forEach(a=>a()),e.length=0},s=(a,l,c,d)=>(a.addEventListener(l,c,d),()=>a.removeEventListener(l,c,d)),n=z(()=>{const a=Oi(_e(r[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),i=Cd(()=>{var a,l;return[(l=(a=n.value)==null?void 0:a.map(c=>fs(c)))!=null?l:[Vr].filter(c=>c!=null),Oi(_e(n.value?r[1]:r[0])),Oi(y(n.value?r[2]:r[1])),_e(n.value?r[3]:r[2])]},([a,l,c,d])=>{if(t(),!a?.length||!l?.length||!c?.length)return;const u=wd(d)?{...d}:d;e.push(...a.flatMap(h=>l.flatMap(f=>c.map(p=>s(h,f,p,u)))))},{flush:"post"}),o=()=>{i(),t()};return bn(t),o}function Ed(){const r=Et(!1),e=mt();return e&&tt(()=>{r.value=!0},e),r}function Td(r){return typeof r=="function"?r:typeof r=="string"?e=>e.key===r:Array.isArray(r)?e=>r.includes(e.key):()=>!0}function kd(...r){let e,t,s={};r.length===3?(e=r[0],t=r[1],s=r[2]):r.length===2?typeof r[1]=="object"?(e=!0,t=r[0],s=r[1]):(e=r[0],t=r[1]):(e=!0,t=r[0]);const{target:n=Vr,eventName:i="keydown",passive:o=!1,dedupe:a=!1}=s,l=Td(e);return cs(n,i,d=>{d.repeat&&_e(a)||l(d)&&t(d)},o)}function Pd(r){return JSON.parse(JSON.stringify(r))}function ss(r,e,t,s={}){var n,i,o;const{clone:a=!1,passive:l=!1,eventName:c,deep:d=!1,defaultValue:u,shouldEmit:h}=s,f=mt(),p=t||f?.emit||((n=f?.$emit)==null?void 0:n.bind(f))||((o=(i=f?.proxy)==null?void 0:i.$emit)==null?void 0:o.bind(f?.proxy));let g=c;e||(e="modelValue"),g=g||`update:${e.toString()}`;const m=w=>a?typeof a=="function"?a(w):Pd(w):w,v=()=>vd(r[e])?m(r[e]):u,_=w=>{h?h(w)&&p(g,w):p(g,w)};if(l){const w=v(),x=U(w);let S=!1;return Ae(()=>r[e],b=>{S||(S=!0,x.value=m(b),De(()=>S=!1))}),Ae(x,b=>{!S&&(b!==r[e]||d)&&_(b)},{deep:d}),x}else return z({get(){return v()},set(w){_(w)}})}function Li(r){if(r===null||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in r?!1:Symbol.toStringTag in r?Object.prototype.toString.call(r)==="[object Module]":!0}function or(r,e,t=".",s){if(!Li(e))return or(r,{},t,s);const n=Object.assign({},e);for(const i in r){if(i==="__proto__"||i==="constructor")continue;const o=r[i];o!=null&&(s&&s(n,i,o,t)||(Array.isArray(o)&&Array.isArray(n[i])?n[i]=[...o,...n[i]]:Li(o)&&Li(n[i])?n[i]=or(o,n[i],(t?`${t}.`:"")+i.toString(),s):n[i]=o))}return n}function Md(r){return(...e)=>e.reduce((t,s)=>or(t,s,"",r),{})}const Dd=Md(),Id=al(()=>{const r=U(new Map),e=U(),t=z(()=>{for(const o of r.value.values())if(o)return!0;return!1}),s=ol({scrollBody:U(!0)});let n=null;const i=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=e.value??"",Ro&&n?.(),e.value=void 0};return Ae(t,(o,a)=>{if(!Ht)return;if(!o){a&&i();return}e.value===void 0&&(e.value=document.body.style.overflow);const l=window.innerWidth-document.documentElement.clientWidth,c={padding:l,margin:0},d=s.scrollBody?.value?typeof s.scrollBody.value=="object"?Dd({padding:s.scrollBody.value.padding===!0?l:s.scrollBody.value.padding,margin:s.scrollBody.value.margin===!0?l:s.scrollBody.value.margin},c):c:{padding:0,margin:0};l>0&&(document.body.style.paddingRight=typeof d.padding=="number"?`${d.padding}px`:String(d.padding),document.body.style.marginRight=typeof d.margin=="number"?`${d.margin}px`:String(d.margin),document.documentElement.style.setProperty("--scrollbar-width",`${l}px`),document.body.style.overflow="hidden"),Ro&&(n=cs(document,"touchmove",u=>Rd(u),{passive:!1})),De(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),r});function dl(r){const e=Math.random().toString(36).substring(2,7),t=Id();t.value.set(e,r??!1);const s=z({get:()=>t.value.get(e)??!1,set:n=>t.value.set(e,n)});return Sd(()=>{t.value.delete(e)}),s}function ul(r){const e=window.getComputedStyle(r);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&r.clientWidth<r.scrollWidth||e.overflowY==="auto"&&r.clientHeight<r.scrollHeight)return!0;{const t=r.parentNode;return!(t instanceof Element)||t.tagName==="BODY"?!1:ul(t)}}function Rd(r){const e=r||window.event,t=e.target;return t instanceof Element&&ul(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.cancelable&&e.preventDefault(),!1)}function fi(r){const e=ol({dir:U("ltr")});return z(()=>r?.value||e.dir?.value||"ltr")}function wn(r){const e=mt(),t=e?.type.emits,s={};return t?.length||console.warn(`No emitted event found. Please check component: ${e?.type.__name}`),t?.forEach(n=>{s[id(Za(n))]=(...i)=>r(n,...i)}),s}let Fi=0;function Od(){et(r=>{if(!Ht)return;const e=document.querySelectorAll("[data-reka-focus-guard]");document.body.insertAdjacentElement("afterbegin",e[0]??Oo()),document.body.insertAdjacentElement("beforeend",e[1]??Oo()),Fi++,r(()=>{Fi===1&&document.querySelectorAll("[data-reka-focus-guard]").forEach(t=>t.remove()),Fi--})})}function Oo(){const r=document.createElement("span");return r.setAttribute("data-reka-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}function Ld(r){return z(()=>xd(r)?!!fs(r)?.closest("form"):!0)}function le(){const r=mt(),e=U(),t=z(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:fs(e)),s=Object.assign({},r.exposed),n={};for(const o in r.props)Object.defineProperty(n,o,{enumerable:!0,configurable:!0,get:()=>r.props[o]});if(Object.keys(s).length>0)for(const o in s)Object.defineProperty(n,o,{enumerable:!0,configurable:!0,get:()=>s[o]});Object.defineProperty(n,"$el",{enumerable:!0,configurable:!0,get:()=>r.vnode.el}),r.exposed=n;function i(o){e.value=o,o&&(Object.defineProperty(n,"$el",{enumerable:!0,configurable:!0,get:()=>o instanceof Element?o:o.$el}),r.exposed=n)}return{forwardRef:i,currentRef:e,currentElement:t}}function ps(r){const e=mt(),t=Object.keys(e?.type.props??{}).reduce((n,i)=>{const o=(e?.type.props[i]).default;return o!==void 0&&(n[i]=o),n},{}),s=Ja(r);return z(()=>{const n={},i=e?.vnode.props??{};return Object.keys(i).forEach(o=>{n[Za(o)]=i[o]}),Object.keys({...t,...n}).reduce((o,a)=>(s.value[a]!==void 0&&(o[a]=s.value[a]),o),{})})}function st(r,e){const t=ps(r),s=e?wn(e):{};return z(()=>({...t.value,...s}))}function Fd(r,e){const t=ll(!1,300),s=U(null),n=md();function i(){s.value=null,t.value=!1}function o(a,l){const c=a.currentTarget,d={x:a.clientX,y:a.clientY},u=Bd(d,c.getBoundingClientRect()),h=Nd(d,u),f=$d(l.getBoundingClientRect()),p=Hd([...h,...f]);s.value=p,t.value=!0}return et(a=>{if(r.value&&e.value){const l=d=>o(d,e.value),c=d=>o(d,r.value);r.value.addEventListener("pointerleave",l),e.value.addEventListener("pointerleave",c),a(()=>{r.value?.removeEventListener("pointerleave",l),e.value?.removeEventListener("pointerleave",c)})}}),et(a=>{if(s.value){const l=c=>{if(!s.value||!(c.target instanceof HTMLElement))return;const d=c.target,u={x:c.clientX,y:c.clientY},h=r.value?.contains(d)||e.value?.contains(d),f=!qd(u,s.value),p=!!d.closest("[data-grace-area-trigger]");h?i():(f||p)&&(i(),n.trigger())};r.value?.ownerDocument.addEventListener("pointermove",l),a(()=>r.value?.ownerDocument.removeEventListener("pointermove",l))}}),{isPointerInTransit:t,onPointerExit:n.on}}function Bd(r,e){const t=Math.abs(e.top-r.y),s=Math.abs(e.bottom-r.y),n=Math.abs(e.right-r.x),i=Math.abs(e.left-r.x);switch(Math.min(t,s,n,i)){case i:return"left";case n:return"right";case t:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function Nd(r,e,t=5){const s=[];switch(e){case"top":s.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":s.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":s.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":s.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return s}function $d(r){const{top:e,right:t,bottom:s,left:n}=r;return[{x:n,y:e},{x:t,y:e},{x:t,y:s},{x:n,y:s}]}function qd(r,e){const{x:t,y:s}=r;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,d=e[o].y;l>s!=d>s&&t<(c-a)*(s-l)/(d-l)+a&&(n=!n)}return n}function Hd(r){const e=r.slice();return e.sort((t,s)=>t.x<s.x?-1:t.x>s.x?1:t.y<s.y?-1:t.y>s.y?1:0),zd(e)}function zd(r){if(r.length<=1)return r.slice();const e=[];for(let s=0;s<r.length;s++){const n=r[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))e.pop();else break}e.push(n)}e.pop();const t=[];for(let s=r.length-1;s>=0;s--){const n=r[s];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(n.y-o.y)>=(i.y-o.y)*(n.x-o.x))t.pop();else break}t.push(n)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var Ud=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},ws=new WeakMap,Mn=new WeakMap,Dn={},Bi=0,hl=function(r){return r&&(r.host||hl(r.parentNode))},jd=function(r,e){return e.map(function(t){if(r.contains(t))return t;var s=hl(t);return s&&r.contains(s)?s:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},Vd=function(r,e,t,s){var n=jd(e,Array.isArray(r)?r:[r]);Dn[t]||(Dn[t]=new WeakMap);var i=Dn[t],o=[],a=new Set,l=new Set(n),c=function(u){!u||a.has(u)||(a.add(u),c(u.parentNode))};n.forEach(c);var d=function(u){!u||l.has(u)||Array.prototype.forEach.call(u.children,function(h){if(a.has(h))d(h);else try{var f=h.getAttribute(s),p=f!==null&&f!=="false",g=(ws.get(h)||0)+1,m=(i.get(h)||0)+1;ws.set(h,g),i.set(h,m),o.push(h),g===1&&p&&Mn.set(h,!0),m===1&&h.setAttribute(t,"true"),p||h.setAttribute(s,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return d(e),a.clear(),Bi++,function(){o.forEach(function(u){var h=ws.get(u)-1,f=i.get(u)-1;ws.set(u,h),i.set(u,f),h||(Mn.has(u)||u.removeAttribute(s),Mn.delete(u)),f||u.removeAttribute(t)}),Bi--,Bi||(ws=new WeakMap,ws=new WeakMap,Mn=new WeakMap,Dn={})}},Wd=function(r,e,t){t===void 0&&(t="data-aria-hidden");var s=Array.from(Array.isArray(r)?r:[r]),n=Ud(r);return n?(s.push.apply(s,Array.from(n.querySelectorAll("[aria-live], script"))),Vd(s,n,t,"aria-hidden")):function(){return null}};function fl(r){let e;Ae(()=>fs(r),t=>{t?e=Wd(t):e&&e()}),gn(()=>{e&&e()})}function Zt(r,e="reka"){return`${e}-${rd?.()}`}function Gd(r){const e=U(),t=z(()=>e.value?.width??0),s=z(()=>e.value?.height??0);return tt(()=>{const n=fs(r);if(n){e.value={width:n.offsetWidth,height:n.offsetHeight};const i=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const a=o[0];let l,c;if("borderBoxSize"in a){const d=a.borderBoxSize,u=Array.isArray(d)?d[0]:d;l=u.inlineSize,c=u.blockSize}else l=n.offsetWidth,c=n.offsetHeight;e.value={width:l,height:c}});return i.observe(n,{box:"border-box"}),()=>i.unobserve(n)}else e.value=void 0}),{width:t,height:s}}function Xd(r,e){const t=U(r);function s(i){return e[t.value][i]??t.value}return{state:t,dispatch:i=>{t.value=s(i)}}}function Yd(r){const e=ll("",1e3);return{search:e,handleTypeaheadSearch:(n,i)=>{e.value=e.value+n;{const o=Xe(),a=i.map(h=>({...h,textValue:h.value?.textValue??h.ref.textContent?.trim()??""})),l=a.find(h=>h.ref===o),c=a.map(h=>h.textValue),d=Zd(c,e.value,l?.textValue),u=a.find(h=>h.textValue===d);return u&&u.ref.focus(),u?.ref}},resetTypeahead:()=>{e.value=""}}}function Kd(r,e){return r.map((t,s)=>r[(e+s)%r.length])}function Zd(r,e,t){const n=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let o=Kd(r,Math.max(i,0));n.length===1&&(o=o.filter(c=>c!==t));const l=o.find(c=>c.toLowerCase().startsWith(n.toLowerCase()));return l!==t?l:void 0}function Jd(r,e){const t=U({}),s=U("none"),n=U(r),i=r.value?"mounted":"unmounted";let o;const a=e.value?.ownerDocument.defaultView??Vr,{state:l,dispatch:c}=Xd(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),d=m=>{if(Ht){const v=new CustomEvent(m,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(v)}};Ae(r,async(m,v)=>{const _=v!==m;if(await De(),_){const w=s.value,x=In(e.value);m?(c("MOUNT"),d("enter"),x==="none"&&d("after-enter")):x==="none"||x==="undefined"||t.value?.display==="none"?(c("UNMOUNT"),d("leave"),d("after-leave")):v&&w!==x?(c("ANIMATION_OUT"),d("leave")):(c("UNMOUNT"),d("after-leave"))}},{immediate:!0});const u=m=>{const v=In(e.value),_=v.includes(m.animationName),w=l.value==="mounted"?"enter":"leave";if(m.target===e.value&&_&&(d(`after-${w}`),c("ANIMATION_END"),!n.value)){const x=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",o=a?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=x)})}m.target===e.value&&v==="none"&&c("ANIMATION_END")},h=m=>{m.target===e.value&&(s.value=In(e.value))},f=Ae(e,(m,v)=>{m?(t.value=getComputedStyle(m),m.addEventListener("animationstart",h),m.addEventListener("animationcancel",u),m.addEventListener("animationend",u)):(c("ANIMATION_END"),o!==void 0&&a?.clearTimeout(o),v?.removeEventListener("animationstart",h),v?.removeEventListener("animationcancel",u),v?.removeEventListener("animationend",u))},{immediate:!0}),p=Ae(l,()=>{const m=In(e.value);s.value=l.value==="mounted"?m:"none"});return gn(()=>{f(),p()}),{isPresent:z(()=>["mounted","unmountSuspended"].includes(l.value))}}function In(r){return r&&getComputedStyle(r).animationName||"none"}var $s=L({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(r,{slots:e,expose:t}){const{present:s,forceMount:n}=ht(r),i=U(),{isPresent:o}=Jd(s,i);t({present:o});let a=e.default({present:o.value});a=jr(a||[]);const l=mt();if(a&&a?.length>1){const c=l?.parent?.type.name?`<${l.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${c}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(d=>`  - ${d}`).join(`
`)].join(`
`))}return()=>n.value||s.value||o.value?dt(e.default({present:o.value})[0],{ref:c=>{const d=fs(c);return typeof d?.hasAttribute>"u"||(d?.hasAttribute("data-reka-popper-content-wrapper")?i.value=d.firstElementChild:i.value=d),d}}):null}});const ar=L({name:"PrimitiveSlot",inheritAttrs:!1,setup(r,{attrs:e,slots:t}){return()=>{if(!t.default)return null;const s=jr(t.default()),n=s.findIndex(l=>l.type!==Qa);if(n===-1)return s;const i=s[n];delete i.props?.ref;const o=i.props?ee(e,i.props):e,a=od({...i,props:{}},o);return s.length===1?a:(s[n]=a,s)}}}),Qd=["area","img","input"],ve=L({name:"Primitive",inheritAttrs:!1,props:{asChild:{type:Boolean,default:!1},as:{type:[String,Object],default:"div"}},setup(r,{attrs:e,slots:t}){const s=r.asChild?"template":r.as;return typeof s=="string"&&Qd.includes(s)?()=>dt(s,e):s!=="template"?()=>dt(r.as,e,{default:t.default}):()=>dt(ar,e,{default:t.default})}});function lr(){const r=U(),e=z(()=>["#text","#comment"].includes(r.value?.$el.nodeName)?r.value?.$el.nextElementSibling:fs(r));return{primitiveElement:r,currentElement:e}}const[pl,eu]=Be("CollapsibleRoot");var tu=L({__name:"CollapsibleRoot",props:{defaultOpen:{type:Boolean,required:!1,default:!1},open:{type:Boolean,required:!1,default:void 0},disabled:{type:Boolean,required:!1},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:open"],setup(r,{expose:e,emit:t}){const s=r,i=ss(s,"open",t,{defaultValue:s.defaultOpen,passive:s.open===void 0}),{disabled:o,unmountOnHide:a}=ht(s);return eu({contentId:"",disabled:o,open:i,unmountOnHide:a,onOpenToggle:()=>{o.value||(i.value=!i.value)}}),e({open:i}),le(),(l,c)=>(I(),N(y(ve),{as:l.as,"as-child":s.asChild,"data-state":y(i)?"open":"closed","data-disabled":y(o)?"":void 0},{default:P(()=>[$(l.$slots,"default",{open:y(i)})]),_:3},8,["as","as-child","data-state","data-disabled"]))}}),su=tu,nu=L({inheritAttrs:!1,__name:"CollapsibleContent",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["contentFound"],setup(r,{emit:e}){const t=r,s=e,n=pl();n.contentId||=Zt(void 0,"reka-collapsible-content");const i=U(),{forwardRef:o,currentElement:a}=le(),l=U(0),c=U(0),d=z(()=>n.open.value),u=U(d.value),h=U();Ae(()=>[d.value,i.value?.present],async()=>{await De();const p=a.value;if(!p)return;h.value=h.value||{transitionDuration:p.style.transitionDuration,animationName:p.style.animationName},p.style.transitionDuration="0s",p.style.animationName="none";const g=p.getBoundingClientRect();c.value=g.height,l.value=g.width,u.value||(p.style.transitionDuration=h.value.transitionDuration,p.style.animationName=h.value.animationName)},{immediate:!0});const f=z(()=>u.value&&n.open.value);return tt(()=>{requestAnimationFrame(()=>{u.value=!1})}),cs(a,"beforematch",p=>{requestAnimationFrame(()=>{n.onOpenToggle(),s("contentFound")})}),(p,g)=>(I(),N(y($s),{ref_key:"presentRef",ref:i,present:p.forceMount||y(n).open.value,"force-mount":!0},{default:P(({present:m})=>[R(y(ve),ee(p.$attrs,{id:y(n).contentId,ref:y(o),"as-child":t.asChild,as:p.as,hidden:m?void 0:y(n).unmountOnHide.value?"":"until-found","data-state":f.value?void 0:y(n).open.value?"open":"closed","data-disabled":y(n).disabled?.value?"":void 0,style:{"--reka-collapsible-content-height":`${c.value}px`,"--reka-collapsible-content-width":`${l.value}px`}}),{default:P(()=>[!y(n).unmountOnHide.value||m?$(p.$slots,"default",{key:0}):Bt("v-if",!0)]),_:2},1040,["id","as-child","as","hidden","data-state","data-disabled","style"])]),_:3},8,["present"]))}}),iu=nu,ru=L({__name:"CollapsibleTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r;le();const t=pl();return(s,n)=>(I(),N(y(ve),{type:s.as==="button"?"button":void 0,as:s.as,"as-child":e.asChild,"aria-controls":y(t).contentId,"aria-expanded":y(t).open.value,"data-state":y(t).open.value?"open":"closed","data-disabled":y(t).disabled?.value?"":void 0,disabled:y(t).disabled?.value,onClick:y(t).onOpenToggle},{default:P(()=>[$(s.$slots,"default")]),_:3},8,["type","as","as-child","aria-controls","aria-expanded","data-state","data-disabled","disabled","onClick"]))}}),ou=ru;function au({type:r,defaultValue:e,modelValue:t}){const s=t||e;return t!==void 0||e!==void 0?Array.isArray(s)?"multiple":"single":r??"single"}function lu({type:r,defaultValue:e,modelValue:t}){return r||au({type:r,defaultValue:e,modelValue:t})}function cu({type:r,defaultValue:e}){return e!==void 0?e:r==="single"?void 0:[]}function du(r,e){const t=z(()=>lu(r)),s=ss(r,"modelValue",e,{defaultValue:cu(r),passive:r.modelValue===void 0,deep:!0});function n(o){if(t.value==="single")s.value=rn(o,s.value)?void 0:o;else{const a=Array.isArray(s.value)?[...s.value||[]]:[s.value].filter(Boolean);if(rr(a,o)){const l=a.findIndex(c=>rn(c,o));a.splice(l,1)}else a.push(o);s.value=a}}const i=z(()=>t.value==="single");return{modelValue:s,changeModelValue:n,isSingle:i}}const[pi,uu]=Be("AccordionRoot");var hu=L({__name:"AccordionRoot",props:{collapsible:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1},dir:{type:String,required:!1},orientation:{type:String,required:!1,default:"vertical"},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},type:{type:String,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,{dir:n,disabled:i,unmountOnHide:o}=ht(t),a=fi(n),{modelValue:l,changeModelValue:c,isSingle:d}=du(t,s),{forwardRef:u,currentElement:h}=le();return uu({disabled:i,direction:a,orientation:t.orientation,parentElement:h,isSingle:d,collapsible:t.collapsible,modelValue:l,changeModelValue:c,unmountOnHide:o}),(f,p)=>(I(),N(y(ve),{ref:y(u),"as-child":f.asChild,as:f.as},{default:P(()=>[$(f.$slots,"default",{modelValue:y(l)})]),_:3},8,["as-child","as"]))}}),fu=hu,cr=function(r){return r.Open="open",r.Closed="closed",r}(cr||{});const[Wr,pu]=Be("AccordionItem");var gu=L({__name:"AccordionItem",props:{disabled:{type:Boolean,required:!1},value:{type:String,required:!0},unmountOnHide:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r,{expose:e}){const t=r,s=pi(),n=z(()=>s.isSingle.value?t.value===s.modelValue.value:Array.isArray(s.modelValue.value)&&s.modelValue.value.includes(t.value)),i=z(()=>s.disabled.value||t.disabled),o=z(()=>i.value?"":void 0),a=z(()=>n.value?cr.Open:cr.Closed);e({open:n,dataDisabled:o});const{currentRef:l,currentElement:c}=le();pu({open:n,dataState:a,disabled:i,dataDisabled:o,triggerId:"",currentRef:l,currentElement:c,value:z(()=>t.value)});function d(u){const h=u.target;if(Array.from(s.parentElement.value?.querySelectorAll("[data-reka-collection-item]")??[]).findIndex(g=>g===h)===-1)return null;il(u,h,s.parentElement.value,{arrowKeyOptions:s.orientation,dir:s.direction.value,focus:!0})}return(u,h)=>(I(),N(y(su),{"data-orientation":y(s).orientation,"data-disabled":o.value,"data-state":a.value,disabled:i.value,open:n.value,as:t.as,"as-child":t.asChild,"unmount-on-hide":y(s).unmountOnHide.value,onKeydown:zr(d,["up","down","left","right","home","end"])},{default:P(()=>[$(u.$slots,"default",{open:n.value})]),_:3},8,["data-orientation","data-disabled","data-state","disabled","open","as","as-child","unmount-on-hide"]))}}),mu=gu,yu=L({__name:"AccordionContent",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=pi(),s=Wr();return le(),(n,i)=>(I(),N(y(iu),{role:"region","as-child":e.asChild,as:n.as,"force-mount":e.forceMount,"aria-labelledby":y(s).triggerId,"data-state":y(s).dataState.value,"data-disabled":y(s).dataDisabled.value,"data-orientation":y(t).orientation,style:{"--reka-accordion-content-width":"var(--reka-collapsible-content-width)","--reka-accordion-content-height":"var(--reka-collapsible-content-height)"},onContentFound:i[0]||(i[0]=o=>y(t).changeModelValue(y(s).value.value))},{default:P(()=>[$(n.$slots,"default")]),_:3},8,["as-child","as","force-mount","aria-labelledby","data-state","data-disabled","data-orientation"]))}}),vu=yu,bu=L({__name:"AccordionHeader",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h3"}},setup(r){const e=r,t=pi(),s=Wr();return le(),(n,i)=>(I(),N(y(ve),{as:e.as,"as-child":e.asChild,"data-orientation":y(t).orientation,"data-state":y(s).dataState.value,"data-disabled":y(s).dataDisabled.value},{default:P(()=>[$(n.$slots,"default")]),_:3},8,["as","as-child","data-orientation","data-state","data-disabled"]))}}),wu=bu,_u=L({__name:"AccordionTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=pi(),s=Wr();s.triggerId||=Zt(void 0,"reka-accordion-trigger");function n(){const i=t.isSingle.value&&s.open.value&&!t.collapsible;s.disabled.value||i||t.changeModelValue(s.value.value)}return(i,o)=>(I(),N(y(ou),{id:y(s).triggerId,ref:y(s).currentRef,"data-reka-collection-item":"",as:e.as,"as-child":e.asChild,"aria-disabled":y(s).disabled.value||void 0,"aria-expanded":y(s).open.value||!1,"data-disabled":y(s).dataDisabled.value,"data-orientation":y(t).orientation,"data-state":y(s).dataState.value,disabled:y(s).disabled.value,onClick:n},{default:P(()=>[$(i.$slots,"default")]),_:3},8,["id","as","as-child","aria-disabled","aria-expanded","data-disabled","data-orientation","data-state","disabled"]))}}),Au=_u;const[zt,xu]=Be("DialogRoot");var Su=L({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,n=ss(t,"open",e,{defaultValue:t.defaultOpen,passive:t.open===void 0}),i=U(),o=U(),{modal:a}=ht(t);return xu({open:n,modal:a,openModal:()=>{n.value=!0},onOpenChange:l=>{n.value=l},onOpenToggle:()=>{n.value=!n.value},contentId:"",titleId:"",descriptionId:"",triggerElement:i,contentElement:o}),(l,c)=>$(l.$slots,"default",{open:y(n),close:()=>n.value=!1})}}),Cu=Su,Eu=L({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r;le();const t=zt();return(s,n)=>(I(),N(y(ve),ee(e,{type:s.as==="button"?"button":void 0,onClick:n[0]||(n[0]=i=>y(t).onOpenChange(!1))}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["type"]))}}),Tu=Eu;const ku="dismissableLayer.pointerDownOutside",Pu="dismissableLayer.focusOutside";function gl(r,e){const t=e.closest("[data-dismissable-layer]"),s=r.dataset.dismissableLayer===""?r:r.querySelector("[data-dismissable-layer]"),n=Array.from(r.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(t&&(s===t||n.indexOf(s)<n.indexOf(t)))}function Mu(r,e,t=!0){const s=e?.value?.ownerDocument??globalThis?.document,n=U(!1),i=U(()=>{});return et(o=>{if(!Ht||!_e(t))return;const a=async c=>{const d=c.target;if(!(!e?.value||!d)){if(gl(e.value,d)){n.value=!1;return}if(c.target&&!n.value){let h=function(){nl(ku,r,u)};const u={originalEvent:c};c.pointerType==="touch"?(s.removeEventListener("click",i.value),i.value=h,s.addEventListener("click",i.value,{once:!0})):h()}else s.removeEventListener("click",i.value);n.value=!1}},l=window.setTimeout(()=>{s.addEventListener("pointerdown",a)},0);o(()=>{window.clearTimeout(l),s.removeEventListener("pointerdown",a),s.removeEventListener("click",i.value)})}),{onPointerDownCapture:()=>{_e(t)&&(n.value=!0)}}}function Du(r,e,t=!0){const s=e?.value?.ownerDocument??globalThis?.document,n=U(!1);return et(i=>{if(!Ht||!_e(t))return;const o=async a=>{if(!e?.value)return;await De(),await De();const l=a.target;!e.value||!l||gl(e.value,l)||a.target&&!n.value&&nl(Pu,r,{originalEvent:a})};s.addEventListener("focusin",o),i(()=>s.removeEventListener("focusin",o))}),{onFocusCapture:()=>{_e(t)&&(n.value=!0)},onBlurCapture:()=>{_e(t)&&(n.value=!1)}}}const It=Ke({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set});var Iu=L({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(r,{emit:e}){const t=r,s=e,{forwardRef:n,currentElement:i}=le(),o=z(()=>i.value?.ownerDocument??globalThis.document),a=z(()=>It.layersRoot),l=z(()=>i.value?Array.from(a.value).indexOf(i.value):-1),c=z(()=>It.layersWithOutsidePointerEventsDisabled.size>0),d=z(()=>{const p=Array.from(a.value),[g]=[...It.layersWithOutsidePointerEventsDisabled].slice(-1),m=p.indexOf(g);return l.value>=m}),u=Mu(async p=>{const g=[...It.branches].some(m=>m?.contains(p.target));!d.value||g||(s("pointerDownOutside",p),s("interactOutside",p),await De(),p.defaultPrevented||s("dismiss"))},i),h=Du(p=>{[...It.branches].some(m=>m?.contains(p.target))||(s("focusOutside",p),s("interactOutside",p),p.defaultPrevented||s("dismiss"))},i);kd("Escape",p=>{l.value===a.value.size-1&&(s("escapeKeyDown",p),p.defaultPrevented||s("dismiss"))});let f;return et(p=>{i.value&&(t.disableOutsidePointerEvents&&(It.layersWithOutsidePointerEventsDisabled.size===0&&(f=o.value.body.style.pointerEvents,o.value.body.style.pointerEvents="none"),It.layersWithOutsidePointerEventsDisabled.add(i.value)),a.value.add(i.value),p(()=>{t.disableOutsidePointerEvents&&It.layersWithOutsidePointerEventsDisabled.size===1&&(o.value.body.style.pointerEvents=f)}))}),et(p=>{p(()=>{i.value&&(a.value.delete(i.value),It.layersWithOutsidePointerEventsDisabled.delete(i.value))})}),(p,g)=>(I(),N(y(ve),{ref:y(n),"as-child":p.asChild,as:p.as,"data-dismissable-layer":"",style:mn({pointerEvents:c.value?d.value?"auto":"none":void 0}),onFocusCapture:y(h).onFocusCapture,onBlurCapture:y(h).onBlurCapture,onPointerdownCapture:y(u).onPointerDownCapture},{default:P(()=>[$(p.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),Gr=Iu;const Ru=yd(()=>U([]));function Ou(){const r=Ru();return{add(e){const t=r.value[0];e!==t&&t?.pause(),r.value=Lo(r.value,e),r.value.unshift(e)},remove(e){r.value=Lo(r.value,e),r.value[0]?.resume()}}}function Lo(r,e){const t=[...r],s=t.indexOf(e);return s!==-1&&t.splice(s,1),t}function Lu(r){return r.filter(e=>e.tagName!=="A")}const Ni="focusScope.autoFocusOnMount",$i="focusScope.autoFocusOnUnmount",Fo={bubbles:!1,cancelable:!0};function Fu(r,{select:e=!1}={}){const t=Xe();for(const s of r)if(Vt(s,{select:e}),Xe()!==t)return!0}function Bu(r){const e=ml(r),t=Bo(e,r),s=Bo(e.reverse(),r);return[t,s]}function ml(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const n=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||n?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Bo(r,e){for(const t of r)if(!Nu(t,{upTo:e}))return t}function Nu(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function $u(r){return r instanceof HTMLInputElement&&"select"in r}function Vt(r,{select:e=!1}={}){if(r&&r.focus){const t=Xe();r.focus({preventScroll:!0}),r!==t&&$u(r)&&e&&r.select()}}var qu=L({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(r,{emit:e}){const t=r,s=e,{currentRef:n,currentElement:i}=le(),o=U(null),a=Ou(),l=Ke({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});et(d=>{if(!Ht)return;const u=i.value;if(!t.trapped)return;function h(m){if(l.paused||!u)return;const v=m.target;u.contains(v)?o.value=v:Vt(o.value,{select:!0})}function f(m){if(l.paused||!u)return;const v=m.relatedTarget;v!==null&&(u.contains(v)||Vt(o.value,{select:!0}))}function p(m){u.contains(o.value)||Vt(u)}document.addEventListener("focusin",h),document.addEventListener("focusout",f);const g=new MutationObserver(p);u&&g.observe(u,{childList:!0,subtree:!0}),d(()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",f),g.disconnect()})}),et(async d=>{const u=i.value;if(await De(),!u)return;a.add(l);const h=Xe();if(!u.contains(h)){const p=new CustomEvent(Ni,Fo);u.addEventListener(Ni,g=>s("mountAutoFocus",g)),u.dispatchEvent(p),p.defaultPrevented||(Fu(Lu(ml(u)),{select:!0}),Xe()===h&&Vt(u))}d(()=>{u.removeEventListener(Ni,m=>s("mountAutoFocus",m));const p=new CustomEvent($i,Fo),g=m=>{s("unmountAutoFocus",m)};u.addEventListener($i,g),u.dispatchEvent(p),setTimeout(()=>{p.defaultPrevented||Vt(h??document.body,{select:!0}),u.removeEventListener($i,g),a.remove(l)},0)})});function c(d){if(!t.loop&&!t.trapped||l.paused)return;const u=d.key==="Tab"&&!d.altKey&&!d.ctrlKey&&!d.metaKey,h=Xe();if(u&&h){const f=d.currentTarget,[p,g]=Bu(f);p&&g?!d.shiftKey&&h===g?(d.preventDefault(),t.loop&&Vt(p,{select:!0})):d.shiftKey&&h===p&&(d.preventDefault(),t.loop&&Vt(g,{select:!0})):h===f&&d.preventDefault()}}return(d,u)=>(I(),N(y(ve),{ref_key:"currentRef",ref:n,tabindex:"-1","as-child":d.asChild,as:d.as,onKeydown:c},{default:P(()=>[$(d.$slots,"default")]),_:3},8,["as-child","as"]))}}),yl=qu;const Hu="menu.itemSelect",dr=["Enter"," "],zu=["ArrowDown","PageUp","Home"],vl=["ArrowUp","PageDown","End"],Uu=[...zu,...vl];[...dr],[...dr];function bl(r){return r?"open":"closed"}function ju(r){const e=Xe();for(const t of r)if(t===e||(t.focus(),Xe()!==e))return}function Vu(r,e){const{x:t,y:s}=r;let n=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,d=e[o].y;l>s!=d>s&&t<(c-a)*(s-l)/(d-l)+a&&(n=!n)}return n}function Wu(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return Vu(t,e)}function ur(r){return r.pointerType==="mouse"}var Gu=L({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=zt(),{forwardRef:i,currentElement:o}=le();return n.titleId||=Zt(void 0,"reka-dialog-title"),n.descriptionId||=Zt(void 0,"reka-dialog-description"),tt(()=>{n.contentElement=o,Xe()!==document.body&&(n.triggerElement.value=Xe())}),(a,l)=>(I(),N(y(yl),{"as-child":"",loop:"",trapped:t.trapFocus,onMountAutoFocus:l[5]||(l[5]=c=>s("openAutoFocus",c)),onUnmountAutoFocus:l[6]||(l[6]=c=>s("closeAutoFocus",c))},{default:P(()=>[R(y(Gr),ee({id:y(n).contentId,ref:y(i),as:a.as,"as-child":a.asChild,"disable-outside-pointer-events":a.disableOutsidePointerEvents,role:"dialog","aria-describedby":y(n).descriptionId,"aria-labelledby":y(n).titleId,"data-state":y(bl)(y(n).open.value)},a.$attrs,{onDismiss:l[0]||(l[0]=c=>y(n).onOpenChange(!1)),onEscapeKeyDown:l[1]||(l[1]=c=>s("escapeKeyDown",c)),onFocusOutside:l[2]||(l[2]=c=>s("focusOutside",c)),onInteractOutside:l[3]||(l[3]=c=>s("interactOutside",c)),onPointerDownOutside:l[4]||(l[4]=c=>s("pointerDownOutside",c))}),{default:P(()=>[$(a.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),wl=Gu,Xu=L({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=zt(),i=wn(s),{forwardRef:o,currentElement:a}=le();return fl(a),(l,c)=>(I(),N(wl,ee({...t,...y(i)},{ref:y(o),"trap-focus":y(n).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:c[0]||(c[0]=d=>{d.defaultPrevented||(d.preventDefault(),y(n).triggerElement.value?.focus())}),onPointerDownOutside:c[1]||(c[1]=d=>{const u=d.detail.originalEvent,h=u.button===0&&u.ctrlKey===!0;(u.button===2||h)&&d.preventDefault()}),onFocusOutside:c[2]||(c[2]=d=>{d.preventDefault()})}),{default:P(()=>[$(l.$slots,"default")]),_:3},16,["trap-focus"]))}}),Yu=Xu,Ku=L({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=wn(e);le();const i=zt(),o=U(!1),a=U(!1);return(l,c)=>(I(),N(wl,ee({...t,...y(n)},{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:c[0]||(c[0]=d=>{d.defaultPrevented||(o.value||y(i).triggerElement.value?.focus(),d.preventDefault()),o.value=!1,a.value=!1}),onInteractOutside:c[1]||(c[1]=d=>{d.defaultPrevented||(o.value=!0,d.detail.originalEvent.type==="pointerdown"&&(a.value=!0));const u=d.target;y(i).triggerElement.value?.contains(u)&&d.preventDefault(),d.detail.originalEvent.type==="focusin"&&a.value&&d.preventDefault()})}),{default:P(()=>[$(l.$slots,"default")]),_:3},16))}}),Zu=Ku,Ju=L({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=zt(),i=wn(s),{forwardRef:o}=le();return(a,l)=>(I(),N(y($s),{present:a.forceMount||y(n).open.value},{default:P(()=>[y(n).modal.value?(I(),N(Yu,ee({key:0,ref:y(o)},{...t,...y(i),...a.$attrs}),{default:P(()=>[$(a.$slots,"default")]),_:3},16)):(I(),N(Zu,ee({key:1,ref:y(o)},{...t,...y(i),...a.$attrs}),{default:P(()=>[$(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Qu=Ju,eh=L({__name:"DialogDescription",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"p"}},setup(r){const e=r;le();const t=zt();return(s,n)=>(I(),N(y(ve),ee(e,{id:y(t).descriptionId}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["id"]))}}),th=eh,sh=L({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=zt();return dl(!0),le(),(t,s)=>(I(),N(y(ve),{as:t.as,"as-child":t.asChild,"data-state":y(e).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:P(()=>[$(t.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),nh=sh,ih=L({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=zt(),{forwardRef:t}=le();return(s,n)=>y(e)?.modal.value?(I(),N(y($s),{key:0,present:s.forceMount||y(e).open.value},{default:P(()=>[R(nh,ee(s.$attrs,{ref:y(t),as:s.as,"as-child":s.asChild}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):Bt("v-if",!0)}}),rh=ih,oh=L({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=Ed();return(t,s)=>y(e)||t.forceMount?(I(),N(ad,{key:0,to:t.to,disabled:t.disabled,defer:t.defer},[$(t.$slots,"default")],8,["to","disabled","defer"])):Bt("v-if",!0)}}),Xr=oh,ah=L({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(y(Xr),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),lh=ah,ch=L({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(r){const e=r,t=zt();return le(),(s,n)=>(I(),N(y(ve),ee(e,{id:y(t).titleId}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["id"]))}}),dh=ch;const No="data-reka-collection-item";function Yr(r={}){const{key:e="",isProvider:t=!1}=r,s=`${e}CollectionProvider`;let n;if(t){const d=U(new Map);n={collectionRef:U(),itemMap:d},Xa(s,n)}else n=$r(s);const i=(d=!1)=>{const u=n.collectionRef.value;if(!u)return[];const h=Array.from(u.querySelectorAll(`[${No}]`)),p=Array.from(n.itemMap.value.values()).sort((g,m)=>h.indexOf(g.ref)-h.indexOf(m.ref));return d?p:p.filter(g=>g.ref.dataset.disabled!=="")},o=L({name:"CollectionSlot",setup(d,{slots:u}){const{primitiveElement:h,currentElement:f}=lr();return Ae(f,()=>{n.collectionRef.value=f.value}),()=>dt(ar,{ref:h},u)}}),a=L({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(d,{slots:u,attrs:h}){const{primitiveElement:f,currentElement:p}=lr();return et(g=>{if(p.value){const m=ld(p.value);n.itemMap.value.set(m,{ref:p.value,value:d.value}),g(()=>n.itemMap.value.delete(m))}}),()=>dt(ar,{...h,[No]:"",ref:f},u)}}),l=z(()=>Array.from(n.itemMap.value.values())),c=z(()=>n.itemMap.value.size);return{getItems:i,reactiveItems:l,itemMapSize:c,CollectionSlot:o,CollectionItem:a}}const uh="rovingFocusGroup.onEntryFocus",hh={bubbles:!1,cancelable:!0},fh={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ph(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function gh(r,e,t){const s=ph(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return fh[s]}function _l(r,e=!1){const t=Xe();for(const s of r)if(s===t||(s.focus({preventScroll:e}),Xe()!==t))return}function mh(r,e){return r.map((t,s)=>r[(e+s)%r.length])}const[yh,vh]=Be("RovingFocusGroup");var bh=L({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(r,{expose:e,emit:t}){const s=r,n=t,{loop:i,orientation:o,dir:a}=ht(s),l=fi(a),c=ss(s,"currentTabStopId",n,{defaultValue:s.defaultCurrentTabStopId,passive:s.currentTabStopId===void 0}),d=U(!1),u=U(!1),h=U(0),{getItems:f,CollectionSlot:p}=Yr({isProvider:!0});function g(v){const _=!u.value;if(v.currentTarget&&v.target===v.currentTarget&&_&&!d.value){const w=new CustomEvent(uh,hh);if(v.currentTarget.dispatchEvent(w),n("entryFocus",w),!w.defaultPrevented){const x=f().map(C=>C.ref).filter(C=>C.dataset.disabled!==""),S=x.find(C=>C.getAttribute("data-active")===""),b=x.find(C=>C.getAttribute("data-highlighted")===""),A=x.find(C=>C.id===c.value),E=[S,b,A,...x].filter(Boolean);_l(E,s.preventScrollOnEntryFocus)}}u.value=!1}function m(){setTimeout(()=>{u.value=!1},1)}return e({getItems:f}),vh({loop:i,dir:l,orientation:o,currentTabStopId:c,onItemFocus:v=>{c.value=v},onItemShiftTab:()=>{d.value=!0},onFocusableItemAdd:()=>{h.value++},onFocusableItemRemove:()=>{h.value--}}),(v,_)=>(I(),N(y(p),null,{default:P(()=>[R(y(ve),{tabindex:d.value||h.value===0?-1:0,"data-orientation":y(o),as:v.as,"as-child":v.asChild,dir:y(l),style:{outline:"none"},onMousedown:_[0]||(_[0]=w=>u.value=!0),onMouseup:m,onFocus:g,onBlur:_[1]||(_[1]=w=>d.value=!1)},{default:P(()=>[$(v.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),wh=bh,_h=L({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=r,t=yh(),s=Zt(),n=z(()=>e.tabStopId||s),i=z(()=>t.currentTabStopId.value===n.value),{getItems:o,CollectionItem:a}=Yr();tt(()=>{e.focusable&&t.onFocusableItemAdd()}),gn(()=>{e.focusable&&t.onFocusableItemRemove()});function l(c){if(c.key==="Tab"&&c.shiftKey){t.onItemShiftTab();return}if(c.target!==c.currentTarget)return;const d=gh(c,t.orientation.value,t.dir.value);if(d!==void 0){if(c.metaKey||c.ctrlKey||c.altKey||!e.allowShiftKey&&c.shiftKey)return;c.preventDefault();let u=[...o().map(h=>h.ref).filter(h=>h.dataset.disabled!=="")];if(d==="last")u.reverse();else if(d==="prev"||d==="next"){d==="prev"&&u.reverse();const h=u.indexOf(c.currentTarget);u=t.loop.value?mh(u,h+1):u.slice(h+1)}De(()=>_l(u))}}return(c,d)=>(I(),N(y(a),null,{default:P(()=>[R(y(ve),{tabindex:i.value?0:-1,"data-orientation":y(t).orientation.value,"data-active":c.active?"":void 0,"data-disabled":c.focusable?void 0:"",as:c.as,"as-child":c.asChild,onMousedown:d[0]||(d[0]=u=>{c.focusable?y(t).onItemFocus(n.value):u.preventDefault()}),onFocus:d[1]||(d[1]=u=>y(t).onItemFocus(n.value)),onKeydown:l},{default:P(()=>[$(c.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),Ah=_h,xh=L({__name:"VisuallyHidden",props:{feature:{type:String,required:!1,default:"focusable"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){return(e,t)=>(I(),N(y(ve),{as:e.as,"as-child":e.asChild,"aria-hidden":e.feature==="focusable"?"true":void 0,"data-hidden":e.feature==="fully-hidden"?"":void 0,tabindex:e.feature==="fully-hidden"?"-1":void 0,style:{position:"absolute",border:0,width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",whiteSpace:"nowrap",wordWrap:"normal"}},{default:P(()=>[$(e.$slots,"default")]),_:3},8,["as","as-child","aria-hidden","data-hidden","tabindex"]))}}),Al=xh,Sh=L({inheritAttrs:!1,__name:"VisuallyHiddenInputBubble",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(r){const e=r,{primitiveElement:t,currentElement:s}=lr(),n=z(()=>e.checked??e.value);return Ae(n,(i,o)=>{if(!s.value)return;const a=s.value,l=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(l,"value").set;if(d&&i!==o){const u=new Event("input",{bubbles:!0}),h=new Event("change",{bubbles:!0});d.call(a,i),a.dispatchEvent(u),a.dispatchEvent(h)}}),(i,o)=>(I(),N(Al,ee({ref_key:"primitiveElement",ref:t},{...e,...i.$attrs},{as:"input"}),null,16))}}),$o=Sh,Ch=L({inheritAttrs:!1,__name:"VisuallyHiddenInput",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(r){const e=r,t=z(()=>typeof e.value=="object"&&Array.isArray(e.value)&&e.value.length===0&&e.required),s=z(()=>typeof e.value=="string"||typeof e.value=="number"||typeof e.value=="boolean"||e.value===null||e.value===void 0?[{name:e.name,value:e.value}]:typeof e.value=="object"&&Array.isArray(e.value)?e.value.flatMap((n,i)=>typeof n=="object"?Object.entries(n).map(([o,a])=>({name:`${e.name}[${i}][${o}]`,value:a})):{name:`${e.name}[${i}]`,value:n}):e.value!==null&&typeof e.value=="object"&&!Array.isArray(e.value)?Object.entries(e.value).map(([n,i])=>({name:`${e.name}[${n}]`,value:i})):[]);return(n,i)=>(I(),fe(Kt,null,[Bt(" We render single input if it's required "),t.value?(I(),N($o,ee({key:n.name},{...e,...n.$attrs},{name:n.name,value:n.value}),null,16,["name","value"])):(I(!0),fe(Kt,{key:1},yn(s.value,o=>(I(),N($o,ee({key:o.name},{ref_for:!0},{...e,...n.$attrs},{name:o.name,value:o.value}),null,16,["name","value"]))),128))],2112))}}),Eh=Ch;const[Th,Vw]=Be("CheckboxGroupRoot");function ei(r){return r==="indeterminate"}function xl(r){return ei(r)?"indeterminate":r?"checked":"unchecked"}const[kh,Ph]=Be("CheckboxRoot");var Mh=L({inheritAttrs:!1,__name:"CheckboxRoot",props:{defaultValue:{type:[Boolean,String],required:!1},modelValue:{type:[Boolean,String,null],required:!1,default:void 0},disabled:{type:Boolean,required:!1},value:{type:null,required:!1,default:"on"},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,{forwardRef:n,currentElement:i}=le(),o=Th(null),a=ss(t,"modelValue",s,{defaultValue:t.defaultValue,passive:t.modelValue===void 0}),l=z(()=>o?.disabled.value||t.disabled),c=z(()=>ir(o?.modelValue.value)?a.value==="indeterminate"?"indeterminate":a.value:rr(o.modelValue.value,t.value));function d(){if(ir(o?.modelValue.value))a.value=ei(a.value)?!0:!a.value;else{const f=[...o.modelValue.value||[]];if(rr(f,t.value)){const p=f.findIndex(g=>rn(g,t.value));f.splice(p,1)}else f.push(t.value);o.modelValue.value=f}}const u=Ld(i),h=z(()=>t.id&&i.value?document.querySelector(`[for="${t.id}"]`)?.innerText:void 0);return Ph({disabled:l,state:c}),(f,p)=>(I(),N(Ur(y(o)?.rovingFocus.value?y(Ah):y(ve)),ee(f.$attrs,{id:f.id,ref:y(n),role:"checkbox","as-child":f.asChild,as:f.as,type:f.as==="button"?"button":void 0,"aria-checked":y(ei)(c.value)?"mixed":c.value,"aria-required":f.required,"aria-label":f.$attrs["aria-label"]||h.value,"data-state":y(xl)(c.value),"data-disabled":l.value?"":void 0,disabled:l.value,focusable:y(o)?.rovingFocus.value?!l.value:void 0,onKeydown:zr(hi(()=>{},["prevent"]),["enter"]),onClick:d}),{default:P(()=>[$(f.$slots,"default",{modelValue:y(a),state:c.value}),y(u)&&f.name&&!y(o)?(I(),N(y(Eh),{key:0,type:"checkbox",checked:!!c.value,name:f.name,value:f.value,disabled:l.value,required:f.required},null,8,["checked","name","value","disabled","required"])):Bt("v-if",!0)]),_:3},16,["id","as-child","as","type","aria-checked","aria-required","aria-label","data-state","data-disabled","disabled","focusable","onKeydown"]))}}),Dh=Mh,Ih=L({__name:"CheckboxIndicator",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const{forwardRef:e}=le(),t=kh();return(s,n)=>(I(),N(y($s),{present:s.forceMount||y(ei)(y(t).state.value)||y(t).state.value===!0},{default:P(()=>[R(y(ve),ee({ref:y(e),"data-state":y(xl)(y(t).state.value),"data-disabled":y(t).disabled.value?"":void 0,style:{pointerEvents:"none"},"as-child":s.asChild,as:s.as},s.$attrs),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["data-state","data-disabled","as-child","as"])]),_:3},8,["present"]))}}),Rh=Ih;const[Sl,Oh]=Be("PopperRoot");var Lh=L({inheritAttrs:!1,__name:"PopperRoot",setup(r){const e=U();return Oh({anchor:e,onAnchorChange:t=>e.value=t}),(t,s)=>$(t.$slots,"default")}}),Cl=Lh,Fh=L({__name:"PopperAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,{forwardRef:t,currentElement:s}=le(),n=Sl();return el(()=>{n.onAnchorChange(e.reference??s.value)}),(i,o)=>(I(),N(y(ve),{ref:y(t),as:i.as,"as-child":i.asChild},{default:P(()=>[$(i.$slots,"default")]),_:3},8,["as","as-child"]))}}),El=Fh;const Bh={key:0,d:"M0 0L6 6L12 0"},Nh={key:1,d:"M0 0L4.58579 4.58579C5.36683 5.36683 6.63316 5.36684 7.41421 4.58579L12 0"};var $h=L({__name:"Arrow",props:{width:{type:Number,required:!1,default:10},height:{type:Number,required:!1,default:5},rounded:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"svg"}},setup(r){const e=r;return le(),(t,s)=>(I(),N(y(ve),ee(e,{width:t.width,height:t.height,viewBox:t.asChild?void 0:"0 0 12 6",preserveAspectRatio:t.asChild?void 0:"none"}),{default:P(()=>[$(t.$slots,"default",{},()=>[t.rounded?(I(),fe("path",Nh)):(I(),fe("path",Bh))])]),_:3},16,["width","height","viewBox","preserveAspectRatio"]))}}),qh=$h;function Hh(r){return r!==null}function zh(r){return{name:"transformOrigin",options:r,fn(e){const{placement:t,rects:s,middlewareData:n}=e,o=n.arrow?.centerOffset!==0,a=o?0:r.arrowWidth,l=o?0:r.arrowHeight,[c,d]=hr(t),u={start:"0%",center:"50%",end:"100%"}[d],h=(n.arrow?.x??0)+a/2,f=(n.arrow?.y??0)+l/2;let p="",g="";return c==="bottom"?(p=o?u:`${h}px`,g=`${-l}px`):c==="top"?(p=o?u:`${h}px`,g=`${s.floating.height+l}px`):c==="right"?(p=`${-l}px`,g=o?u:`${f}px`):c==="left"&&(p=`${s.floating.width+l}px`,g=o?u:`${f}px`),{data:{x:p,y:g}}}}}function hr(r){const[e,t="center"]=r.split("-");return[e,t]}const Uh=["top","right","bottom","left"],Jt=Math.min,Je=Math.max,ti=Math.round,Rn=Math.floor,Tt=r=>({x:r,y:r}),jh={left:"right",right:"left",bottom:"top",top:"bottom"},Vh={start:"end",end:"start"};function fr(r,e,t){return Je(r,Jt(e,t))}function Nt(r,e){return typeof r=="function"?r(e):r}function $t(r){return r.split("-")[0]}function qs(r){return r.split("-")[1]}function Kr(r){return r==="x"?"y":"x"}function Zr(r){return r==="y"?"height":"width"}const Wh=new Set(["top","bottom"]);function Ct(r){return Wh.has($t(r))?"y":"x"}function Jr(r){return Kr(Ct(r))}function Gh(r,e,t){t===void 0&&(t=!1);const s=qs(r),n=Jr(r),i=Zr(n);let o=n==="x"?s===(t?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=si(o)),[o,si(o)]}function Xh(r){const e=si(r);return[pr(r),e,pr(e)]}function pr(r){return r.replace(/start|end/g,e=>Vh[e])}const qo=["left","right"],Ho=["right","left"],Yh=["top","bottom"],Kh=["bottom","top"];function Zh(r,e,t){switch(r){case"top":case"bottom":return t?e?Ho:qo:e?qo:Ho;case"left":case"right":return e?Yh:Kh;default:return[]}}function Jh(r,e,t,s){const n=qs(r);let i=Zh($t(r),t==="start",s);return n&&(i=i.map(o=>o+"-"+n),e&&(i=i.concat(i.map(pr)))),i}function si(r){return r.replace(/left|right|bottom|top/g,e=>jh[e])}function Qh(r){return{top:0,right:0,bottom:0,left:0,...r}}function Tl(r){return typeof r!="number"?Qh(r):{top:r,right:r,bottom:r,left:r}}function ni(r){const{x:e,y:t,width:s,height:n}=r;return{width:s,height:n,top:t,left:e,right:e+s,bottom:t+n,x:e,y:t}}function zo(r,e,t){let{reference:s,floating:n}=r;const i=Ct(e),o=Jr(e),a=Zr(o),l=$t(e),c=i==="y",d=s.x+s.width/2-n.width/2,u=s.y+s.height/2-n.height/2,h=s[a]/2-n[a]/2;let f;switch(l){case"top":f={x:d,y:s.y-n.height};break;case"bottom":f={x:d,y:s.y+s.height};break;case"right":f={x:s.x+s.width,y:u};break;case"left":f={x:s.x-n.width,y:u};break;default:f={x:s.x,y:s.y}}switch(qs(e)){case"start":f[o]-=h*(t&&c?-1:1);break;case"end":f[o]+=h*(t&&c?-1:1);break}return f}const ef=async(r,e,t)=>{const{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:r,floating:e,strategy:n}),{x:d,y:u}=zo(c,s,l),h=s,f={},p=0;for(let g=0;g<a.length;g++){const{name:m,fn:v}=a[g],{x:_,y:w,data:x,reset:S}=await v({x:d,y:u,initialPlacement:s,placement:h,strategy:n,middlewareData:f,rects:c,platform:o,elements:{reference:r,floating:e}});d=_??d,u=w??u,f={...f,[m]:{...f[m],...x}},S&&p<=50&&(p++,typeof S=="object"&&(S.placement&&(h=S.placement),S.rects&&(c=S.rects===!0?await o.getElementRects({reference:r,floating:e,strategy:n}):S.rects),{x:d,y:u}=zo(c,h,l)),g=-1)}return{x:d,y:u,placement:h,strategy:n,middlewareData:f}};async function on(r,e){var t;e===void 0&&(e={});const{x:s,y:n,platform:i,rects:o,elements:a,strategy:l}=r,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:f=0}=Nt(e,r),p=Tl(f),m=a[h?u==="floating"?"reference":"floating":u],v=ni(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(m)))==null||t?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),_=u==="floating"?{x:s,y:n,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),x=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},S=ni(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:w,strategy:l}):_);return{top:(v.top-S.top+p.top)/x.y,bottom:(S.bottom-v.bottom+p.bottom)/x.y,left:(v.left-S.left+p.left)/x.x,right:(S.right-v.right+p.right)/x.x}}const tf=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:s,placement:n,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:d=0}=Nt(r,e)||{};if(c==null)return{};const u=Tl(d),h={x:t,y:s},f=Jr(n),p=Zr(f),g=await o.getDimensions(c),m=f==="y",v=m?"top":"left",_=m?"bottom":"right",w=m?"clientHeight":"clientWidth",x=i.reference[p]+i.reference[f]-h[f]-i.floating[p],S=h[f]-i.reference[f],b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let A=b?b[w]:0;(!A||!await(o.isElement==null?void 0:o.isElement(b)))&&(A=a.floating[w]||i.floating[p]);const E=x/2-S/2,C=A/2-g[p]/2-1,k=Jt(u[v],C),D=Jt(u[_],C),q=k,Y=A-g[p]-D,F=A/2-g[p]/2+E,G=fr(q,F,Y),B=!l.arrow&&qs(n)!=null&&F!==G&&i.reference[p]/2-(F<q?k:D)-g[p]/2<0,j=B?F<q?F-q:F-Y:0;return{[f]:h[f]+j,data:{[f]:G,centerOffset:F-G-j,...B&&{alignmentOffset:j}},reset:B}}}),sf=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,s;const{placement:n,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...m}=Nt(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const v=$t(n),_=Ct(a),w=$t(a)===a,x=await(l.isRTL==null?void 0:l.isRTL(c.floating)),S=h||(w||!g?[si(a)]:Xh(a)),b=p!=="none";!h&&b&&S.push(...Jh(a,g,p,x));const A=[a,...S],E=await on(e,m),C=[];let k=((s=i.flip)==null?void 0:s.overflows)||[];if(d&&C.push(E[v]),u){const F=Gh(n,o,x);C.push(E[F[0]],E[F[1]])}if(k=[...k,{placement:n,overflows:C}],!C.every(F=>F<=0)){var D,q;const F=(((D=i.flip)==null?void 0:D.index)||0)+1,G=A[F];if(G&&(!(u==="alignment"?_!==Ct(G):!1)||k.every(T=>Ct(T.placement)===_?T.overflows[0]>0:!0)))return{data:{index:F,overflows:k},reset:{placement:G}};let B=(q=k.filter(j=>j.overflows[0]<=0).sort((j,T)=>j.overflows[1]-T.overflows[1])[0])==null?void 0:q.placement;if(!B)switch(f){case"bestFit":{var Y;const j=(Y=k.filter(T=>{if(b){const M=Ct(T.placement);return M===_||M==="y"}return!0}).map(T=>[T.placement,T.overflows.filter(M=>M>0).reduce((M,H)=>M+H,0)]).sort((T,M)=>T[1]-M[1])[0])==null?void 0:Y[0];j&&(B=j);break}case"initialPlacement":B=a;break}if(n!==B)return{reset:{placement:B}}}return{}}}};function Uo(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function jo(r){return Uh.some(e=>r[e]>=0)}const nf=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t}=e,{strategy:s="referenceHidden",...n}=Nt(r,e);switch(s){case"referenceHidden":{const i=await on(e,{...n,elementContext:"reference"}),o=Uo(i,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:jo(o)}}}case"escaped":{const i=await on(e,{...n,altBoundary:!0}),o=Uo(i,t.floating);return{data:{escapedOffsets:o,escaped:jo(o)}}}default:return{}}}}},kl=new Set(["left","top"]);async function rf(r,e){const{placement:t,platform:s,elements:n}=r,i=await(s.isRTL==null?void 0:s.isRTL(n.floating)),o=$t(t),a=qs(t),l=Ct(t)==="y",c=kl.has(o)?-1:1,d=i&&l?-1:1,u=Nt(e,r);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*d,y:h*c}:{x:h*c,y:f*d}}const of=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,s;const{x:n,y:i,placement:o,middlewareData:a}=e,l=await rf(e,r);return o===((t=a.offset)==null?void 0:t.placement)&&(s=a.arrow)!=null&&s.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},af=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:s,placement:n}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:m=>{let{x:v,y:_}=m;return{x:v,y:_}}},...l}=Nt(r,e),c={x:t,y:s},d=await on(e,l),u=Ct($t(n)),h=Kr(u);let f=c[h],p=c[u];if(i){const m=h==="y"?"top":"left",v=h==="y"?"bottom":"right",_=f+d[m],w=f-d[v];f=fr(_,f,w)}if(o){const m=u==="y"?"top":"left",v=u==="y"?"bottom":"right",_=p+d[m],w=p-d[v];p=fr(_,p,w)}const g=a.fn({...e,[h]:f,[u]:p});return{...g,data:{x:g.x-t,y:g.y-s,enabled:{[h]:i,[u]:o}}}}}},lf=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:s,placement:n,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Nt(r,e),d={x:t,y:s},u=Ct(n),h=Kr(u);let f=d[h],p=d[u];const g=Nt(a,e),m=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=h==="y"?"height":"width",x=i.reference[h]-i.floating[w]+m.mainAxis,S=i.reference[h]+i.reference[w]-m.mainAxis;f<x?f=x:f>S&&(f=S)}if(c){var v,_;const w=h==="y"?"width":"height",x=kl.has($t(n)),S=i.reference[u]-i.floating[w]+(x&&((v=o.offset)==null?void 0:v[u])||0)+(x?0:m.crossAxis),b=i.reference[u]+i.reference[w]+(x?0:((_=o.offset)==null?void 0:_[u])||0)-(x?m.crossAxis:0);p<S?p=S:p>b&&(p=b)}return{[h]:f,[u]:p}}}},cf=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,s;const{placement:n,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=Nt(r,e),d=await on(e,c),u=$t(n),h=qs(n),f=Ct(n)==="y",{width:p,height:g}=i.floating;let m,v;u==="top"||u==="bottom"?(m=u,v=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=u,m=h==="end"?"top":"bottom");const _=g-d.top-d.bottom,w=p-d.left-d.right,x=Jt(g-d[m],_),S=Jt(p-d[v],w),b=!e.middlewareData.shift;let A=x,E=S;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(E=w),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(A=_),b&&!h){const k=Je(d.left,0),D=Je(d.right,0),q=Je(d.top,0),Y=Je(d.bottom,0);f?E=p-2*(k!==0||D!==0?k+D:Je(d.left,d.right)):A=g-2*(q!==0||Y!==0?q+Y:Je(d.top,d.bottom))}await l({...e,availableWidth:E,availableHeight:A});const C=await o.getDimensions(a.floating);return p!==C.width||g!==C.height?{reset:{rects:!0}}:{}}}};function gi(){return typeof window<"u"}function gs(r){return Qr(r)?(r.nodeName||"").toLowerCase():"#document"}function Qe(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Dt(r){var e;return(e=(Qr(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function Qr(r){return gi()?r instanceof Node||r instanceof Qe(r).Node:!1}function pt(r){return gi()?r instanceof Element||r instanceof Qe(r).Element:!1}function kt(r){return gi()?r instanceof HTMLElement||r instanceof Qe(r).HTMLElement:!1}function Vo(r){return!gi()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Qe(r).ShadowRoot}const df=new Set(["inline","contents"]);function _n(r){const{overflow:e,overflowX:t,overflowY:s,display:n}=gt(r);return/auto|scroll|overlay|hidden|clip/.test(e+s+t)&&!df.has(n)}const uf=new Set(["table","td","th"]);function hf(r){return uf.has(gs(r))}const ff=[":popover-open",":modal"];function mi(r){return ff.some(e=>{try{return r.matches(e)}catch{return!1}})}const pf=["transform","translate","scale","rotate","perspective"],gf=["transform","translate","scale","rotate","perspective","filter"],mf=["paint","layout","strict","content"];function eo(r){const e=to(),t=pt(r)?gt(r):r;return pf.some(s=>t[s]?t[s]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||gf.some(s=>(t.willChange||"").includes(s))||mf.some(s=>(t.contain||"").includes(s))}function yf(r){let e=Qt(r);for(;kt(e)&&!Fs(e);){if(eo(e))return e;if(mi(e))return null;e=Qt(e)}return null}function to(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const vf=new Set(["html","body","#document"]);function Fs(r){return vf.has(gs(r))}function gt(r){return Qe(r).getComputedStyle(r)}function yi(r){return pt(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Qt(r){if(gs(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Vo(r)&&r.host||Dt(r);return Vo(e)?e.host:e}function Pl(r){const e=Qt(r);return Fs(e)?r.ownerDocument?r.ownerDocument.body:r.body:kt(e)&&_n(e)?e:Pl(e)}function an(r,e,t){var s;e===void 0&&(e=[]),t===void 0&&(t=!0);const n=Pl(r),i=n===((s=r.ownerDocument)==null?void 0:s.body),o=Qe(n);if(i){const a=gr(o);return e.concat(o,o.visualViewport||[],_n(n)?n:[],a&&t?an(a):[])}return e.concat(n,an(n,[],t))}function gr(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function Ml(r){const e=gt(r);let t=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const n=kt(r),i=n?r.offsetWidth:t,o=n?r.offsetHeight:s,a=ti(t)!==i||ti(s)!==o;return a&&(t=i,s=o),{width:t,height:s,$:a}}function so(r){return pt(r)?r:r.contextElement}function Ms(r){const e=so(r);if(!kt(e))return Tt(1);const t=e.getBoundingClientRect(),{width:s,height:n,$:i}=Ml(e);let o=(i?ti(t.width):t.width)/s,a=(i?ti(t.height):t.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const bf=Tt(0);function Dl(r){const e=Qe(r);return!to()||!e.visualViewport?bf:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function wf(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Qe(r)?!1:e}function ds(r,e,t,s){e===void 0&&(e=!1),t===void 0&&(t=!1);const n=r.getBoundingClientRect(),i=so(r);let o=Tt(1);e&&(s?pt(s)&&(o=Ms(s)):o=Ms(r));const a=wf(i,t,s)?Dl(i):Tt(0);let l=(n.left+a.x)/o.x,c=(n.top+a.y)/o.y,d=n.width/o.x,u=n.height/o.y;if(i){const h=Qe(i),f=s&&pt(s)?Qe(s):s;let p=h,g=gr(p);for(;g&&s&&f!==p;){const m=Ms(g),v=g.getBoundingClientRect(),_=gt(g),w=v.left+(g.clientLeft+parseFloat(_.paddingLeft))*m.x,x=v.top+(g.clientTop+parseFloat(_.paddingTop))*m.y;l*=m.x,c*=m.y,d*=m.x,u*=m.y,l+=w,c+=x,p=Qe(g),g=gr(p)}}return ni({width:d,height:u,x:l,y:c})}function no(r,e){const t=yi(r).scrollLeft;return e?e.left+t:ds(Dt(r)).left+t}function Il(r,e,t){t===void 0&&(t=!1);const s=r.getBoundingClientRect(),n=s.left+e.scrollLeft-(t?0:no(r,s)),i=s.top+e.scrollTop;return{x:n,y:i}}function _f(r){let{elements:e,rect:t,offsetParent:s,strategy:n}=r;const i=n==="fixed",o=Dt(s),a=e?mi(e.floating):!1;if(s===o||a&&i)return t;let l={scrollLeft:0,scrollTop:0},c=Tt(1);const d=Tt(0),u=kt(s);if((u||!u&&!i)&&((gs(s)!=="body"||_n(o))&&(l=yi(s)),kt(s))){const f=ds(s);c=Ms(s),d.x=f.x+s.clientLeft,d.y=f.y+s.clientTop}const h=o&&!u&&!i?Il(o,l,!0):Tt(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:t.y*c.y-l.scrollTop*c.y+d.y+h.y}}function Af(r){return Array.from(r.getClientRects())}function xf(r){const e=Dt(r),t=yi(r),s=r.ownerDocument.body,n=Je(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Je(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-t.scrollLeft+no(r);const a=-t.scrollTop;return gt(s).direction==="rtl"&&(o+=Je(e.clientWidth,s.clientWidth)-n),{width:n,height:i,x:o,y:a}}function Sf(r,e){const t=Qe(r),s=Dt(r),n=t.visualViewport;let i=s.clientWidth,o=s.clientHeight,a=0,l=0;if(n){i=n.width,o=n.height;const c=to();(!c||c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:a,y:l}}const Cf=new Set(["absolute","fixed"]);function Ef(r,e){const t=ds(r,!0,e==="fixed"),s=t.top+r.clientTop,n=t.left+r.clientLeft,i=kt(r)?Ms(r):Tt(1),o=r.clientWidth*i.x,a=r.clientHeight*i.y,l=n*i.x,c=s*i.y;return{width:o,height:a,x:l,y:c}}function Wo(r,e,t){let s;if(e==="viewport")s=Sf(r,t);else if(e==="document")s=xf(Dt(r));else if(pt(e))s=Ef(e,t);else{const n=Dl(r);s={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return ni(s)}function Rl(r,e){const t=Qt(r);return t===e||!pt(t)||Fs(t)?!1:gt(t).position==="fixed"||Rl(t,e)}function Tf(r,e){const t=e.get(r);if(t)return t;let s=an(r,[],!1).filter(a=>pt(a)&&gs(a)!=="body"),n=null;const i=gt(r).position==="fixed";let o=i?Qt(r):r;for(;pt(o)&&!Fs(o);){const a=gt(o),l=eo(o);!l&&a.position==="fixed"&&(n=null),(i?!l&&!n:!l&&a.position==="static"&&!!n&&Cf.has(n.position)||_n(o)&&!l&&Rl(r,o))?s=s.filter(d=>d!==o):n=a,o=Qt(o)}return e.set(r,s),s}function kf(r){let{element:e,boundary:t,rootBoundary:s,strategy:n}=r;const o=[...t==="clippingAncestors"?mi(e)?[]:Tf(e,this._c):[].concat(t),s],a=o[0],l=o.reduce((c,d)=>{const u=Wo(e,d,n);return c.top=Je(u.top,c.top),c.right=Jt(u.right,c.right),c.bottom=Jt(u.bottom,c.bottom),c.left=Je(u.left,c.left),c},Wo(e,a,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Pf(r){const{width:e,height:t}=Ml(r);return{width:e,height:t}}function Mf(r,e,t){const s=kt(e),n=Dt(e),i=t==="fixed",o=ds(r,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Tt(0);function c(){l.x=no(n)}if(s||!s&&!i)if((gs(e)!=="body"||_n(n))&&(a=yi(e)),s){const f=ds(e,!0,i,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else n&&c();i&&!s&&n&&c();const d=n&&!s&&!i?Il(n,a):Tt(0),u=o.left+a.scrollLeft-l.x-d.x,h=o.top+a.scrollTop-l.y-d.y;return{x:u,y:h,width:o.width,height:o.height}}function qi(r){return gt(r).position==="static"}function Go(r,e){if(!kt(r)||gt(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Dt(r)===t&&(t=t.ownerDocument.body),t}function Ol(r,e){const t=Qe(r);if(mi(r))return t;if(!kt(r)){let n=Qt(r);for(;n&&!Fs(n);){if(pt(n)&&!qi(n))return n;n=Qt(n)}return t}let s=Go(r,e);for(;s&&hf(s)&&qi(s);)s=Go(s,e);return s&&Fs(s)&&qi(s)&&!eo(s)?t:s||yf(r)||t}const Df=async function(r){const e=this.getOffsetParent||Ol,t=this.getDimensions,s=await t(r.floating);return{reference:Mf(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function If(r){return gt(r).direction==="rtl"}const Rf={convertOffsetParentRelativeRectToViewportRelativeRect:_f,getDocumentElement:Dt,getClippingRect:kf,getOffsetParent:Ol,getElementRects:Df,getClientRects:Af,getDimensions:Pf,getScale:Ms,isElement:pt,isRTL:If};function Ll(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function Of(r,e){let t=null,s;const n=Dt(r);function i(){var a;clearTimeout(s),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=r.getBoundingClientRect(),{left:d,top:u,width:h,height:f}=c;if(a||e(),!h||!f)return;const p=Rn(u),g=Rn(n.clientWidth-(d+h)),m=Rn(n.clientHeight-(u+f)),v=Rn(d),w={rootMargin:-p+"px "+-g+"px "+-m+"px "+-v+"px",threshold:Je(0,Jt(1,l))||1};let x=!0;function S(b){const A=b[0].intersectionRatio;if(A!==l){if(!x)return o();A?o(!1,A):s=setTimeout(()=>{o(!1,1e-7)},1e3)}A===1&&!Ll(c,r.getBoundingClientRect())&&o(),x=!1}try{t=new IntersectionObserver(S,{...w,root:n.ownerDocument})}catch{t=new IntersectionObserver(S,w)}t.observe(r)}return o(!0),i}function Lf(r,e,t,s){s===void 0&&(s={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,c=so(r),d=n||i?[...c?an(c):[],...an(e)]:[];d.forEach(v=>{n&&v.addEventListener("scroll",t,{passive:!0}),i&&v.addEventListener("resize",t)});const u=c&&a?Of(c,t):null;let h=-1,f=null;o&&(f=new ResizeObserver(v=>{let[_]=v;_&&_.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=f)==null||w.observe(e)})),t()}),c&&!l&&f.observe(c),f.observe(e));let p,g=l?ds(r):null;l&&m();function m(){const v=ds(r);g&&!Ll(g,v)&&t(),g=v,p=requestAnimationFrame(m)}return t(),()=>{var v;d.forEach(_=>{n&&_.removeEventListener("scroll",t),i&&_.removeEventListener("resize",t)}),u?.(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const Ff=of,Bf=af,Xo=sf,Nf=cf,$f=nf,qf=tf,Hf=lf,zf=(r,e,t)=>{const s=new Map,n={platform:Rf,...t},i={...n.platform,_c:s};return ef(r,e,{...n,platform:i})};function Uf(r){return r!=null&&typeof r=="object"&&"$el"in r}function mr(r){if(Uf(r)){const e=r.$el;return Qr(e)&&gs(e)==="#comment"?null:e}return r}function xs(r){return typeof r=="function"?r():y(r)}function jf(r){return{name:"arrow",options:r,fn(e){const t=mr(xs(r.element));return t==null?{}:qf({element:t,padding:r.padding}).fn(e)}}}function Fl(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Yo(r,e){const t=Fl(r);return Math.round(e*t)/t}function Vf(r,e,t){t===void 0&&(t={});const s=t.whileElementsMounted,n=z(()=>{var A;return(A=xs(t.open))!=null?A:!0}),i=z(()=>xs(t.middleware)),o=z(()=>{var A;return(A=xs(t.placement))!=null?A:"bottom"}),a=z(()=>{var A;return(A=xs(t.strategy))!=null?A:"absolute"}),l=z(()=>{var A;return(A=xs(t.transform))!=null?A:!0}),c=z(()=>mr(r.value)),d=z(()=>mr(e.value)),u=U(0),h=U(0),f=U(a.value),p=U(o.value),g=Et({}),m=U(!1),v=z(()=>{const A={position:f.value,left:"0",top:"0"};if(!d.value)return A;const E=Yo(d.value,u.value),C=Yo(d.value,h.value);return l.value?{...A,transform:"translate("+E+"px, "+C+"px)",...Fl(d.value)>=1.5&&{willChange:"transform"}}:{position:f.value,left:E+"px",top:C+"px"}});let _;function w(){if(c.value==null||d.value==null)return;const A=n.value;zf(c.value,d.value,{middleware:i.value,placement:o.value,strategy:a.value}).then(E=>{u.value=E.x,h.value=E.y,f.value=E.strategy,p.value=E.placement,g.value=E.middlewareData,m.value=A!==!1})}function x(){typeof _=="function"&&(_(),_=void 0)}function S(){if(x(),s===void 0){w();return}if(c.value!=null&&d.value!=null){_=s(c.value,d.value,w);return}}function b(){n.value||(m.value=!1)}return Ae([i,o,a,n],w,{flush:"sync"}),Ae([c,d],S,{flush:"sync"}),Ae(n,b,{flush:"sync"}),qr()&&Hr(x),{x:bs(u),y:bs(h),strategy:bs(f),placement:bs(p),middlewareData:bs(g),isPositioned:bs(m),floatingStyles:v,update:w}}const Bl={side:"bottom",sideOffset:0,sideFlip:!0,align:"center",alignOffset:0,alignFlip:!0,arrowPadding:0,avoidCollisions:!0,collisionBoundary:()=>[],collisionPadding:0,sticky:"partial",hideWhenDetached:!1,positionStrategy:"fixed",updatePositionStrategy:"optimized",prioritizePosition:!1},[Wf,Gf]=Be("PopperContent");var Xf=L({inheritAttrs:!1,__name:"PopperContent",props:tl({side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...Bl}),emits:["placed"],setup(r,{emit:e}){const t=r,s=e,n=Sl(),{forwardRef:i,currentElement:o}=le(),a=U(),l=U(),{width:c,height:d}=Gd(l),u=z(()=>t.side+(t.align!=="center"?`-${t.align}`:"")),h=z(()=>typeof t.collisionPadding=="number"?t.collisionPadding:{top:0,right:0,bottom:0,left:0,...t.collisionPadding}),f=z(()=>Array.isArray(t.collisionBoundary)?t.collisionBoundary:[t.collisionBoundary]),p=z(()=>({padding:h.value,boundary:f.value.filter(Hh),altBoundary:f.value.length>0})),g=z(()=>({mainAxis:t.sideFlip,crossAxis:t.alignFlip})),m=gd(()=>[Ff({mainAxis:t.sideOffset+d.value,alignmentAxis:t.alignOffset}),t.prioritizePosition&&t.avoidCollisions&&Xo({...p.value,...g.value}),t.avoidCollisions&&Bf({mainAxis:!0,crossAxis:!!t.prioritizePosition,limiter:t.sticky==="partial"?Hf():void 0,...p.value}),!t.prioritizePosition&&t.avoidCollisions&&Xo({...p.value,...g.value}),Nf({...p.value,apply:({elements:q,rects:Y,availableWidth:F,availableHeight:G})=>{const{width:B,height:j}=Y.reference,T=q.floating.style;T.setProperty("--reka-popper-available-width",`${F}px`),T.setProperty("--reka-popper-available-height",`${G}px`),T.setProperty("--reka-popper-anchor-width",`${B}px`),T.setProperty("--reka-popper-anchor-height",`${j}px`)}}),l.value&&jf({element:l.value,padding:t.arrowPadding}),zh({arrowWidth:c.value,arrowHeight:d.value}),t.hideWhenDetached&&$f({strategy:"referenceHidden",...p.value})]),v=z(()=>t.reference??n.anchor.value),{floatingStyles:_,placement:w,isPositioned:x,middlewareData:S}=Vf(v,a,{strategy:t.positionStrategy,placement:u,whileElementsMounted:(...q)=>Lf(...q,{layoutShift:!t.disableUpdateOnLayoutShift,animationFrame:t.updatePositionStrategy==="always"}),middleware:m}),b=z(()=>hr(w.value)[0]),A=z(()=>hr(w.value)[1]);el(()=>{x.value&&s("placed")});const E=z(()=>S.value.arrow?.centerOffset!==0),C=U("");et(()=>{o.value&&(C.value=window.getComputedStyle(o.value).zIndex)});const k=z(()=>S.value.arrow?.x??0),D=z(()=>S.value.arrow?.y??0);return Gf({placedSide:b,onArrowChange:q=>l.value=q,arrowX:k,arrowY:D,shouldHideArrow:E}),(q,Y)=>(I(),fe("div",{ref_key:"floatingRef",ref:a,"data-reka-popper-content-wrapper":"",style:mn({...y(_),transform:y(x)?y(_).transform:"translate(0, -200%)",minWidth:"max-content",zIndex:C.value,"--reka-popper-transform-origin":[y(S).transformOrigin?.x,y(S).transformOrigin?.y].join(" "),...y(S).hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}})},[R(y(ve),ee({ref:y(i)},q.$attrs,{"as-child":t.asChild,as:q.as,"data-side":b.value,"data-align":A.value,style:{animation:y(x)?void 0:"none"}}),{default:P(()=>[$(q.$slots,"default")]),_:3},16,["as-child","as","data-side","data-align","style"])],4))}}),Nl=Xf;const Yf={top:"bottom",right:"left",bottom:"top",left:"right"};var Kf=L({inheritAttrs:!1,__name:"PopperArrow",props:{width:{type:Number,required:!1},height:{type:Number,required:!1},rounded:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"svg"}},setup(r){const{forwardRef:e}=le(),t=Wf(),s=z(()=>Yf[t.placedSide.value]);return(n,i)=>(I(),fe("span",{ref:o=>{y(t).onArrowChange(o)},style:mn({position:"absolute",left:y(t).arrowX?.value?`${y(t).arrowX?.value}px`:void 0,top:y(t).arrowY?.value?`${y(t).arrowY?.value}px`:void 0,[s.value]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[y(t).placedSide.value],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[y(t).placedSide.value],visibility:y(t).shouldHideArrow.value?"hidden":void 0})},[R(qh,ee(n.$attrs,{ref:y(e),style:{display:"block"},as:n.as,"as-child":n.asChild,rounded:n.rounded,width:n.width,height:n.height}),{default:P(()=>[$(n.$slots,"default")]),_:3},16,["as","as-child","rounded","width","height"])],4))}}),Zf=Kf,Jf=L({__name:"MenuAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(y(El),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),Qf=Jf;function ep(){const r=U(!1);return tt(()=>{cs("keydown",()=>{r.value=!0},{capture:!0,passive:!0}),cs(["pointerdown","pointermove"],()=>{r.value=!1},{capture:!0,passive:!0})}),r}const tp=al(ep),[vi,sp]=Be(["MenuRoot","MenuSub"],"MenuContext"),[io,np]=Be("MenuRoot");var ip=L({__name:"MenuRoot",props:{open:{type:Boolean,required:!1,default:!1},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,s=e,{modal:n,dir:i}=ht(t),o=fi(i),a=ss(t,"open",s),l=U(),c=tp();return sp({open:a,onOpenChange:d=>{a.value=d},content:l,onContentChange:d=>{l.value=d}}),np({onClose:()=>{a.value=!1},isUsingKeyboardRef:c,dir:o,modal:n}),(d,u)=>(I(),N(y(Cl),null,{default:P(()=>[$(d.$slots,"default")]),_:3}))}}),rp=ip;const[$l,op]=Be("MenuContent");var ap=L({__name:"MenuContentImpl",props:tl({loop:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},disableOutsideScroll:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...Bl}),emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus","dismiss"],setup(r,{emit:e}){const t=r,s=e,n=vi(),i=io(),{trapFocus:o,disableOutsidePointerEvents:a,loop:l}=ht(t);Od(),dl(a.value);const c=U(""),d=U(0),u=U(0),h=U(null),f=U("right"),p=U(0),g=U(null),m=U(),{forwardRef:v,currentElement:_}=le(),{handleTypeaheadSearch:w}=Yd();Ae(_,C=>{n.onContentChange(C)}),gn(()=>{window.clearTimeout(d.value)});function x(C){return f.value===h.value?.side&&Wu(C,h.value?.area)}async function S(C){s("openAutoFocus",C),!C.defaultPrevented&&(C.preventDefault(),_.value?.focus({preventScroll:!0}))}function b(C){if(C.defaultPrevented)return;const D=C.target.closest("[data-reka-menu-content]")===C.currentTarget,q=C.ctrlKey||C.altKey||C.metaKey,Y=C.key.length===1,F=il(C,Xe(),_.value,{loop:l.value,arrowKeyOptions:"vertical",dir:i?.dir.value,focus:!0,attributeName:"[data-reka-collection-item]:not([data-disabled])"});if(F)return F?.focus();if(C.code==="Space")return;const G=m.value?.getItems()??[];if(D&&(C.key==="Tab"&&C.preventDefault(),!q&&Y&&w(C.key,G)),C.target!==_.value||!Uu.includes(C.key))return;C.preventDefault();const B=[...G.map(j=>j.ref)];vl.includes(C.key)&&B.reverse(),ju(B)}function A(C){C?.currentTarget?.contains?.(C.target)||(window.clearTimeout(d.value),c.value="")}function E(C){if(!ur(C))return;const k=C.target,D=p.value!==C.clientX;if(C?.currentTarget?.contains(k)&&D){const q=C.clientX>p.value?"right":"left";f.value=q,p.value=C.clientX}}return op({onItemEnter:C=>!!x(C),onItemLeave:C=>{x(C)||(_.value?.focus(),g.value=null)},onTriggerLeave:C=>!!x(C),searchRef:c,pointerGraceTimerRef:u,onPointerGraceIntentChange:C=>{h.value=C}}),(C,k)=>(I(),N(y(yl),{"as-child":"",trapped:y(o),onMountAutoFocus:S,onUnmountAutoFocus:k[7]||(k[7]=D=>s("closeAutoFocus",D))},{default:P(()=>[R(y(Gr),{"as-child":"","disable-outside-pointer-events":y(a),onEscapeKeyDown:k[2]||(k[2]=D=>s("escapeKeyDown",D)),onPointerDownOutside:k[3]||(k[3]=D=>s("pointerDownOutside",D)),onFocusOutside:k[4]||(k[4]=D=>s("focusOutside",D)),onInteractOutside:k[5]||(k[5]=D=>s("interactOutside",D)),onDismiss:k[6]||(k[6]=D=>s("dismiss"))},{default:P(()=>[R(y(wh),{ref_key:"rovingFocusGroupRef",ref:m,"current-tab-stop-id":g.value,"onUpdate:currentTabStopId":k[0]||(k[0]=D=>g.value=D),"as-child":"",orientation:"vertical",dir:y(i).dir.value,loop:y(l),onEntryFocus:k[1]||(k[1]=D=>{s("entryFocus",D),y(i).isUsingKeyboardRef.value||D.preventDefault()})},{default:P(()=>[R(y(Nl),{ref:y(v),role:"menu",as:C.as,"as-child":C.asChild,"aria-orientation":"vertical","data-reka-menu-content":"","data-state":y(bl)(y(n).open.value),dir:y(i).dir.value,side:C.side,"side-offset":C.sideOffset,align:C.align,"align-offset":C.alignOffset,"avoid-collisions":C.avoidCollisions,"collision-boundary":C.collisionBoundary,"collision-padding":C.collisionPadding,"arrow-padding":C.arrowPadding,"prioritize-position":C.prioritizePosition,"position-strategy":C.positionStrategy,"update-position-strategy":C.updatePositionStrategy,sticky:C.sticky,"hide-when-detached":C.hideWhenDetached,reference:C.reference,onKeydown:b,onBlur:A,onPointermove:E},{default:P(()=>[$(C.$slots,"default")]),_:3},8,["as","as-child","data-state","dir","side","side-offset","align","align-offset","avoid-collisions","collision-boundary","collision-padding","arrow-padding","prioritize-position","position-strategy","update-position-strategy","sticky","hide-when-detached","reference"])]),_:3},8,["current-tab-stop-id","dir","loop"])]),_:3},8,["disable-outside-pointer-events"])]),_:3},8,["trapped"]))}}),ql=ap,lp=L({inheritAttrs:!1,__name:"MenuItemImpl",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=$l(),{forwardRef:s}=le(),{CollectionItem:n}=Yr(),i=U(!1);async function o(l){l.defaultPrevented||ur(l)&&(e.disabled?t.onItemLeave(l):t.onItemEnter(l)||l.currentTarget?.focus({preventScroll:!0}))}async function a(l){await De(),!l.defaultPrevented&&ur(l)&&t.onItemLeave(l)}return(l,c)=>(I(),N(y(n),{value:{textValue:l.textValue}},{default:P(()=>[R(y(ve),ee({ref:y(s),role:"menuitem",tabindex:"-1"},l.$attrs,{as:l.as,"as-child":l.asChild,"aria-disabled":l.disabled||void 0,"data-disabled":l.disabled?"":void 0,"data-highlighted":i.value?"":void 0,onPointermove:o,onPointerleave:a,onFocus:c[0]||(c[0]=async d=>{await De(),!(d.defaultPrevented||l.disabled)&&(i.value=!0)}),onBlur:c[1]||(c[1]=async d=>{await De(),!d.defaultPrevented&&(i.value=!1)})}),{default:P(()=>[$(l.$slots,"default")]),_:3},16,["as","as-child","aria-disabled","data-disabled","data-highlighted"])]),_:3},8,["value"]))}}),cp=lp,dp=L({__name:"MenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(r,{emit:e}){const t=r,s=e,{forwardRef:n,currentElement:i}=le(),o=io(),a=$l(),l=U(!1);async function c(){const d=i.value;if(!t.disabled&&d){const u=new CustomEvent(Hu,{bubbles:!0,cancelable:!0});s("select",u),await De(),u.defaultPrevented?l.value=!1:o.onClose()}}return(d,u)=>(I(),N(cp,ee(t,{ref:y(n),onClick:c,onPointerdown:u[0]||(u[0]=()=>{l.value=!0}),onPointerup:u[1]||(u[1]=async h=>{await De(),!h.defaultPrevented&&(l.value||h.currentTarget?.click())}),onKeydown:u[2]||(u[2]=async h=>{const f=y(a).searchRef.value!=="";d.disabled||f&&h.key===" "||y(dr).includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}),{default:P(()=>[$(d.$slots,"default")]),_:3},16))}}),up=dp,hp=L({__name:"MenuRootContentModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=st(t,s),i=vi(),{forwardRef:o,currentElement:a}=le();return fl(a),(l,c)=>(I(),N(ql,ee(y(n),{ref:y(o),"trap-focus":y(i).open.value,"disable-outside-pointer-events":y(i).open.value,"disable-outside-scroll":!0,onDismiss:c[0]||(c[0]=d=>y(i).onOpenChange(!1)),onFocusOutside:c[1]||(c[1]=hi(d=>s("focusOutside",d),["prevent"]))}),{default:P(()=>[$(l.$slots,"default")]),_:3},16,["trap-focus","disable-outside-pointer-events"]))}}),fp=hp,pp=L({__name:"MenuRootContentNonModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const n=st(r,e),i=vi();return(o,a)=>(I(),N(ql,ee(y(n),{"trap-focus":!1,"disable-outside-pointer-events":!1,"disable-outside-scroll":!1,onDismiss:a[0]||(a[0]=l=>y(i).onOpenChange(!1))}),{default:P(()=>[$(o.$slots,"default")]),_:3},16))}}),gp=pp,mp=L({__name:"MenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const n=st(r,e),i=vi(),o=io();return(a,l)=>(I(),N(y($s),{present:a.forceMount||y(i).open.value},{default:P(()=>[y(o).modal.value?(I(),N(fp,ft(ee({key:0},{...a.$attrs,...y(n)})),{default:P(()=>[$(a.$slots,"default")]),_:3},16)):(I(),N(gp,ft(ee({key:1},{...a.$attrs,...y(n)})),{default:P(()=>[$(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),yp=mp,vp=L({__name:"MenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(y(Xr),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),bp=vp;const[Hl,wp]=Be("DropdownMenuRoot");var _p=L({__name:"DropdownMenuRoot",props:{defaultOpen:{type:Boolean,required:!1},open:{type:Boolean,required:!1,default:void 0},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,s=e;le();const n=ss(t,"open",s,{defaultValue:t.defaultOpen,passive:t.open===void 0}),i=U(),{modal:o,dir:a}=ht(t),l=fi(a);return wp({open:n,onOpenChange:c=>{n.value=c},onOpenToggle:()=>{n.value=!n.value},triggerId:"",triggerElement:i,contentId:"",modal:o,dir:l}),(c,d)=>(I(),N(y(rp),{open:y(n),"onUpdate:open":d[0]||(d[0]=u=>tn(n)?n.value=u:null),dir:y(l),modal:y(o)},{default:P(()=>[$(c.$slots,"default",{open:y(n)})]),_:3},8,["open","dir","modal"]))}}),Ap=_p,xp=L({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(r,{emit:e}){const n=st(r,e);le();const i=Hl(),o=U(!1);function a(l){l.defaultPrevented||(o.value||setTimeout(()=>{i.triggerElement.value?.focus()},0),o.value=!1,l.preventDefault())}return i.contentId||=Zt(void 0,"reka-dropdown-menu-content"),(l,c)=>(I(),N(y(yp),ee(y(n),{id:y(i).contentId,"aria-labelledby":y(i)?.triggerId,style:{"--reka-dropdown-menu-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-dropdown-menu-content-available-width":"var(--reka-popper-available-width)","--reka-dropdown-menu-content-available-height":"var(--reka-popper-available-height)","--reka-dropdown-menu-trigger-width":"var(--reka-popper-anchor-width)","--reka-dropdown-menu-trigger-height":"var(--reka-popper-anchor-height)"},onCloseAutoFocus:a,onInteractOutside:c[0]||(c[0]=d=>{if(d.defaultPrevented)return;const u=d.detail.originalEvent,h=u.button===0&&u.ctrlKey===!0,f=u.button===2||h;(!y(i).modal.value||f)&&(o.value=!0),y(i).triggerElement.value?.contains(d.target)&&d.preventDefault()})}),{default:P(()=>[$(l.$slots,"default")]),_:3},16,["id","aria-labelledby"]))}}),Sp=xp,Cp=L({__name:"DropdownMenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(r,{emit:e}){const t=r,n=wn(e);return le(),(i,o)=>(I(),N(y(up),ft(qt({...t,...y(n)})),{default:P(()=>[$(i.$slots,"default")]),_:3},16))}}),Ep=Cp,Tp=L({__name:"DropdownMenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(y(bp),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),kp=Tp,Pp=L({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r,t=Hl(),{forwardRef:s,currentElement:n}=le();return tt(()=>{t.triggerElement=n}),t.triggerId||=Zt(void 0,"reka-dropdown-menu-trigger"),(i,o)=>(I(),N(y(Qf),{"as-child":""},{default:P(()=>[R(y(ve),{id:y(t).triggerId,ref:y(s),type:i.as==="button"?"button":void 0,"as-child":e.asChild,as:i.as,"aria-haspopup":"menu","aria-expanded":y(t).open.value,"aria-controls":y(t).open.value?y(t).contentId:void 0,"data-disabled":i.disabled?"":void 0,disabled:i.disabled,"data-state":y(t).open.value?"open":"closed",onClick:o[0]||(o[0]=async a=>{!i.disabled&&a.button===0&&a.ctrlKey===!1&&(y(t)?.onOpenToggle(),await De(),y(t).open.value&&a.preventDefault())}),onKeydown:o[1]||(o[1]=zr(a=>{i.disabled||(["Enter"," "].includes(a.key)&&y(t).onOpenToggle(),a.key==="ArrowDown"&&y(t).onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())},["enter","space","arrow-down"]))},{default:P(()=>[$(i.$slots,"default")]),_:3},8,["id","type","as-child","as","aria-expanded","aria-controls","data-disabled","disabled","data-state"])]),_:3}))}}),Mp=Pp,Dp=L({__name:"Label",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"label"}},setup(r){const e=r;return le(),(t,s)=>(I(),N(y(ve),ee(e,{onMousedown:s[0]||(s[0]=n=>{!n.defaultPrevented&&n.detail>1&&n.preventDefault()})}),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),Ip=Dp,Rp=L({__name:"BaseSeparator",props:{orientation:{type:String,required:!1,default:"horizontal"},decorative:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=["horizontal","vertical"];function s(a){return t.includes(a)}const n=z(()=>s(e.orientation)?e.orientation:"horizontal"),i=z(()=>n.value==="vertical"?e.orientation:void 0),o=z(()=>e.decorative?{role:"none"}:{"aria-orientation":i.value,role:"separator"});return(a,l)=>(I(),N(y(ve),ee({as:a.as,"as-child":a.asChild,"data-orientation":n.value},o.value),{default:P(()=>[$(a.$slots,"default")]),_:3},16,["as","as-child","data-orientation"]))}}),Op=Rp,Lp=L({__name:"Separator",props:{orientation:{type:String,required:!1,default:"horizontal"},decorative:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(Op,ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),Fp=Lp,Bp=L({__name:"TooltipArrow",props:{width:{type:Number,required:!1,default:10},height:{type:Number,required:!1,default:5},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"svg"}},setup(r){const e=r;return le(),(t,s)=>(I(),N(y(Zf),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),Np=Bp;const[ro,$p]=Be("TooltipProvider");var qp=L({inheritAttrs:!1,__name:"TooltipProvider",props:{delayDuration:{type:Number,required:!1,default:700},skipDelayDuration:{type:Number,required:!1,default:300},disableHoverableContent:{type:Boolean,required:!1,default:!1},disableClosingTrigger:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},ignoreNonKeyboardFocus:{type:Boolean,required:!1,default:!1}},setup(r){const e=r,{delayDuration:t,skipDelayDuration:s,disableHoverableContent:n,disableClosingTrigger:i,ignoreNonKeyboardFocus:o,disabled:a}=ht(e);le();const l=U(!0),c=U(!1),{start:d,stop:u}=cl(()=>{l.value=!0},s,{immediate:!1});return $p({isOpenDelayed:l,delayDuration:t,onOpen(){u(),l.value=!1},onClose(){d()},isPointerInTransitRef:c,disableHoverableContent:n,disableClosingTrigger:i,disabled:a,ignoreNonKeyboardFocus:o}),(h,f)=>$(h.$slots,"default")}}),Hp=qp;const zl="tooltip.open",[bi,zp]=Be("TooltipRoot");var Up=L({__name:"TooltipRoot",props:{defaultOpen:{type:Boolean,required:!1,default:!1},open:{type:Boolean,required:!1,default:void 0},delayDuration:{type:Number,required:!1,default:void 0},disableHoverableContent:{type:Boolean,required:!1,default:void 0},disableClosingTrigger:{type:Boolean,required:!1,default:void 0},disabled:{type:Boolean,required:!1,default:void 0},ignoreNonKeyboardFocus:{type:Boolean,required:!1,default:void 0}},emits:["update:open"],setup(r,{emit:e}){const t=r,s=e;le();const n=ro(),i=z(()=>t.disableHoverableContent??n.disableHoverableContent.value),o=z(()=>t.disableClosingTrigger??n.disableClosingTrigger.value),a=z(()=>t.disabled??n.disabled.value),l=z(()=>t.delayDuration??n.delayDuration.value),c=z(()=>t.ignoreNonKeyboardFocus??n.ignoreNonKeyboardFocus.value),d=ss(t,"open",s,{defaultValue:t.defaultOpen,passive:t.open===void 0});Ae(d,w=>{n.onClose&&(w?(n.onOpen(),document.dispatchEvent(new CustomEvent(zl))):n.onClose())});const u=U(!1),h=U(),f=z(()=>d.value?u.value?"delayed-open":"instant-open":"closed"),{start:p,stop:g}=cl(()=>{u.value=!0,d.value=!0},l,{immediate:!1});function m(){g(),u.value=!1,d.value=!0}function v(){g(),d.value=!1}function _(){p()}return zp({contentId:"",open:d,stateAttribute:f,trigger:h,onTriggerChange(w){h.value=w},onTriggerEnter(){n.isOpenDelayed.value?_():m()},onTriggerLeave(){i.value?v():g()},onOpen:m,onClose:v,disableHoverableContent:i,disableClosingTrigger:o,disabled:a,ignoreNonKeyboardFocus:c}),(w,x)=>(I(),N(y(Cl),null,{default:P(()=>[$(w.$slots,"default",{open:y(d)})]),_:3}))}}),jp=Up,Vp=L({__name:"TooltipContentImpl",props:{ariaLabel:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},side:{type:null,required:!1,default:"top"},sideOffset:{type:Number,required:!1,default:0},align:{type:null,required:!1,default:"center"},alignOffset:{type:Number,required:!1},avoidCollisions:{type:Boolean,required:!1,default:!0},collisionBoundary:{type:null,required:!1,default:()=>[]},collisionPadding:{type:[Number,Object],required:!1,default:0},arrowPadding:{type:Number,required:!1,default:0},sticky:{type:String,required:!1,default:"partial"},hideWhenDetached:{type:Boolean,required:!1,default:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1}},emits:["escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,s=e,n=bi(),{forwardRef:i}=le(),o=cd(),a=z(()=>o.default?.({})),l=z(()=>{if(t.ariaLabel)return t.ariaLabel;let d="";function u(h){typeof h.children=="string"&&h.type!==Qa?d+=h.children:Array.isArray(h.children)&&h.children.forEach(f=>u(f))}return a.value?.forEach(h=>u(h)),d}),c=z(()=>{const{ariaLabel:d,...u}=t;return u});return tt(()=>{cs(window,"scroll",d=>{d.target?.contains(n.trigger.value)&&n.onClose()}),cs(window,zl,n.onClose)}),(d,u)=>(I(),N(y(Gr),{"as-child":"","disable-outside-pointer-events":!1,onEscapeKeyDown:u[0]||(u[0]=h=>s("escapeKeyDown",h)),onPointerDownOutside:u[1]||(u[1]=h=>{y(n).disableClosingTrigger.value&&y(n).trigger.value?.contains(h.target)&&h.preventDefault(),s("pointerDownOutside",h)}),onFocusOutside:u[2]||(u[2]=hi(()=>{},["prevent"])),onDismiss:u[3]||(u[3]=h=>y(n).onClose())},{default:P(()=>[R(y(Nl),ee({ref:y(i),"data-state":y(n).stateAttribute.value},{...d.$attrs,...c.value},{style:{"--reka-tooltip-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-tooltip-content-available-width":"var(--reka-popper-available-width)","--reka-tooltip-content-available-height":"var(--reka-popper-available-height)","--reka-tooltip-trigger-width":"var(--reka-popper-anchor-width)","--reka-tooltip-trigger-height":"var(--reka-popper-anchor-height)"}}),{default:P(()=>[$(d.$slots,"default"),R(y(Al),{id:y(n).contentId,role:"tooltip"},{default:P(()=>[pe(ut(l.value),1)]),_:1},8,["id"])]),_:3},16,["data-state"])]),_:3}))}}),Ul=Vp,Wp=L({__name:"TooltipContentHoverable",props:{ariaLabel:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1}},setup(r){const t=ps(r),{forwardRef:s,currentElement:n}=le(),{trigger:i,onClose:o}=bi(),a=ro(),{isPointerInTransit:l,onPointerExit:c}=Fd(i,n);return a.isPointerInTransitRef=l,c(()=>{o()}),(d,u)=>(I(),N(Ul,ee({ref:y(s)},y(t)),{default:P(()=>[$(d.$slots,"default")]),_:3},16))}}),Gp=Wp,Xp=L({__name:"TooltipContent",props:{forceMount:{type:Boolean,required:!1},ariaLabel:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},side:{type:null,required:!1,default:"top"},sideOffset:{type:Number,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1}},emits:["escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,s=e,n=bi(),i=st(t,s),{forwardRef:o}=le();return(a,l)=>(I(),N(y($s),{present:a.forceMount||y(n).open.value},{default:P(()=>[(I(),N(Ur(y(n).disableHoverableContent.value?Ul:Gp),ee({ref:y(o)},y(i)),{default:P(()=>[$(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Yp=Xp,Kp=L({__name:"TooltipPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,s)=>(I(),N(y(Xr),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),Zp=Kp,Jp=L({__name:"TooltipTrigger",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r,t=bi(),s=ro();t.contentId||=Zt(void 0,"reka-tooltip-content");const{forwardRef:n,currentElement:i}=le(),o=U(!1),a=U(!1),l=z(()=>t.disabled.value?{}:{click:g,focus:f,pointermove:u,pointerleave:h,pointerdown:d,blur:p});tt(()=>{t.onTriggerChange(i.value)});function c(){setTimeout(()=>{o.value=!1},1)}function d(){t.open&&!t.disableClosingTrigger.value&&t.onClose(),o.value=!0,document.addEventListener("pointerup",c,{once:!0})}function u(m){m.pointerType!=="touch"&&!a.value&&!s.isPointerInTransitRef.value&&(t.onTriggerEnter(),a.value=!0)}function h(){t.onTriggerLeave(),a.value=!1}function f(m){o.value||t.ignoreNonKeyboardFocus.value&&!m.target.matches?.(":focus-visible")||t.onOpen()}function p(){t.onClose()}function g(){t.disableClosingTrigger.value||t.onClose()}return(m,v)=>(I(),N(y(El),{"as-child":"",reference:m.reference},{default:P(()=>[R(y(ve),ee({ref:y(n),"aria-describedby":y(t).open.value?y(t).contentId:void 0,"data-state":y(t).stateAttribute.value,as:m.as,"as-child":e.asChild,"data-grace-area-trigger":""},dd(l.value)),{default:P(()=>[$(m.$slots,"default")]),_:3},16,["aria-describedby","data-state","as","as-child"])]),_:3},8,["reference"]))}}),Qp=Jp;const eg=L({__name:"Tooltip",props:{defaultOpen:{type:Boolean},open:{type:Boolean},delayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const n=st(r,e);return(i,o)=>(I(),N(y(jp),ee({"data-slot":"tooltip"},y(n)),{default:P(()=>[$(i.$slots,"default")]),_:3},16))}});function tg(r){return qr()?(Hr(r),!0):!1}const Hi=new WeakMap,sg=(...r)=>{var e;const t=r[0],s=(e=mt())==null?void 0:e.proxy;if(s==null&&!sl())throw new Error("injectLocal must be called in setup");return s&&Hi.has(s)&&t in Hi.get(s)?Hi.get(s)[t]:$r(...r)};function ng(r){if(!tn(r))return Ke(r);const e=new Proxy({},{get(t,s,n){return y(Reflect.get(r.value,s,n))},set(t,s,n){return tn(r.value[s])&&!tn(n)?r.value[s].value=n:r.value[s]=n,!0},deleteProperty(t,s){return Reflect.deleteProperty(r.value,s)},has(t,s){return Reflect.has(r.value,s)},ownKeys(){return Object.keys(r.value)},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}}});return Ke(e)}function ig(r){return ng(z(r))}function nt(r,...e){const t=e.flat(),s=t[0];return ig(()=>Object.fromEntries(typeof s=="function"?Object.entries(ht(r)).filter(([n,i])=>!s(_e(i),n)):Object.entries(ht(r)).filter(n=>!t.includes(n[0]))))}const rg=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const og=r=>typeof r<"u",ag=Object.prototype.toString,lg=r=>ag.call(r)==="[object Object]",cg=()=>{};function jl(...r){if(r.length!==1)return Ja(...r);const e=r[0];return typeof e=="function"?ui(Ka(()=>({get:e,set:cg}))):U(e)}function dg(r,e){function t(...s){return new Promise((n,i)=>{Promise.resolve(r(()=>e.apply(this,s),{fn:e,thisArg:this,args:s})).then(n).catch(i)})}return t}const Vl=r=>r();function ug(r=Vl,e={}){const{initialState:t="active"}=e,s=jl(t==="active");function n(){s.value=!1}function i(){s.value=!0}const o=(...a)=>{s.value&&r(...a)};return{isActive:ui(s),pause:n,resume:i,eventFilter:o}}function Ko(r){return r.endsWith("rem")?Number.parseFloat(r)*16:Number.parseFloat(r)}function zi(r){return Array.isArray(r)?r:[r]}function hg(r){return mt()}function fg(r,e,t={}){const{eventFilter:s=Vl,...n}=t;return Ae(r,dg(s,e),n)}function pg(r,e,t={}){const{eventFilter:s,initialState:n="active",...i}=t,{eventFilter:o,pause:a,resume:l,isActive:c}=ug(s,{initialState:n});return{stop:fg(r,e,{...i,eventFilter:o}),pause:a,resume:l,isActive:c}}function Wl(r,e=!0,t){hg()?tt(r,t):e?r():De(r)}function gg(r,e,t){return Ae(r,e,{...t,immediate:!0})}const ln=rg?window:void 0;function Gl(r){var e;const t=_e(r);return(e=t?.$el)!=null?e:t}function yr(...r){const e=[],t=()=>{e.forEach(a=>a()),e.length=0},s=(a,l,c,d)=>(a.addEventListener(l,c,d),()=>a.removeEventListener(l,c,d)),n=z(()=>{const a=zi(_e(r[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),i=gg(()=>{var a,l;return[(l=(a=n.value)==null?void 0:a.map(c=>Gl(c)))!=null?l:[ln].filter(c=>c!=null),zi(_e(n.value?r[1]:r[0])),zi(y(n.value?r[2]:r[1])),_e(n.value?r[3]:r[2])]},([a,l,c,d])=>{if(t(),!a?.length||!l?.length||!c?.length)return;const u=lg(d)?{...d}:d;e.push(...a.flatMap(h=>l.flatMap(f=>c.map(p=>s(h,f,p,u)))))},{flush:"post"}),o=()=>{i(),t()};return tg(t),o}function mg(){const r=Et(!1),e=mt();return e&&tt(()=>{r.value=!0},e),r}function yg(r){const e=mg();return z(()=>(e.value,!!r()))}const vg=Symbol("vueuse-ssr-width");function bg(){const r=sl()?sg(vg,null):null;return typeof r=="number"?r:void 0}function wg(r,e={}){const{window:t=ln,ssrWidth:s=bg()}=e,n=yg(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function"),i=Et(typeof s=="number"),o=Et(),a=Et(!1),l=c=>{a.value=c.matches};return et(()=>{if(i.value){i.value=!n.value;const c=_e(r).split(",");a.value=c.some(d=>{const u=d.includes("not all"),h=d.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),f=d.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(h||f);return h&&p&&(p=s>=Ko(h[1])),f&&p&&(p=s<=Ko(f[1])),u?!p:p});return}n.value&&(o.value=t.matchMedia(_e(r)),a.value=o.value.matches)}),yr(o,"change",l,{passive:!0}),z(()=>a.value)}function _g(r){return JSON.parse(JSON.stringify(r))}const On=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ln="__vueuse_ssr_handlers__",Ag=xg();function xg(){return Ln in On||(On[Ln]=On[Ln]||{}),On[Ln]}function Xl(r,e){return Ag[r]||e}function Sg(r){return wg("(prefers-color-scheme: dark)",r)}function Cg(r){return r==null?"any":r instanceof Set?"set":r instanceof Map?"map":r instanceof Date?"date":typeof r=="boolean"?"boolean":typeof r=="string"?"string":typeof r=="object"?"object":Number.isNaN(r)?"any":"number"}const Eg={boolean:{read:r=>r==="true",write:r=>String(r)},object:{read:r=>JSON.parse(r),write:r=>JSON.stringify(r)},number:{read:r=>Number.parseFloat(r),write:r=>String(r)},any:{read:r=>r,write:r=>String(r)},string:{read:r=>r,write:r=>String(r)},map:{read:r=>new Map(JSON.parse(r)),write:r=>JSON.stringify(Array.from(r.entries()))},set:{read:r=>new Set(JSON.parse(r)),write:r=>JSON.stringify(Array.from(r))},date:{read:r=>new Date(r),write:r=>r.toISOString()}},Zo="vueuse-storage";function Tg(r,e,t,s={}){var n;const{flush:i="pre",deep:o=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:c=!1,shallow:d,window:u=ln,eventFilter:h,onError:f=F=>{console.error(F)},initOnMounted:p}=s,g=(d?Et:U)(typeof e=="function"?e():e),m=z(()=>_e(r));if(!t)try{t=Xl("getDefaultStorage",()=>{var F;return(F=ln)==null?void 0:F.localStorage})()}catch(F){f(F)}if(!t)return g;const v=_e(e),_=Cg(v),w=(n=s.serializer)!=null?n:Eg[_],{pause:x,resume:S}=pg(g,F=>k(F),{flush:i,deep:o,eventFilter:h});Ae(m,()=>q(),{flush:i});let b=!1;const A=F=>{p&&!b||q(F)},E=F=>{p&&!b||Y(F)};u&&a&&(t instanceof Storage?yr(u,"storage",A,{passive:!0}):yr(u,Zo,E)),p?Wl(()=>{b=!0,q()}):q();function C(F,G){if(u){const B={key:m.value,oldValue:F,newValue:G,storageArea:t};u.dispatchEvent(t instanceof Storage?new StorageEvent("storage",B):new CustomEvent(Zo,{detail:B}))}}function k(F){try{const G=t.getItem(m.value);if(F==null)C(G,null),t.removeItem(m.value);else{const B=w.write(F);G!==B&&(t.setItem(m.value,B),C(G,B))}}catch(G){f(G)}}function D(F){const G=F?F.newValue:t.getItem(m.value);if(G==null)return l&&v!=null&&t.setItem(m.value,w.write(v)),v;if(!F&&c){const B=w.read(G);return typeof c=="function"?c(B,v):_==="object"&&!Array.isArray(B)?{...v,...B}:B}else return typeof G!="string"?G:w.read(G)}function q(F){if(!(F&&F.storageArea!==t)){if(F&&F.key==null){g.value=v;return}if(!(F&&F.key!==m.value)){x();try{const G=w.write(g.value);(F===void 0||F?.newValue!==G)&&(g.value=D(F))}catch(G){f(G)}finally{F?De(S):S()}}}}function Y(F){q(F.detail)}return g}const kg="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Pg(r={}){const{selector:e="html",attribute:t="class",initialValue:s="auto",window:n=ln,storage:i,storageKey:o="vueuse-color-scheme",listenToStorageChanges:a=!0,storageRef:l,emitAuto:c,disableTransition:d=!0}=r,u={auto:"",light:"light",dark:"dark",...r.modes||{}},h=Sg({window:n}),f=z(()=>h.value?"dark":"light"),p=l||(o==null?jl(s):Tg(o,s,i,{window:n,listenToStorageChanges:a})),g=z(()=>p.value==="auto"?f.value:p.value),m=Xl("updateHTMLAttrs",(x,S,b)=>{const A=typeof x=="string"?n?.document.querySelector(x):Gl(x);if(!A)return;const E=new Set,C=new Set;let k=null;if(S==="class"){const q=b.split(/\s/g);Object.values(u).flatMap(Y=>(Y||"").split(/\s/g)).filter(Boolean).forEach(Y=>{q.includes(Y)?E.add(Y):C.add(Y)})}else k={key:S,value:b};if(E.size===0&&C.size===0&&k===null)return;let D;d&&(D=n.document.createElement("style"),D.appendChild(document.createTextNode(kg)),n.document.head.appendChild(D));for(const q of E)A.classList.add(q);for(const q of C)A.classList.remove(q);k&&A.setAttribute(k.key,k.value),d&&(n.getComputedStyle(D).opacity,document.head.removeChild(D))});function v(x){var S;m(e,t,(S=u[x])!=null?S:x)}function _(x){r.onChanged?r.onChanged(x,v):v(x)}Ae(g,_,{flush:"post",immediate:!0}),Wl(()=>_(g.value));const w=z({get(){return c?p.value:g.value},set(x){p.value=x}});return Object.assign(w,{store:p,system:f,state:g})}function Mg(r,e,t,s={}){var n,i,o;const{clone:a=!1,passive:l=!1,eventName:c,deep:d=!1,defaultValue:u,shouldEmit:h}=s,f=mt(),p=t||f?.emit||((n=f?.$emit)==null?void 0:n.bind(f))||((o=(i=f?.proxy)==null?void 0:i.$emit)==null?void 0:o.bind(f?.proxy));let g=c;g=g||`update:${e.toString()}`;const m=w=>a?typeof a=="function"?a(w):_g(w):w,v=()=>og(r[e])?m(r[e]):u,_=w=>{h?h(w)&&p(g,w):p(g,w)};if(l){const w=v(),x=U(w);let S=!1;return Ae(()=>r[e],b=>{S||(S=!0,x.value=m(b),De(()=>S=!1))}),Ae(x,b=>{!S&&(b!==r[e]||d)&&_(b)},{deep:d}),x}else return z({get(){return v()},set(w){_(w)}})}function Yl(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=Yl(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function Kl(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=Yl(r))&&(s&&(s+=" "),s+=e);return s}const oo="-",Dg=r=>{const e=Rg(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=r;return{getClassGroupId:o=>{const a=o.split(oo);return a[0]===""&&a.length!==1&&a.shift(),Zl(a,e)||Ig(o)},getConflictingClassGroupIds:(o,a)=>{const l=t[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},Zl=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],s=e.nextPart.get(t),n=s?Zl(r.slice(1),s):void 0;if(n)return n;if(e.validators.length===0)return;const i=r.join(oo);return e.validators.find(({validator:o})=>o(i))?.classGroupId},Jo=/^\[(.+)\]$/,Ig=r=>{if(Jo.test(r)){const e=Jo.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Rg=r=>{const{theme:e,classGroups:t}=r,s={nextPart:new Map,validators:[]};for(const n in t)vr(t[n],s,n,e);return s},vr=(r,e,t,s)=>{r.forEach(n=>{if(typeof n=="string"){const i=n===""?e:Qo(e,n);i.classGroupId=t;return}if(typeof n=="function"){if(Og(n)){vr(n(s),e,t,s);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,o])=>{vr(o,Qo(e,i),t,s)})})},Qo=(r,e)=>{let t=r;return e.split(oo).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},Og=r=>r.isThemeGetter,Lg=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,s=new Map;const n=(i,o)=>{t.set(i,o),e++,e>r&&(e=0,s=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return n(i,o),o},set(i,o){t.has(i)?t.set(i,o):n(i,o)}}},br="!",wr=":",Fg=wr.length,Bg=r=>{const{prefix:e,experimentalParseClassName:t}=r;let s=n=>{const i=[];let o=0,a=0,l=0,c;for(let p=0;p<n.length;p++){let g=n[p];if(o===0&&a===0){if(g===wr){i.push(n.slice(l,p)),l=p+Fg;continue}if(g==="/"){c=p;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const d=i.length===0?n:n.substring(l),u=Ng(d),h=u!==d,f=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:u,maybePostfixModifierPosition:f}};if(e){const n=e+wr,i=s;s=o=>o.startsWith(n)?i(o.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(t){const n=s;s=i=>t({className:i,parseClassName:n})}return s},Ng=r=>r.endsWith(br)?r.substring(0,r.length-1):r.startsWith(br)?r.substring(1):r,$g=r=>{const e=Object.fromEntries(r.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const n=[];let i=[];return s.forEach(o=>{o[0]==="["||e[o]?(n.push(...i.sort(),o),i=[]):i.push(o)}),n.push(...i.sort()),n}},qg=r=>({cache:Lg(r.cacheSize),parseClassName:Bg(r),sortModifiers:$g(r),...Dg(r)}),Hg=/\s+/,zg=(r,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:i}=e,o=[],a=r.trim().split(Hg);let l="";for(let c=a.length-1;c>=0;c-=1){const d=a[c],{isExternal:u,modifiers:h,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:g}=t(d);if(u){l=d+(l.length>0?" "+l:l);continue}let m=!!g,v=s(m?p.substring(0,g):p);if(!v){if(!m){l=d+(l.length>0?" "+l:l);continue}if(v=s(p),!v){l=d+(l.length>0?" "+l:l);continue}m=!1}const _=i(h).join(":"),w=f?_+br:_,x=w+v;if(o.includes(x))continue;o.push(x);const S=n(v,m);for(let b=0;b<S.length;++b){const A=S[b];o.push(w+A)}l=d+(l.length>0?" "+l:l)}return l};function Ug(){let r=0,e,t,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Jl(e))&&(s&&(s+=" "),s+=t);return s}const Jl=r=>{if(typeof r=="string")return r;let e,t="";for(let s=0;s<r.length;s++)r[s]&&(e=Jl(r[s]))&&(t&&(t+=" "),t+=e);return t};function jg(r,...e){let t,s,n,i=o;function o(l){const c=e.reduce((d,u)=>u(d),r());return t=qg(c),s=t.cache.get,n=t.cache.set,i=a,a(l)}function a(l){const c=s(l);if(c)return c;const d=zg(l,t);return n(l,d),d}return function(){return i(Ug.apply(null,arguments))}}const Me=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Ql=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ec=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Vg=/^\d+\/\d+$/,Wg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Gg=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xg=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Yg=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Kg=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_s=r=>Vg.test(r),ce=r=>!!r&&!Number.isNaN(Number(r)),jt=r=>!!r&&Number.isInteger(Number(r)),Ui=r=>r.endsWith("%")&&ce(r.slice(0,-1)),Rt=r=>Wg.test(r),Zg=()=>!0,Jg=r=>Gg.test(r)&&!Xg.test(r),tc=()=>!1,Qg=r=>Yg.test(r),em=r=>Kg.test(r),tm=r=>!Z(r)&&!J(r),sm=r=>Hs(r,ic,tc),Z=r=>Ql.test(r),is=r=>Hs(r,rc,Jg),ji=r=>Hs(r,am,ce),ea=r=>Hs(r,sc,tc),nm=r=>Hs(r,nc,em),Fn=r=>Hs(r,oc,Qg),J=r=>ec.test(r),js=r=>zs(r,rc),im=r=>zs(r,lm),ta=r=>zs(r,sc),rm=r=>zs(r,ic),om=r=>zs(r,nc),Bn=r=>zs(r,oc,!0),Hs=(r,e,t)=>{const s=Ql.exec(r);return s?s[1]?e(s[1]):t(s[2]):!1},zs=(r,e,t=!1)=>{const s=ec.exec(r);return s?s[1]?e(s[1]):t:!1},sc=r=>r==="position"||r==="percentage",nc=r=>r==="image"||r==="url",ic=r=>r==="length"||r==="size"||r==="bg-size",rc=r=>r==="length",am=r=>r==="number",lm=r=>r==="family-name",oc=r=>r==="shadow",cm=()=>{const r=Me("color"),e=Me("font"),t=Me("text"),s=Me("font-weight"),n=Me("tracking"),i=Me("leading"),o=Me("breakpoint"),a=Me("container"),l=Me("spacing"),c=Me("radius"),d=Me("shadow"),u=Me("inset-shadow"),h=Me("text-shadow"),f=Me("drop-shadow"),p=Me("blur"),g=Me("perspective"),m=Me("aspect"),v=Me("ease"),_=Me("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],x=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],S=()=>[...x(),J,Z],b=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],E=()=>[J,Z,l],C=()=>[_s,"full","auto",...E()],k=()=>[jt,"none","subgrid",J,Z],D=()=>["auto",{span:["full",jt,J,Z]},jt,J,Z],q=()=>[jt,"auto",J,Z],Y=()=>["auto","min","max","fr",J,Z],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],G=()=>["start","end","center","stretch","center-safe","end-safe"],B=()=>["auto",...E()],j=()=>[_s,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...E()],T=()=>[r,J,Z],M=()=>[...x(),ta,ea,{position:[J,Z]}],H=()=>["no-repeat",{repeat:["","x","y","space","round"]}],V=()=>["auto","cover","contain",rm,sm,{size:[J,Z]}],O=()=>[Ui,js,is],W=()=>["","none","full",c,J,Z],oe=()=>["",ce,js,is],de=()=>["solid","dashed","dotted","double"],ye=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],te=()=>[ce,Ui,ta,ea],Ne=()=>["","none",p,J,Z],it=()=>["none",ce,J,Z],Ut=()=>["none",ce,J,Z],yt=()=>[ce,J,Z],vt=()=>[_s,"full",...E()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Rt],breakpoint:[Rt],color:[Zg],container:[Rt],"drop-shadow":[Rt],ease:["in","out","in-out"],font:[tm],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Rt],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Rt],shadow:[Rt],spacing:["px",ce],text:[Rt],"text-shadow":[Rt],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",_s,Z,J,m]}],container:["container"],columns:[{columns:[ce,Z,J,a]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:S()}],overflow:[{overflow:b()}],"overflow-x":[{"overflow-x":b()}],"overflow-y":[{"overflow-y":b()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:C()}],"inset-x":[{"inset-x":C()}],"inset-y":[{"inset-y":C()}],start:[{start:C()}],end:[{end:C()}],top:[{top:C()}],right:[{right:C()}],bottom:[{bottom:C()}],left:[{left:C()}],visibility:["visible","invisible","collapse"],z:[{z:[jt,"auto",J,Z]}],basis:[{basis:[_s,"full","auto",a,...E()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ce,_s,"auto","initial","none",Z]}],grow:[{grow:["",ce,J,Z]}],shrink:[{shrink:["",ce,J,Z]}],order:[{order:[jt,"first","last","none",J,Z]}],"grid-cols":[{"grid-cols":k()}],"col-start-end":[{col:D()}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":k()}],"row-start-end":[{row:D()}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Y()}],"auto-rows":[{"auto-rows":Y()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...G(),"normal"]}],"justify-self":[{"justify-self":["auto",...G()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...G(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...G(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...G(),"baseline"]}],"place-self":[{"place-self":["auto",...G()]}],p:[{p:E()}],px:[{px:E()}],py:[{py:E()}],ps:[{ps:E()}],pe:[{pe:E()}],pt:[{pt:E()}],pr:[{pr:E()}],pb:[{pb:E()}],pl:[{pl:E()}],m:[{m:B()}],mx:[{mx:B()}],my:[{my:B()}],ms:[{ms:B()}],me:[{me:B()}],mt:[{mt:B()}],mr:[{mr:B()}],mb:[{mb:B()}],ml:[{ml:B()}],"space-x":[{"space-x":E()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":E()}],"space-y-reverse":["space-y-reverse"],size:[{size:j()}],w:[{w:[a,"screen",...j()]}],"min-w":[{"min-w":[a,"screen","none",...j()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...j()]}],h:[{h:["screen","lh",...j()]}],"min-h":[{"min-h":["screen","lh","none",...j()]}],"max-h":[{"max-h":["screen","lh",...j()]}],"font-size":[{text:["base",t,js,is]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,J,ji]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ui,Z]}],"font-family":[{font:[im,Z,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,J,Z]}],"line-clamp":[{"line-clamp":[ce,"none",J,ji]}],leading:[{leading:[i,...E()]}],"list-image":[{"list-image":["none",J,Z]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",J,Z]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:T()}],"text-color":[{text:T()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[ce,"from-font","auto",J,is]}],"text-decoration-color":[{decoration:T()}],"underline-offset":[{"underline-offset":[ce,"auto",J,Z]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",J,Z]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",J,Z]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:M()}],"bg-repeat":[{bg:H()}],"bg-size":[{bg:V()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},jt,J,Z],radial:["",J,Z],conic:[jt,J,Z]},om,nm]}],"bg-color":[{bg:T()}],"gradient-from-pos":[{from:O()}],"gradient-via-pos":[{via:O()}],"gradient-to-pos":[{to:O()}],"gradient-from":[{from:T()}],"gradient-via":[{via:T()}],"gradient-to":[{to:T()}],rounded:[{rounded:W()}],"rounded-s":[{"rounded-s":W()}],"rounded-e":[{"rounded-e":W()}],"rounded-t":[{"rounded-t":W()}],"rounded-r":[{"rounded-r":W()}],"rounded-b":[{"rounded-b":W()}],"rounded-l":[{"rounded-l":W()}],"rounded-ss":[{"rounded-ss":W()}],"rounded-se":[{"rounded-se":W()}],"rounded-ee":[{"rounded-ee":W()}],"rounded-es":[{"rounded-es":W()}],"rounded-tl":[{"rounded-tl":W()}],"rounded-tr":[{"rounded-tr":W()}],"rounded-br":[{"rounded-br":W()}],"rounded-bl":[{"rounded-bl":W()}],"border-w":[{border:oe()}],"border-w-x":[{"border-x":oe()}],"border-w-y":[{"border-y":oe()}],"border-w-s":[{"border-s":oe()}],"border-w-e":[{"border-e":oe()}],"border-w-t":[{"border-t":oe()}],"border-w-r":[{"border-r":oe()}],"border-w-b":[{"border-b":oe()}],"border-w-l":[{"border-l":oe()}],"divide-x":[{"divide-x":oe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":oe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:T()}],"border-color-x":[{"border-x":T()}],"border-color-y":[{"border-y":T()}],"border-color-s":[{"border-s":T()}],"border-color-e":[{"border-e":T()}],"border-color-t":[{"border-t":T()}],"border-color-r":[{"border-r":T()}],"border-color-b":[{"border-b":T()}],"border-color-l":[{"border-l":T()}],"divide-color":[{divide:T()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ce,J,Z]}],"outline-w":[{outline:["",ce,js,is]}],"outline-color":[{outline:T()}],shadow:[{shadow:["","none",d,Bn,Fn]}],"shadow-color":[{shadow:T()}],"inset-shadow":[{"inset-shadow":["none",u,Bn,Fn]}],"inset-shadow-color":[{"inset-shadow":T()}],"ring-w":[{ring:oe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:T()}],"ring-offset-w":[{"ring-offset":[ce,is]}],"ring-offset-color":[{"ring-offset":T()}],"inset-ring-w":[{"inset-ring":oe()}],"inset-ring-color":[{"inset-ring":T()}],"text-shadow":[{"text-shadow":["none",h,Bn,Fn]}],"text-shadow-color":[{"text-shadow":T()}],opacity:[{opacity:[ce,J,Z]}],"mix-blend":[{"mix-blend":[...ye(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ye()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ce]}],"mask-image-linear-from-pos":[{"mask-linear-from":te()}],"mask-image-linear-to-pos":[{"mask-linear-to":te()}],"mask-image-linear-from-color":[{"mask-linear-from":T()}],"mask-image-linear-to-color":[{"mask-linear-to":T()}],"mask-image-t-from-pos":[{"mask-t-from":te()}],"mask-image-t-to-pos":[{"mask-t-to":te()}],"mask-image-t-from-color":[{"mask-t-from":T()}],"mask-image-t-to-color":[{"mask-t-to":T()}],"mask-image-r-from-pos":[{"mask-r-from":te()}],"mask-image-r-to-pos":[{"mask-r-to":te()}],"mask-image-r-from-color":[{"mask-r-from":T()}],"mask-image-r-to-color":[{"mask-r-to":T()}],"mask-image-b-from-pos":[{"mask-b-from":te()}],"mask-image-b-to-pos":[{"mask-b-to":te()}],"mask-image-b-from-color":[{"mask-b-from":T()}],"mask-image-b-to-color":[{"mask-b-to":T()}],"mask-image-l-from-pos":[{"mask-l-from":te()}],"mask-image-l-to-pos":[{"mask-l-to":te()}],"mask-image-l-from-color":[{"mask-l-from":T()}],"mask-image-l-to-color":[{"mask-l-to":T()}],"mask-image-x-from-pos":[{"mask-x-from":te()}],"mask-image-x-to-pos":[{"mask-x-to":te()}],"mask-image-x-from-color":[{"mask-x-from":T()}],"mask-image-x-to-color":[{"mask-x-to":T()}],"mask-image-y-from-pos":[{"mask-y-from":te()}],"mask-image-y-to-pos":[{"mask-y-to":te()}],"mask-image-y-from-color":[{"mask-y-from":T()}],"mask-image-y-to-color":[{"mask-y-to":T()}],"mask-image-radial":[{"mask-radial":[J,Z]}],"mask-image-radial-from-pos":[{"mask-radial-from":te()}],"mask-image-radial-to-pos":[{"mask-radial-to":te()}],"mask-image-radial-from-color":[{"mask-radial-from":T()}],"mask-image-radial-to-color":[{"mask-radial-to":T()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":x()}],"mask-image-conic-pos":[{"mask-conic":[ce]}],"mask-image-conic-from-pos":[{"mask-conic-from":te()}],"mask-image-conic-to-pos":[{"mask-conic-to":te()}],"mask-image-conic-from-color":[{"mask-conic-from":T()}],"mask-image-conic-to-color":[{"mask-conic-to":T()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:M()}],"mask-repeat":[{mask:H()}],"mask-size":[{mask:V()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",J,Z]}],filter:[{filter:["","none",J,Z]}],blur:[{blur:Ne()}],brightness:[{brightness:[ce,J,Z]}],contrast:[{contrast:[ce,J,Z]}],"drop-shadow":[{"drop-shadow":["","none",f,Bn,Fn]}],"drop-shadow-color":[{"drop-shadow":T()}],grayscale:[{grayscale:["",ce,J,Z]}],"hue-rotate":[{"hue-rotate":[ce,J,Z]}],invert:[{invert:["",ce,J,Z]}],saturate:[{saturate:[ce,J,Z]}],sepia:[{sepia:["",ce,J,Z]}],"backdrop-filter":[{"backdrop-filter":["","none",J,Z]}],"backdrop-blur":[{"backdrop-blur":Ne()}],"backdrop-brightness":[{"backdrop-brightness":[ce,J,Z]}],"backdrop-contrast":[{"backdrop-contrast":[ce,J,Z]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ce,J,Z]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ce,J,Z]}],"backdrop-invert":[{"backdrop-invert":["",ce,J,Z]}],"backdrop-opacity":[{"backdrop-opacity":[ce,J,Z]}],"backdrop-saturate":[{"backdrop-saturate":[ce,J,Z]}],"backdrop-sepia":[{"backdrop-sepia":["",ce,J,Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":E()}],"border-spacing-x":[{"border-spacing-x":E()}],"border-spacing-y":[{"border-spacing-y":E()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",J,Z]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ce,"initial",J,Z]}],ease:[{ease:["linear","initial",v,J,Z]}],delay:[{delay:[ce,J,Z]}],animate:[{animate:["none",_,J,Z]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,J,Z]}],"perspective-origin":[{"perspective-origin":S()}],rotate:[{rotate:it()}],"rotate-x":[{"rotate-x":it()}],"rotate-y":[{"rotate-y":it()}],"rotate-z":[{"rotate-z":it()}],scale:[{scale:Ut()}],"scale-x":[{"scale-x":Ut()}],"scale-y":[{"scale-y":Ut()}],"scale-z":[{"scale-z":Ut()}],"scale-3d":["scale-3d"],skew:[{skew:yt()}],"skew-x":[{"skew-x":yt()}],"skew-y":[{"skew-y":yt()}],transform:[{transform:[J,Z,"","none","gpu","cpu"]}],"transform-origin":[{origin:S()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:vt()}],"translate-x":[{"translate-x":vt()}],"translate-y":[{"translate-y":vt()}],"translate-z":[{"translate-z":vt()}],"translate-none":["translate-none"],accent:[{accent:T()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:T()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",J,Z]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",J,Z]}],fill:[{fill:["none",...T()]}],"stroke-w":[{stroke:[ce,js,is,ji]}],stroke:[{stroke:["none",...T()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},dm=jg(cm);function Te(...r){return dm(Kl(r))}const um=L({inheritAttrs:!1,__name:"TooltipContent",props:{forceMount:{type:Boolean},ariaLabel:{},asChild:{type:Boolean},as:{},side:{},sideOffset:{default:4},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},class:{}},emits:["escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,s=e,n=nt(t,"class"),i=st(n,s);return(o,a)=>(I(),N(y(Zp),null,{default:P(()=>[R(y(Yp),ee({"data-slot":"tooltip-content"},{...y(i),...o.$attrs},{class:y(Te)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance",t.class)}),{default:P(()=>[$(o.$slots,"default"),R(y(Np),{class:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]),_:3},16,["class"])]),_:3}))}}),hm=L({__name:"TooltipProvider",props:{delayDuration:{default:0},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(r){const e=r;return(t,s)=>(I(),N(y(Hp),ft(qt(e)),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),fm=L({__name:"TooltipTrigger",props:{reference:{},asChild:{type:Boolean},as:{}},setup(r){const e=r;return(t,s)=>(I(),N(y(Qp),ee({"data-slot":"tooltip-trigger"},e),{default:P(()=>[$(t.$slots,"default")]),_:3},16))}}),pm="/jrtech-infra-annotator/jrtech-on-logo.png",sa=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,na=Kl,gm=(r,e)=>t=>{var s;if(e?.variants==null)return na(r,t?.class,t?.className);const{variants:n,defaultVariants:i}=e,o=Object.keys(n).map(c=>{const d=t?.[c],u=i?.[c];if(d===null)return null;const h=sa(d)||sa(u);return n[c][h]}),a=t&&Object.entries(t).reduce((c,d)=>{let[u,h]=d;return h===void 0||(c[u]=h),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,d)=>{let{class:u,className:h,...f}=d;return Object.entries(f).every(p=>{let[g,m]=p;return Array.isArray(m)?m.includes({...i,...a}[g]):{...i,...a}[g]===m})?[...c,u,h]:c},[]);return na(r,o,l,t?.class,t?.className)},ze=L({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(r){const e=r;return(t,s)=>(I(),N(y(ve),{"data-slot":"button",as:t.as,"as-child":t.asChild,class:Mt(y(Te)(y(mm)({variant:t.variant,size:t.size}),e.class))},{default:P(()=>[$(t.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),mm=gm("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),Wt=L({__name:"Label",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class");return(s,n)=>(I(),N(y(Ip),ee({"data-slot":"label"},y(t),{class:y(Te)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e.class)}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["class"]))}}),ii=L({__name:"Separator",props:{orientation:{default:"horizontal"},decorative:{type:Boolean,default:!0},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class");return(s,n)=>(I(),N(y(Fp),ee({"data-slot":"separator-root"},y(t),{class:y(Te)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e.class)}),null,16,["class"]))}}),ym=L({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const n=st(r,e);return(i,o)=>(I(),N(y(Ap),ee({"data-slot":"dropdown-menu"},y(n)),{default:P(()=>[$(i.$slots,"default")]),_:3},16))}});/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vm=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),bm=r=>{const e=vm(r);return e.charAt(0).toUpperCase()+e.slice(1)},wm=(...r)=>r.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),ra=r=>r==="";/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Vs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=({name:r,iconNode:e,absoluteStrokeWidth:t,"absolute-stroke-width":s,strokeWidth:n,"stroke-width":i,size:o=Vs.width,color:a=Vs.stroke,...l},{slots:c})=>dt("svg",{...Vs,...l,width:o,height:o,stroke:a,"stroke-width":ra(t)||ra(s)||t===!0||s===!0?Number(n||i||Vs["stroke-width"])*24/Number(o):n||i||Vs["stroke-width"],class:wm("lucide",l.class,...r?[`lucide-${ia(bm(r))}-icon`,`lucide-${ia(r)}`]:["lucide-icon"])},[...e.map(d=>dt(...d)),...c.default?[c.default()]:[]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=(r,e)=>(t,{slots:s,attrs:n})=>dt(_m,{...n,...t,iconNode:e,name:r},s);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=je("antenna",[["path",{d:"M2 12 7 2",key:"117k30"}],["path",{d:"m7 12 5-10",key:"1tvx22"}],["path",{d:"m12 12 5-10",key:"ev1o1a"}],["path",{d:"m17 12 5-10",key:"1e4ti3"}],["path",{d:"M4.5 7h15",key:"vlsxkz"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=je("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=je("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=je("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=je("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=je("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=je("image-plus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=je("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=je("mouse-pointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=je("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=je("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=je("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=je("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=je("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);/**
 * @license lucide-vue-next v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=je("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Im=L({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=nt(t,"class"),i=st(n,s);return(o,a)=>(I(),N(y(kp),null,{default:P(()=>[R(y(Sp),ee({"data-slot":"dropdown-menu-content"},y(i),{class:y(Te)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--reka-dropdown-menu-content-available-height) min-w-[8rem] origin-(--reka-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t.class)}),{default:P(()=>[$(o.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),Vi=L({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean},variant:{default:"default"}},setup(r){const e=r,t=nt(e,"inset","variant","class"),s=ps(t);return(n,i)=>(I(),N(y(Ep),ee({"data-slot":"dropdown-menu-item","data-inset":n.inset?"":void 0,"data-variant":n.variant},y(s),{class:y(Te)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive-foreground data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/40 data-[variant=destructive]:focus:text-destructive-foreground data-[variant=destructive]:*:[svg]:!text-destructive-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)}),{default:P(()=>[$(n.$slots,"default")]),_:3},16,["data-inset","data-variant","class"]))}}),Rm=L({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(r){const t=ps(r);return(s,n)=>(I(),N(y(Mp),ee({"data-slot":"dropdown-menu-trigger"},y(t)),{default:P(()=>[$(s.$slots,"default")]),_:3},16))}}),lc=/^[a-z0-9]+(-[a-z0-9]+)*$/,wi=(r,e,t,s="")=>{const n=r.split(":");if(r.slice(0,1)==="@"){if(n.length<2||n.length>3)return null;s=n.shift().slice(1)}if(n.length>3||!n.length)return null;if(n.length>1){const a=n.pop(),l=n.pop(),c={provider:n.length>0?n[0]:s,prefix:l,name:a};return e&&!Xn(c)?null:c}const i=n[0],o=i.split("-");if(o.length>1){const a={provider:s,prefix:o.shift(),name:o.join("-")};return e&&!Xn(a)?null:a}if(t&&s===""){const a={provider:s,prefix:"",name:i};return e&&!Xn(a,t)?null:a}return null},Xn=(r,e)=>r?!!((e&&r.prefix===""||r.prefix)&&r.name):!1,cc=Object.freeze({left:0,top:0,width:16,height:16}),oi=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),_i=Object.freeze({...cc,...oi}),Ar=Object.freeze({..._i,body:"",hidden:!1});function Om(r,e){const t={};!r.hFlip!=!e.hFlip&&(t.hFlip=!0),!r.vFlip!=!e.vFlip&&(t.vFlip=!0);const s=((r.rotate||0)+(e.rotate||0))%4;return s&&(t.rotate=s),t}function aa(r,e){const t=Om(r,e);for(const s in Ar)s in oi?s in r&&!(s in t)&&(t[s]=oi[s]):s in e?t[s]=e[s]:s in r&&(t[s]=r[s]);return t}function Lm(r,e){const t=r.icons,s=r.aliases||Object.create(null),n=Object.create(null);function i(o){if(t[o])return n[o]=[];if(!(o in n)){n[o]=null;const a=s[o]&&s[o].parent,l=a&&i(a);l&&(n[o]=[a].concat(l))}return n[o]}return Object.keys(t).concat(Object.keys(s)).forEach(i),n}function Fm(r,e,t){const s=r.icons,n=r.aliases||Object.create(null);let i={};function o(a){i=aa(s[a]||n[a],i)}return o(e),t.forEach(o),aa(r,i)}function dc(r,e){const t=[];if(typeof r!="object"||typeof r.icons!="object")return t;r.not_found instanceof Array&&r.not_found.forEach(n=>{e(n,null),t.push(n)});const s=Lm(r);for(const n in s){const i=s[n];i&&(e(n,Fm(r,n,i)),t.push(n))}return t}const Bm={provider:"",aliases:{},not_found:{},...cc};function Wi(r,e){for(const t in e)if(t in r&&typeof r[t]!=typeof e[t])return!1;return!0}function uc(r){if(typeof r!="object"||r===null)return null;const e=r;if(typeof e.prefix!="string"||!r.icons||typeof r.icons!="object"||!Wi(r,Bm))return null;const t=e.icons;for(const n in t){const i=t[n];if(!n||typeof i.body!="string"||!Wi(i,Ar))return null}const s=e.aliases||Object.create(null);for(const n in s){const i=s[n],o=i.parent;if(!n||typeof o!="string"||!t[o]&&!s[o]||!Wi(i,Ar))return null}return e}const la=Object.create(null);function Nm(r,e){return{provider:r,prefix:e,icons:Object.create(null),missing:new Set}}function Bs(r,e){const t=la[r]||(la[r]=Object.create(null));return t[e]||(t[e]=Nm(r,e))}function hc(r,e){return uc(e)?dc(e,(t,s)=>{s?r.icons[t]=s:r.missing.add(t)}):[]}function $m(r,e,t){try{if(typeof t.body=="string")return r.icons[e]={...t},!0}catch{}return!1}let cn=!1;function fc(r){return typeof r=="boolean"&&(cn=r),cn}function qm(r){const e=typeof r=="string"?wi(r,!0,cn):r;if(e){const t=Bs(e.provider,e.prefix),s=e.name;return t.icons[s]||(t.missing.has(s)?null:void 0)}}function Hm(r,e){const t=wi(r,!0,cn);if(!t)return!1;const s=Bs(t.provider,t.prefix);return e?$m(s,t.name,e):(s.missing.add(t.name),!0)}function zm(r,e){if(typeof r!="object")return!1;if(typeof e!="string"&&(e=r.provider||""),cn&&!e&&!r.prefix){let n=!1;return uc(r)&&(r.prefix="",dc(r,(i,o)=>{Hm(i,o)&&(n=!0)})),n}const t=r.prefix;if(!Xn({prefix:t,name:"a"}))return!1;const s=Bs(e,t);return!!hc(s,r)}const pc=Object.freeze({width:null,height:null}),gc=Object.freeze({...pc,...oi}),Um=/(-?[0-9.]*[0-9]+[0-9.]*)/g,jm=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function ca(r,e,t){if(e===1)return r;if(t=t||100,typeof r=="number")return Math.ceil(r*e*t)/t;if(typeof r!="string")return r;const s=r.split(Um);if(s===null||!s.length)return r;const n=[];let i=s.shift(),o=jm.test(i);for(;;){if(o){const a=parseFloat(i);isNaN(a)?n.push(i):n.push(Math.ceil(a*e*t)/t)}else n.push(i);if(i=s.shift(),i===void 0)return n.join("");o=!o}}function Vm(r,e="defs"){let t="";const s=r.indexOf("<"+e);for(;s>=0;){const n=r.indexOf(">",s),i=r.indexOf("</"+e);if(n===-1||i===-1)break;const o=r.indexOf(">",i);if(o===-1)break;t+=r.slice(n+1,i).trim(),r=r.slice(0,s).trim()+r.slice(o+1)}return{defs:t,content:r}}function Wm(r,e){return r?"<defs>"+r+"</defs>"+e:e}function Gm(r,e,t){const s=Vm(r);return Wm(s.defs,e+s.content+t)}const Xm=r=>r==="unset"||r==="undefined"||r==="none";function Ym(r,e){const t={..._i,...r},s={...gc,...e},n={left:t.left,top:t.top,width:t.width,height:t.height};let i=t.body;[t,s].forEach(g=>{const m=[],v=g.hFlip,_=g.vFlip;let w=g.rotate;v?_?w+=2:(m.push("translate("+(n.width+n.left).toString()+" "+(0-n.top).toString()+")"),m.push("scale(-1 1)"),n.top=n.left=0):_&&(m.push("translate("+(0-n.left).toString()+" "+(n.height+n.top).toString()+")"),m.push("scale(1 -1)"),n.top=n.left=0);let x;switch(w<0&&(w-=Math.floor(w/4)*4),w=w%4,w){case 1:x=n.height/2+n.top,m.unshift("rotate(90 "+x.toString()+" "+x.toString()+")");break;case 2:m.unshift("rotate(180 "+(n.width/2+n.left).toString()+" "+(n.height/2+n.top).toString()+")");break;case 3:x=n.width/2+n.left,m.unshift("rotate(-90 "+x.toString()+" "+x.toString()+")");break}w%2===1&&(n.left!==n.top&&(x=n.left,n.left=n.top,n.top=x),n.width!==n.height&&(x=n.width,n.width=n.height,n.height=x)),m.length&&(i=Gm(i,'<g transform="'+m.join(" ")+'">',"</g>"))});const o=s.width,a=s.height,l=n.width,c=n.height;let d,u;o===null?(u=a===null?"1em":a==="auto"?c:a,d=ca(u,l/c)):(d=o==="auto"?l:o,u=a===null?ca(d,c/l):a==="auto"?c:a);const h={},f=(g,m)=>{Xm(m)||(h[g]=m.toString())};f("width",d),f("height",u);const p=[n.left,n.top,l,c];return h.viewBox=p.join(" "),{attributes:h,viewBox:p,body:i}}const Km=/\sid="(\S+)"/g,Zm="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Jm=0;function Qm(r,e=Zm){const t=[];let s;for(;s=Km.exec(r);)t.push(s[1]);if(!t.length)return r;const n="suffix"+(Math.random()*16777216|Date.now()).toString(16);return t.forEach(i=>{const o=typeof e=="function"?e(i):e+(Jm++).toString(),a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");r=r.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+o+n+"$3")}),r=r.replace(new RegExp(n,"g"),""),r}const xr=Object.create(null);function ey(r,e){xr[r]=e}function Sr(r){return xr[r]||xr[""]}function lo(r){let e;if(typeof r.resources=="string")e=[r.resources];else if(e=r.resources,!(e instanceof Array)||!e.length)return null;return{resources:e,path:r.path||"/",maxURL:r.maxURL||500,rotate:r.rotate||750,timeout:r.timeout||5e3,random:r.random===!0,index:r.index||0,dataAfterTimeout:r.dataAfterTimeout!==!1}}const co=Object.create(null),Ws=["https://api.simplesvg.com","https://api.unisvg.com"],Yn=[];for(;Ws.length>0;)Ws.length===1||Math.random()>.5?Yn.push(Ws.shift()):Yn.push(Ws.pop());co[""]=lo({resources:["https://api.iconify.design"].concat(Yn)});function ty(r,e){const t=lo(e);return t===null?!1:(co[r]=t,!0)}function uo(r){return co[r]}const sy=()=>{let r;try{if(r=fetch,typeof r=="function")return r}catch{}};let da=sy();function ny(r,e){const t=uo(r);if(!t)return 0;let s;if(!t.maxURL)s=0;else{let n=0;t.resources.forEach(o=>{n=Math.max(n,o.length)});const i=e+".json?icons=";s=t.maxURL-n-t.path.length-i.length}return s}function iy(r){return r===404}const ry=(r,e,t)=>{const s=[],n=ny(r,e),i="icons";let o={type:i,provider:r,prefix:e,icons:[]},a=0;return t.forEach((l,c)=>{a+=l.length+1,a>=n&&c>0&&(s.push(o),o={type:i,provider:r,prefix:e,icons:[]},a=l.length),o.icons.push(l)}),s.push(o),s};function oy(r){if(typeof r=="string"){const e=uo(r);if(e)return e.path}return"/"}const ay=(r,e,t)=>{if(!da){t("abort",424);return}let s=oy(e.provider);switch(e.type){case"icons":{const i=e.prefix,a=e.icons.join(","),l=new URLSearchParams({icons:a});s+=i+".json?"+l.toString();break}case"custom":{const i=e.uri;s+=i.slice(0,1)==="/"?i.slice(1):i;break}default:t("abort",400);return}let n=503;da(r+s).then(i=>{const o=i.status;if(o!==200){setTimeout(()=>{t(iy(o)?"abort":"next",o)});return}return n=501,i.json()}).then(i=>{if(typeof i!="object"||i===null){setTimeout(()=>{i===404?t("abort",i):t("next",n)});return}setTimeout(()=>{t("success",i)})}).catch(()=>{t("next",n)})},ly={prepare:ry,send:ay};function cy(r){const e={loaded:[],missing:[],pending:[]},t=Object.create(null);r.sort((n,i)=>n.provider!==i.provider?n.provider.localeCompare(i.provider):n.prefix!==i.prefix?n.prefix.localeCompare(i.prefix):n.name.localeCompare(i.name));let s={provider:"",prefix:"",name:""};return r.forEach(n=>{if(s.name===n.name&&s.prefix===n.prefix&&s.provider===n.provider)return;s=n;const i=n.provider,o=n.prefix,a=n.name,l=t[i]||(t[i]=Object.create(null)),c=l[o]||(l[o]=Bs(i,o));let d;a in c.icons?d=e.loaded:o===""||c.missing.has(a)?d=e.missing:d=e.pending;const u={provider:i,prefix:o,name:a};d.push(u)}),e}function mc(r,e){r.forEach(t=>{const s=t.loaderCallbacks;s&&(t.loaderCallbacks=s.filter(n=>n.id!==e))})}function dy(r){r.pendingCallbacksFlag||(r.pendingCallbacksFlag=!0,setTimeout(()=>{r.pendingCallbacksFlag=!1;const e=r.loaderCallbacks?r.loaderCallbacks.slice(0):[];if(!e.length)return;let t=!1;const s=r.provider,n=r.prefix;e.forEach(i=>{const o=i.icons,a=o.pending.length;o.pending=o.pending.filter(l=>{if(l.prefix!==n)return!0;const c=l.name;if(r.icons[c])o.loaded.push({provider:s,prefix:n,name:c});else if(r.missing.has(c))o.missing.push({provider:s,prefix:n,name:c});else return t=!0,!0;return!1}),o.pending.length!==a&&(t||mc([r],i.id),i.callback(o.loaded.slice(0),o.missing.slice(0),o.pending.slice(0),i.abort))})}))}let uy=0;function hy(r,e,t){const s=uy++,n=mc.bind(null,t,s);if(!e.pending.length)return n;const i={id:s,icons:e,callback:r,abort:n};return t.forEach(o=>{(o.loaderCallbacks||(o.loaderCallbacks=[])).push(i)}),n}function fy(r,e=!0,t=!1){const s=[];return r.forEach(n=>{const i=typeof n=="string"?wi(n,e,t):n;i&&s.push(i)}),s}var py={resources:[],index:0,timeout:2e3,rotate:750,random:!1,dataAfterTimeout:!1};function gy(r,e,t,s){const n=r.resources.length,i=r.random?Math.floor(Math.random()*n):r.index;let o;if(r.random){let b=r.resources.slice(0);for(o=[];b.length>1;){const A=Math.floor(Math.random()*b.length);o.push(b[A]),b=b.slice(0,A).concat(b.slice(A+1))}o=o.concat(b)}else o=r.resources.slice(i).concat(r.resources.slice(0,i));const a=Date.now();let l="pending",c=0,d,u=null,h=[],f=[];typeof s=="function"&&f.push(s);function p(){u&&(clearTimeout(u),u=null)}function g(){l==="pending"&&(l="aborted"),p(),h.forEach(b=>{b.status==="pending"&&(b.status="aborted")}),h=[]}function m(b,A){A&&(f=[]),typeof b=="function"&&f.push(b)}function v(){return{startTime:a,payload:e,status:l,queriesSent:c,queriesPending:h.length,subscribe:m,abort:g}}function _(){l="failed",f.forEach(b=>{b(void 0,d)})}function w(){h.forEach(b=>{b.status==="pending"&&(b.status="aborted")}),h=[]}function x(b,A,E){const C=A!=="success";switch(h=h.filter(k=>k!==b),l){case"pending":break;case"failed":if(C||!r.dataAfterTimeout)return;break;default:return}if(A==="abort"){d=E,_();return}if(C){d=E,h.length||(o.length?S():_());return}if(p(),w(),!r.random){const k=r.resources.indexOf(b.resource);k!==-1&&k!==r.index&&(r.index=k)}l="completed",f.forEach(k=>{k(E)})}function S(){if(l!=="pending")return;p();const b=o.shift();if(b===void 0){if(h.length){u=setTimeout(()=>{p(),l==="pending"&&(w(),_())},r.timeout);return}_();return}const A={status:"pending",resource:b,callback:(E,C)=>{x(A,E,C)}};h.push(A),c++,u=setTimeout(S,r.rotate),t(b,e,A.callback)}return setTimeout(S),v}function yc(r){const e={...py,...r};let t=[];function s(){t=t.filter(a=>a().status==="pending")}function n(a,l,c){const d=gy(e,a,l,(u,h)=>{s(),c&&c(u,h)});return t.push(d),d}function i(a){return t.find(l=>a(l))||null}return{query:n,find:i,setIndex:a=>{e.index=a},getIndex:()=>e.index,cleanup:s}}function ua(){}const Gi=Object.create(null);function my(r){if(!Gi[r]){const e=uo(r);if(!e)return;const t=yc(e),s={config:e,redundancy:t};Gi[r]=s}return Gi[r]}function yy(r,e,t){let s,n;if(typeof r=="string"){const i=Sr(r);if(!i)return t(void 0,424),ua;n=i.send;const o=my(r);o&&(s=o.redundancy)}else{const i=lo(r);if(i){s=yc(i);const o=r.resources?r.resources[0]:"",a=Sr(o);a&&(n=a.send)}}return!s||!n?(t(void 0,424),ua):s.query(e,n,t)().abort}function ha(){}function vy(r){r.iconsLoaderFlag||(r.iconsLoaderFlag=!0,setTimeout(()=>{r.iconsLoaderFlag=!1,dy(r)}))}function by(r){const e=[],t=[];return r.forEach(s=>{(s.match(lc)?e:t).push(s)}),{valid:e,invalid:t}}function Gs(r,e,t){function s(){const n=r.pendingIcons;e.forEach(i=>{n&&n.delete(i),r.icons[i]||r.missing.add(i)})}if(t&&typeof t=="object")try{if(!hc(r,t).length){s();return}}catch(n){console.error(n)}s(),vy(r)}function fa(r,e){r instanceof Promise?r.then(t=>{e(t)}).catch(()=>{e(null)}):e(r)}function wy(r,e){r.iconsToLoad?r.iconsToLoad=r.iconsToLoad.concat(e).sort():r.iconsToLoad=e,r.iconsQueueFlag||(r.iconsQueueFlag=!0,setTimeout(()=>{r.iconsQueueFlag=!1;const{provider:t,prefix:s}=r,n=r.iconsToLoad;if(delete r.iconsToLoad,!n||!n.length)return;const i=r.loadIcon;if(r.loadIcons&&(n.length>1||!i)){fa(r.loadIcons(n,s,t),d=>{Gs(r,n,d)});return}if(i){n.forEach(d=>{const u=i(d,s,t);fa(u,h=>{const f=h?{prefix:s,icons:{[d]:h}}:null;Gs(r,[d],f)})});return}const{valid:o,invalid:a}=by(n);if(a.length&&Gs(r,a,null),!o.length)return;const l=s.match(lc)?Sr(t):null;if(!l){Gs(r,o,null);return}l.prepare(t,s,o).forEach(d=>{yy(t,d,u=>{Gs(r,d.icons,u)})})}))}const _y=(r,e)=>{const t=fy(r,!0,fc()),s=cy(t);if(!s.pending.length){let l=!0;return e&&setTimeout(()=>{l&&e(s.loaded,s.missing,s.pending,ha)}),()=>{l=!1}}const n=Object.create(null),i=[];let o,a;return s.pending.forEach(l=>{const{provider:c,prefix:d}=l;if(d===a&&c===o)return;o=c,a=d,i.push(Bs(c,d));const u=n[c]||(n[c]=Object.create(null));u[d]||(u[d]=[])}),s.pending.forEach(l=>{const{provider:c,prefix:d,name:u}=l,h=Bs(c,d),f=h.pendingIcons||(h.pendingIcons=new Set);f.has(u)||(f.add(u),n[c][d].push(u))}),i.forEach(l=>{const c=n[l.provider][l.prefix];c.length&&wy(l,c)}),e?hy(e,s,i):ha};function Ay(r,e){const t={...r};for(const s in e){const n=e[s],i=typeof n;s in pc?(n===null||n&&(i==="string"||i==="number"))&&(t[s]=n):i===typeof t[s]&&(t[s]=s==="rotate"?n%4:n)}return t}const xy=/[\s,]+/;function Sy(r,e){e.split(xy).forEach(t=>{switch(t.trim()){case"horizontal":r.hFlip=!0;break;case"vertical":r.vFlip=!0;break}})}function Cy(r,e=0){const t=r.replace(/^-?[0-9.]*/,"");function s(n){for(;n<0;)n+=4;return n%4}if(t===""){const n=parseInt(r);return isNaN(n)?0:s(n)}else if(t!==r){let n=0;switch(t){case"%":n=25;break;case"deg":n=90}if(n){let i=parseFloat(r.slice(0,r.length-t.length));return isNaN(i)?0:(i=i/n,i%1===0?s(i):0)}}return e}function Ey(r,e){let t=r.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const s in e)t+=" "+s+'="'+e[s]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+t+">"+r+"</svg>"}function Ty(r){return r.replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\s+/g," ")}function ky(r){return"data:image/svg+xml,"+Ty(r)}function Py(r){return'url("'+ky(r)+'")'}const pa={...gc,inline:!1},My={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":!0,role:"img"},Dy={display:"inline-block"},Cr={backgroundColor:"currentColor"},vc={backgroundColor:"transparent"},ga={Image:"var(--svg)",Repeat:"no-repeat",Size:"100% 100%"},ma={webkitMask:Cr,mask:Cr,background:vc};for(const r in ma){const e=ma[r];for(const t in ga)e[r+t]=ga[t]}const Kn={};["horizontal","vertical"].forEach(r=>{const e=r.slice(0,1)+"Flip";Kn[r+"-flip"]=e,Kn[r.slice(0,1)+"-flip"]=e,Kn[r+"Flip"]=e});function ya(r){return r+(r.match(/^[-0-9.]+$/)?"px":"")}const va=(r,e)=>{const t=Ay(pa,e),s={...My},n=e.mode||"svg",i={},o=e.style,a=typeof o=="object"&&!(o instanceof Array)?o:{};for(let g in e){const m=e[g];if(m!==void 0)switch(g){case"icon":case"style":case"onLoad":case"mode":case"ssr":break;case"inline":case"hFlip":case"vFlip":t[g]=m===!0||m==="true"||m===1;break;case"flip":typeof m=="string"&&Sy(t,m);break;case"color":i.color=m;break;case"rotate":typeof m=="string"?t[g]=Cy(m):typeof m=="number"&&(t[g]=m);break;case"ariaHidden":case"aria-hidden":m!==!0&&m!=="true"&&delete s["aria-hidden"];break;default:{const v=Kn[g];v?(m===!0||m==="true"||m===1)&&(t[v]=!0):pa[g]===void 0&&(s[g]=m)}}}const l=Ym(r,t),c=l.attributes;if(t.inline&&(i.verticalAlign="-0.125em"),n==="svg"){s.style={...i,...a},Object.assign(s,c);let g=0,m=e.id;return typeof m=="string"&&(m=m.replace(/-/g,"_")),s.innerHTML=Qm(l.body,m?()=>m+"ID"+g++:"iconifyVue"),dt("svg",s)}const{body:d,width:u,height:h}=r,f=n==="mask"||(n==="bg"?!1:d.indexOf("currentColor")!==-1),p=Ey(d,{...c,width:u+"",height:h+""});return s.style={...i,"--svg":Py(p),width:ya(c.width),height:ya(c.height),...Dy,...f?Cr:vc,...a},dt("span",s)};fc(!0);ey("",ly);if(typeof document<"u"&&typeof window<"u"){const r=window;if(r.IconifyPreload!==void 0){const e=r.IconifyPreload,t="Invalid IconifyPreload syntax.";typeof e=="object"&&e!==null&&(e instanceof Array?e:[e]).forEach(s=>{try{(typeof s!="object"||s===null||s instanceof Array||typeof s.icons!="object"||typeof s.prefix!="string"||!zm(s))&&console.error(t)}catch{console.error(t)}})}if(r.IconifyProviders!==void 0){const e=r.IconifyProviders;if(typeof e=="object"&&e!==null)for(let t in e){const s="IconifyProviders["+t+"] is invalid.";try{const n=e[t];if(typeof n!="object"||!n||n.resources===void 0)continue;ty(t,n)||console.error(s)}catch{console.error(s)}}}}const Iy={..._i,body:""},ba=L((r,{emit:e})=>{const t=U(null);function s(){t.value&&(t.value.abort?.(),t.value=null)}const n=U(!!r.ssr),i=U(""),o=Et(null);function a(){const c=r.icon;if(typeof c=="object"&&c!==null&&typeof c.body=="string")return i.value="",{data:c};let d;if(typeof c!="string"||(d=wi(c,!1,!0))===null)return null;let u=qm(d);if(!u){const p=t.value;return(!p||p.name!==c)&&(u===null?t.value={name:c}:t.value={name:c,abort:_y([d],l)}),null}s(),i.value!==c&&(i.value=c,De(()=>{e("load",c)}));const h=r.customise;if(h){u=Object.assign({},u);const p=h(u.body,d.name,d.prefix,d.provider);typeof p=="string"&&(u.body=p)}const f=["iconify"];return d.prefix!==""&&f.push("iconify--"+d.prefix),d.provider!==""&&f.push("iconify--"+d.provider),{data:u,classes:f}}function l(){const c=a();c?c.data!==o.value?.data&&(o.value=c):o.value=null}return n.value?l():tt(()=>{n.value=!0,l()}),Ae(()=>r.icon,l),gn(s),()=>{const c=o.value;if(!c)return va(Iy,r);let d=r;return c.classes&&(d={...r,class:c.classes.join(" ")}),va({..._i,...c.data},d)}},{props:["icon","mode","ssr","width","height","style","color","inline","rotate","hFlip","horizontalFlip","vFlip","verticalFlip","flip","id","ariaHidden","customise","title"],emits:["load"]}),qe=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Er=[.001,0,0,.001,0,0],Xi=1.35,Ye={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Gt={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},dn="pdfjs_internal_editor_",re={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ue={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Ry={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Re={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Zn={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Pe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ss={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Ai={ERRORS:0,WARNINGS:1,INFOS:5},un={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Nn={moveTo:0,lineTo:1,curveTo:2,closePath:3},Oy={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let xi=Ai.WARNINGS;function Ly(r){Number.isInteger(r)&&(xi=r)}function Fy(){return xi}function Si(r){xi>=Ai.INFOS&&console.info(`Info: ${r}`)}function ie(r){xi>=Ai.WARNINGS&&console.warn(`Warning: ${r}`)}function me(r){throw new Error(r)}function he(r,e){r||me(e)}function By(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function bc(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=zy(r)}catch{}const s=e?URL.parse(r,e):URL.parse(r);return By(s)?s:null}function wc(r,e,t=!1){const s=URL.parse(r);return s?(s.hash=e,s.href):t&&bc(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ae(r,e,t,s=!1){return Object.defineProperty(r,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const ms=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class wa extends ms{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Yi extends ms{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Tr extends ms{constructor(e){super(e,"InvalidPDFException")}}class ai extends ms{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class Ny extends ms{constructor(e){super(e,"FormatError")}}class es extends ms{constructor(e){super(e,"AbortException")}}function _c(r){(typeof r!="object"||r?.length===void 0)&&me("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const s=[];for(let n=0;n<e;n+=t){const i=Math.min(n+t,e),o=r.subarray(n,i);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function An(r){typeof r!="string"&&me("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=r.charCodeAt(s)&255;return t}function $y(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function qy(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function Hy(){try{return new Function(""),!0}catch{return!1}}class Fe{static get isLittleEndian(){return ae(this,"isLittleEndian",qy())}static get isEvalSupported(){return ae(this,"isEvalSupported",Hy())}static get isOffscreenCanvasSupported(){return ae(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ae(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ae(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return ae(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Ki=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class K{static makeHexColor(e,t,s){return`#${Ki[e]}${Ki[t]}${Ki[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const n=e[s],i=e[s+1];e[s]=n*t[0]+i*t[2]+t[4],e[s+1]=n*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const n=t[0],i=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let d=0;d<6;d+=2){const u=e[s+d],h=e[s+d+1];e[s+d]=u*n+h*o+l,e[s+d+1]=u*i+h*a+c}}static applyInverseTransform(e,t){const s=e[0],n=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-n*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+n*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const n=t[0],i=t[1],o=t[2],a=t[3],l=t[4],c=t[5],d=e[0],u=e[1],h=e[2],f=e[3];let p=n*d+l,g=p,m=n*h+l,v=m,_=a*u+c,w=_,x=a*f+c,S=x;if(i!==0||o!==0){const b=i*d,A=i*h,E=o*u,C=o*f;p+=E,v+=E,m+=C,g+=C,_+=b,S+=b,x+=A,w+=A}s[0]=Math.min(s[0],p,m,g,v),s[1]=Math.min(s[1],_,x,w,S),s[2]=Math.max(s[2],p,m,g,v),s[3]=Math.max(s[3],_,x,w,S)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],n=e[1],i=e[2],o=e[3],a=s**2+n**2,l=s*i+n*o,c=i**2+o**2,d=(a+c)/2,u=Math.sqrt(d**2-(a*c-l**2));t[0]=Math.sqrt(d+u||1),t[1]=Math.sqrt(d-u||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>n)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[s,i,n,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,n,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,n),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,n)}static#e(e,t,s,n,i,o,a,l,c,d){if(c<=0||c>=1)return;const u=1-c,h=c*c,f=h*c,p=u*(u*(u*e+3*c*t)+3*h*s)+f*n,g=u*(u*(u*i+3*c*o)+3*h*a)+f*l;d[0]=Math.min(d[0],p),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],p),d[3]=Math.max(d[3],g)}static#t(e,t,s,n,i,o,a,l,c,d,u,h){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&this.#e(e,t,s,n,i,o,a,l,-u/d,h);return}const f=d**2-4*u*c;if(f<0)return;const p=Math.sqrt(f),g=2*c;this.#e(e,t,s,n,i,o,a,l,(-d+p)/g,h),this.#e(e,t,s,n,i,o,a,l,(-d-p)/g,h)}static bezierBoundingBox(e,t,s,n,i,o,a,l,c){c[0]=Math.min(c[0],e,a),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,a),c[3]=Math.max(c[3],t,l),this.#t(e,s,i,a,t,n,o,l,3*(-e+3*(s-i)+a),6*(e-2*s+i),3*(s-e),c),this.#t(e,s,i,a,t,n,o,l,3*(-t+3*(n-o)+l),6*(t-2*n+o),3*(n-t),c)}}function zy(r){return decodeURIComponent(escape(r))}let Zi=null,_a=null;function Uy(r){return Zi||(Zi=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_a=new Map([["","t"]])),r.replaceAll(Zi,(e,t,s)=>t?t.normalize("NFKC"):_a.get(s))}function Ac(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),_c(r)}const ho="pdfjs_internal_id_";function jy(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,n,...i]=t;if(!r(s)&&!Number.isInteger(s)||!e(n))return!1;const o=i.length;let a=!0;switch(n.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const l of i)if(!(typeof l=="number"||a&&l===null))return!1;return!0}function He(r,e,t){return Math.min(Math.max(r,e),t)}function xc(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(_c(r))}function Vy(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):An(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});class hn{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function n(i){if(!i)return;let o=null;const a=i.name;if(a==="#text")o=i.value;else if(hn.shouldBuildText(a))i?.attributes?.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const l of i.children)n(l)}return n(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Sc{static setupStorage(e,t,s,n,i){const o=n.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",a=>{n.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",a=>{n.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",a=>{n.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:n,linkService:i}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${n}`);for(const[l,c]of Object.entries(o))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}a&&i.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,n=e.xfaHtml,i=e.intent||"display",o=document.createElement(n.name);n.attributes&&this.setAttributes({html:o,element:n,intent:i,linkService:s});const a=i!=="richText",l=e.div;if(l.append(o),e.viewport){const u=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=u}a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const u=document.createTextNode(n.value);o.append(u),a&&hn.shouldBuildText(n.name)&&c.push(u)}return{textDivs:c}}const d=[[n,-1,o]];for(;d.length>0;){const[u,h,f]=d.at(-1);if(h+1===u.children.length){d.pop();continue}const p=u.children[++d.at(-1)[1]];if(p===null)continue;const{name:g}=p;if(g==="#text"){const v=document.createTextNode(p.value);c.push(v),f.append(v);continue}const m=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,g):document.createElement(g);if(f.append(m),p.attributes&&this.setAttributes({html:m,element:p,storage:t,intent:i,linkService:s}),p.children?.length>0)d.push([p,-1,m]);else if(p.value){const v=document.createTextNode(p.value);a&&hn.shouldBuildText(g)&&c.push(v),m.append(v)}}for(const u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Ot="http://www.w3.org/2000/svg";class Ns{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function xn(r,e="text"){if(Js(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class Sn{constructor({viewBox:e,userUnit:t,scale:s,rotation:n,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=n,this.offsetX=i,this.offsetY=o,s*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let d,u,h,f;switch(n%=360,n<0&&(n+=360),n){case 180:d=-1,u=0,h=0,f=1;break;case 90:d=0,u=1,h=1,f=0;break;case 270:d=0,u=-1,h=-1,f=0;break;case 0:d=1,u=0,h=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,f=-f);let p,g,m,v;d===0?(p=Math.abs(c-e[1])*s+i,g=Math.abs(l-e[0])*s+o,m=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(p=Math.abs(l-e[0])*s+i,g=Math.abs(c-e[1])*s+o,m=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[d*s,u*s,h*s,f*s,p-d*s*l-h*s*c,g-u*s*l-f*s*c],this.width=m,this.height=v}get rawDims(){const e=this.viewBox;return ae(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}={}){return new Sn({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return K.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];K.applyTransform(t,this.transform);const s=[e[2],e[3]];return K.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return K.applyInverseTransform(s,this.transform),s}}class fo extends ms{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Ci(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function po(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function Wy(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function Gy(r,e="document.pdf"){if(typeof r!="string")return e;if(Ci(r))return ie('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(a=>{try{return new URL(a)}catch{try{return new URL(decodeURIComponent(a))}catch{try{return new URL(a,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(a),"https://foo.bar")}catch{return null}}}}})(r);if(!s)return e;const n=a=>{try{let l=decodeURIComponent(a);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:a):l}catch{return a}},i=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(i.test(o))return n(o);if(s.searchParams.size>0){const a=Array.from(s.searchParams.values()).reverse();for(const c of a)if(i.test(c))return n(c);const l=Array.from(s.searchParams.keys()).reverse();for(const c of l)if(i.test(c))return n(c)}if(s.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(l)return n(l[0])}return e}class Aa{started=Object.create(null);times=[];time(e){e in this.started&&ie(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ie(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:n,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-n}ms
`);return e.join("")}}function Js(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function lt(r){r.preventDefault()}function Ce(r){r.preventDefault(),r.stopPropagation()}function Xy(r){console.log("Deprecated API usage: "+r)}class kr{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(o+=d,a+=u):c==="+"&&(o-=d,a-=u),new Date(Date.UTC(s,n,i,o,a,l))}}function Yy(r,{scale:e=1,rotation:t=0}){const{width:s,height:n}=r.attributes.style,i=[0,0,parseInt(s),parseInt(n)];return new Sn({viewBox:i,userUnit:1,scale:e,rotation:t})}function Cn(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ie(`Not a valid color format: "${r}"`),[0,0,0])}function Ky(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;r.set(t,Cn(s))}e.remove()}function xe(r){const{a:e,b:t,c:s,d:n,e:i,f:o}=r.getTransform();return[e,t,s,n,i,o]}function _t(r){const{a:e,b:t,c:s,d:n,e:i,f:o}=r.getTransform().invertSelf();return[e,t,s,n,i,o]}function us(r,e,t=!1,s=!0){if(e instanceof Sn){const{pageWidth:n,pageHeight:i}=e.rawDims,{style:o}=r,a=Fe.isCSSRoundSupported,l=`var(--total-scale-factor) * ${n}px`,c=`var(--total-scale-factor) * ${i}px`,d=a?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,u=a?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(o.width=d,o.height=u):(o.width=u,o.height=d)}s&&r.setAttribute("data-main-rotation",e.rotation)}class Pt{constructor(){const{pixelRatio:e}=Pt;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,n,i=-1){let o=1/0,a=1/0,l=1/0;s=Pt.capPixels(s,i),s>0&&(o=Math.sqrt(s/(e*t))),n!==-1&&(a=n/e,l=n/t);const c=Math.min(o,a,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Pr=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Zy{static get isDarkMode(){return ae(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Jy{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),ae(this,"commentForegroundColor",Cn(s))}}function Qy(r,e,t,s){s=Math.min(Math.max(s??1,0),1);const n=255*(1-s);return r=Math.round(r*s+n),e=Math.round(e*s+n),t=Math.round(t*s+n),[r,e,t]}function xa(r,e){const t=r[0]/255,s=r[1]/255,n=r[2]/255,i=Math.max(t,s,n),o=Math.min(t,s,n),a=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const l=i-o;switch(e[1]=a<.5?l/(i+o):l/(2-i-o),i){case t:e[0]=((s-n)/l+(s<n?6:0))*60;break;case s:e[0]=((n-t)/l+2)*60;break;case n:e[0]=((t-s)/l+4)*60;break}}e[2]=a}function Mr(r,e){const t=r[0],s=r[1],n=r[2],i=(1-Math.abs(2*n-1))*s,o=i*(1-Math.abs(t/60%2-1)),a=n-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+a,e[1]=o+a,e[2]=a;break;case 1:e[0]=o+a,e[1]=i+a,e[2]=a;break;case 2:e[0]=a,e[1]=i+a,e[2]=o+a;break;case 3:e[0]=a,e[1]=o+a,e[2]=i+a;break;case 4:e[0]=o+a,e[1]=a,e[2]=i+a;break;case 5:case 6:e[0]=i+a,e[1]=a,e[2]=o+a;break}}function Sa(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function Ca(r,e,t){Mr(r,t),t.map(Sa);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];Mr(e,t),t.map(Sa);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>n?(s+.05)/(n+.05):(n+.05)/(s+.05)}const Ea=new Map;function ev(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=Ea.get(t);if(s)return s;const n=new Float32Array(9),i=n.subarray(0,3),o=n.subarray(3,6);xa(r,o);const a=n.subarray(6,9);xa(e,a);const l=a[2]<.5,c=l?12:4.5;if(o[2]=l?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Ca(o,a,i)<c){let d,u;l?(d=o[2],u=1):(d=0,u=o[2]);const h=.005;for(;u-d>h;){const f=o[2]=(d+u)/2;l===Ca(o,a,i)<c?d=f:u=f}o[2]=l?u:d}return Mr(o,i),s=K.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),Ea.set(t,s),s}function Cc({html:r,dir:e,className:t},s){const n=document.createDocumentFragment();if(typeof r=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=r.split(/(?:\r\n?|\n)/);for(let a=0,l=o.length;a<l;++a){const c=o[a];i.append(document.createTextNode(c)),a<l-1&&i.append(document.createElement("br"))}n.append(i)}else Sc.render({xfaHtml:r,div:n,intent:"richText"});n.firstChild.classList.add("richText",t),s.append(n)}class sn{#e=null;#t=null;#n;#s=null;#o=null;#i=null;#r=null;#a=null;static#c=null;constructor(e){this.#n=e,sn.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",lt,{signal:t}),e.addEventListener("pointerdown",sn.#l,{signal:t}));const s=this.#s=document.createElement("div");s.className="buttons",e.append(s);const n=this.#n.toolbarPosition;if(n){const{style:i}=e,o=this.#n._uiManager.direction==="ltr"?1-n[0]:n[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#n._focusEventsAllowed=!1,Ce(e)}#u(e){this.#n._focusEventsAllowed=!0,Ce(e)}#f(e){const t=this.#n._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",lt,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#o?.shown(),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",sn.#c[e]),this.#f(s)&&s.addEventListener("click",n=>{t.delete()},{signal:t._signal}),this.#s.append(s)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#s.append(t,this.#m),this.#o=e}addComment(e,t=null){if(this.#i)return;const s=e.renderForToolbar();if(!s)return;this.#f(s);const n=this.#r=this.#m;t?(this.#s.insertBefore(s,t),this.#s.insertBefore(n,t)):this.#s.append(s,n),this.#i=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#s.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#a=await e.renderEditButton(this.#n);this.#f(t),this.#s.append(t,this.#m)}removeButton(e){switch(e){case"comment":this.#i?.removeToolbarCommentButton(),this.#i=null,this.#r?.remove(),this.#r=null;break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,s){const n=this.#s.querySelector(s);n&&e==="comment"&&this.addComment(t,n)}updateEditSignatureButton(e){this.#a&&(this.#a.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class tv{#e=null;#t=null;#n;constructor(e){this.#n=e}#s(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#n._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",lt,{signal:t});const s=this.#e=document.createElement("div");return s.className="buttons",e.append(s),this.#n.hasCommentManager()&&this.#i("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#i("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),e}#o(e,t){let s=0,n=0;for(const i of e){const o=i.y+i.height;if(o<s)continue;const a=i.x+(t?i.width:0);if(o>s){n=a,s=o;continue}t?a>n&&(n=a):a<n&&(n=a)}return[t?1-n:n,s]}show(e,t,s){const[n,i]=this.#o(t,s),{style:o}=this.#t||=this.#s();e.append(this.#t),o.insetInlineEnd=`${100*n}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(e,t,s,n){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const a=this.#n._signal;a instanceof AbortSignal&&!a.aborted&&(i.addEventListener("contextmenu",lt,{signal:a}),i.addEventListener("click",n,{signal:a})),this.#e.append(i)}}function Ec(r,e,t){for(const s of t)e.addEventListener(s,r[s].bind(r))}class sv{#e=0;get id(){return`${dn}${this.#e++}`}}class go{#e=Ac();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const i=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ae(this,"_isSVGFittingCanvas",i)}async#s(e,t){this.#n||=new Map;let s=this.#n.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let n;if(typeof t=="string"?(s.url=t,n=await xn(t,"blob")):t instanceof File?n=s.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const i=go._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((c,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,c()},o.onload=async()=>{const u=s.svgUrl=o.result;a.src=await i?`${u}#svgView(preserveAspectRatio(none))`:u},a.onerror=o.onerror=d});o.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){ie(n),s=null}return this.#n.set(e,s),s&&this.#n.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:n,type:i}=e;return this.#s(`${t}_${s}_${n}_${i}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromBlob(e,t){const s=await t;return this.#s(e,s)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let s=this.#n.get(e);if(s?.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,s),this.#n.set(s.id,s),s}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const n=new OffscreenCanvas(s.width,s.height);n.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=n.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class nv{#e=[];#t=!1;#n;#s=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:s,mustExec:n,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(n&&e(),this.#t)return;const l={cmd:e,undo:t,post:s,type:i};if(this.#s===-1){this.#e.length>0&&(this.#e.length=0),this.#s=0,this.#e.push(l);return}if(o&&this.#e[this.#s].type===i){a&&(l.undo=this.#e[this.#s].undo),this.#e[this.#s]=l;return}const c=this.#s+1;c===this.#n?this.#e.splice(0,1):(this.#s=c,c<this.#e.length&&this.#e.splice(c)),this.#e.push(l)}undo(){if(this.#s===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1,this.#s-=1}redo(){if(this.#s<this.#e.length-1){this.#s+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#e.length-1}cleanType(e){if(this.#s!==-1){for(let t=this.#s;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#s-t),this.#s=t;return}this.#e.length=0,this.#s=-1}}destroy(){this.#e=null}}class En{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Fe.platform;for(const[s,n,i={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:n,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:n,options:i}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:n,options:{bubbles:i=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(n.bind(e,...o,t)(),i||Ce(t))}}class mo{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Ky(e),ae(this,"_colors",e)}convert(e){const t=Cn(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,n]of this._colors)if(n.every((i,o)=>i===t[o]))return mo._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?K.makeHexColor(...t):e}}class ts{#e=new AbortController;#t=null;#n=null;#s=new Map;#o=new Map;#i=null;#r=null;#a=null;#c=new nv;#l=null;#h=null;#u=null;#f=0;#m=new Set;#p=null;#d=null;#g=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#C=null;#x=null;#w=null;#T=null;#A=!1;#S=null;#M=new sv;#k=!1;#P=!1;#B=!1;#I=null;#O=null;#N=null;#L=null;#j=null;#E=re.NONE;#_=new Set;#R=null;#$=null;#H=null;#G=null;#W=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#F=null;#V=null;#J=null;#Q=null;#q=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=ts.prototype,t=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return ae(this,"_keyboardManager",new En([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#V.contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,s,n,i,o,a,l,c,d,u,h,f,p,g,m){const v=this._signal=this.#e.signal;this.#V=e,this.#J=t,this.#Q=s,this.#i=n,this.#l=i,this.#$=o,this.#W=l,this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:v}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),a._on("setpreference",this.onSetPreference.bind(this),{signal:v}),a._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:v}),window.addEventListener("pointerdown",()=>{this.#P=!0},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{this.#P=!1},{capture:!0,signal:v}),this.#le(),this.#he(),this.#te(),this.#r=l.annotationStorage,this.#C=l.filterFactory,this.#H=c,this.#T=d||null,this.#y=u,this.#b=h,this.#v=f,this.#j=p||null,this.viewParameters={realScale:Ns.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1,i?.setSidebarUiManager(this)}destroy(){this.#q?.resolve(),this.#q=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#o.values())e.destroy();this.#o.clear(),this.#s.clear(),this.#g.clear(),this.#L?.clear(),this.#t=null,this.#_.clear(),this.#c.destroy(),this.#i?.destroy(),this.#l?.destroy(),this.#$?.destroy(),this.#S?.hide(),this.#S=null,this.#N?.destroy(),this.#N=null,this.#n=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#F&&(clearTimeout(this.#F),this.#F=null),this._editorUndoBar?.destroy(),this.#W=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#j}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return ae(this,"hcmFilter",this.#H?this.#C.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return ae(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return ae(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ae(this,"highlightColors",null);const t=new Map,s=!!this.#H;for(const[n,i]of e){const o=n.endsWith("_HCM");if(s&&o){t.set(n.replace("_HCM",""),i);continue}!s&&!o&&t.set(n,i)}return ae(this,"highlightColors",t)}get highlightColorNames(){return ae(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=e}setMainHighlightColorPicker(e){this.#N=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,s,n){this.#l?.showDialog(this,e,t,s,n)}selectComment(e,t){this.#o.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,s=void 0){this.#l?.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#o.has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),n=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",n),t())};this._eventBus.on("editorsrendered",n),await s}getSignature(e){this.#$?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#$}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#v=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const s of this.#o.values()){const{x:n,y:i,width:o,height:a}=s.div.getBoundingClientRect();if(e>=n&&e<=n+o&&t>=i&&t<=i+a)return s}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#g.add(e)}removeShouldRescale(e){this.#g.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Ns.PDF_TO_CSS_UNITS;for(const t of this.#g)t.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Z({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#o.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:o,focusOffset:a}=s,l=s.toString(),d=this.#Z(s).closest(".textLayer"),u=this.getSelectionBoxes(d);if(!u)return;s.empty();const h=this.#ee(d),f=this.#E===re.NONE,p=()=>{const g=h?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:n,anchorOffset:i,focusNode:o,focusOffset:a,text:l});f&&this.showAllEditors("highlight",!0,!0),t&&g?.editComment()};if(f){this.switchToMode(re.HIGHLIGHT,p);return}p()}commentSelection(e=""){this.highlightSelection(e,!0)}#oe(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#Z(e).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(this.#S||=new tv(this),this.#S.show(s,n,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#r)return null;const t=`${dn}${e}`,s=this.#r.getRawValue(t);return s&&this.#r.remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}a11yAlert(e,t=null){const s=this.#Q;s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}#ae(){const e=document.getSelection();if(!e||e.isCollapsed){this.#R&&(this.#S?.hide(),this.#R=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#R)return;const n=this.#Z(e).closest(".textLayer");if(!n){this.#R&&(this.#S?.hide(),this.#R=null,this.#D({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#R=t,this.#D({hasSelectedText:!0}),!(this.#E!==re.HIGHLIGHT&&this.#E!==re.NONE)&&(this.#E===re.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#E===re.HIGHLIGHT?this.#ee(n):null;if(i?.toggleDrawing(),this.#P){const o=new AbortController,a=this.combinedSignal(o),l=c=>{c.type==="pointerup"&&c.button!==0||(o.abort(),i?.toggleDrawing(!0),c.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",l,{signal:a}),window.addEventListener("blur",l,{signal:a})}else i?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#E===re.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#oe()}#le(){document.addEventListener("selectionchange",this.#ae.bind(this),{signal:this._signal})}#ce(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#de(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#_)if(t.div.contains(e)){this.#O=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#O)return;const[e,t]=this.#O;this.#O=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#I)return;this.#I=new AbortController;const e=this.combinedSignal(this.#I);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ue(){this.#I?.abort(),this.#I=null}#se(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ne(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.#se()}removeEditListeners(){this.#ue(),this.#ne()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#d)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#d)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#_){const n=s.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of this.#d)if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){ie(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const i=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;i.push(c)}const o=()=>{for(const l of i)this.#ie(l);this.#re(i)},a=()=>{for(const l of i)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(i){ie(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==re.NONE&&!this.isEditorHandlingKeyboard&&ts._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(e){Object.entries(e).some(([s,n])=>this.#X[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#E===re.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#U([[ue.HIGHLIGHT_FREE,!0]]))}#U(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ce(),this.#se(),this.#D({isEditing:this.#E!==re.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#de(),this.#ne(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#d){this.#d=e;for(const t of this.#d)this.#U(t.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#o.get(this.#f)}getLayer(e){return this.#o.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#o.set(e.pageIndex,e),this.#k?e.enable():e.disable()}removeLayer(e){this.#o.delete(e.pageIndex)}async updateMode(e,t=null,s=!1,n=!1,i=!1){if(this.#E!==e&&!(this.#q&&(await this.#q.promise,!this.#q))){if(this.#q=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#E===re.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#E=e,e===re.NONE){this.setEditingState(!1),this.#pe();for(const o of this.#s.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#q.resolve();return}for(const o of this.#s.values())o.addStandaloneCommentButton();e===re.SIGNATURE&&await this.#$?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const o of this.#o.values())o.updateMode(e);if(e===re.POPUP){this.#n||=await this.#W.getAnnotationsByType(new Set(this.#d.map(l=>l._editorType)));const o=new Set,a=[];for(const l of this.#s.values()){const{annotationElementId:c,hasComment:d,deleted:u}=l;c&&o.add(c),d&&!u&&a.push(l.getData())}for(const l of this.#n){const{id:c,popupRef:d,contentsObj:u}=l;d&&u?.str&&!o.has(c)&&!this.#m.has(c)&&a.push(l)}this.#l?.showSidebar(a)}if(!t){s&&this.addNewEditorFromKeyboard(),this.#q.resolve();return}for(const o of this.#s.values())o.uid===t?(this.setSelected(o),i?o.editComment():n?o.enterInEditMode():o.focus()):o.unselect();this.#q.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#d){switch(e){case ue.CREATE:this.currentLayer.addNewEditor(t);return;case ue.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of this.#_)s.updateParams(e,t);else for(const s of this.#d)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const i of this.#s.values())i.editorType===e&&i.show(t);(this.#G?.get(ue.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#U([[ue.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#B!==e){this.#B=e;for(const t of this.#o.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#k){this.#k=!0;const e=[];for(const t of this.#o.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#pe(){if(this.unselectAll(),this.#k){this.#k=!1;for(const e of this.#o.values())e.disable();for(const e of this.#s.values())e.disable()}}*getEditors(e){for(const t of this.#s.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#s.delete(e.id),e.annotationElementId&&this.#L?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ie(e){const t=this.#o.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#U(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#_);return e}updateUI(e){this.#ge===e&&this.#U(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#U(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#_.has(e)){this.#_.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#_.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#u?.commitOrRemove();for(const t of this.#_)t!==e&&t.unselect();this.#_.clear(),this.#_.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#_.has(e)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(e){e.unselect(),this.#_.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(e){this.#c.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(e){this.#c.cleanType(e)}#K(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#_],s=()=>{this._editorUndoBar?.show(n,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},n=()=>{for(const i of t)this.#ie(i)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#re(e){for(const t of this.#_)t.unselect();this.#_.clear();for(const t of e)t.isEmpty()||(this.#_.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#_)e.commit();this.#re(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#E!==re.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const e of this.#_)e.unselect();this.#_.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[n,i]=this.#z,o=[...this.#_],a=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const l of o)this.#s.has(l.id)&&(l.translateInPage(n,i),l.translationDone())},undo:()=>{for(const l of o)this.#s.has(l.id)&&(l.translateInPage(-n,-i),l.translationDone())},mustExec:!1})},a);for(const l of o)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const e of this.#_)this.#p.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const e=this.#p;this.#p=null;let t=!1;for(const[{x:n,y:i,pageIndex:o},a]of e)a.newX=n,a.newY=i,a.newPageIndex=o,t||=n!==a.savedX||i!==a.savedY||o!==a.savedPageIndex;if(!t)return!1;const s=(n,i,o,a)=>{if(this.#s.has(n.id)){const l=this.#o.get(a);l?n._setParentAndPosition(l,i,o):(n.pageIndex=a,n.x=i,n.y=o)}};return this.addCommands({cmd:()=>{for(const[n,{newX:i,newY:o,newPageIndex:a}]of e)s(n,i,o,a)},undo:()=>{for(const[n,{savedX:i,savedY:o,savedPageIndex:a}]of e)s(n,i,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#p)for(const s of this.#p.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#E}isEditingMode(){return this.#E!==re.NONE}get imageManager(){return ae(this,"imageManager",new go)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,d=t.rangeCount;c<d;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:i,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(c,d,u,h)=>({x:(d-n)/o,y:1-(c+u-s)/i,width:h/o,height:u/i});break;case"180":a=(c,d,u,h)=>({x:1-(c+u-s)/i,y:1-(d+h-n)/o,width:u/i,height:h/o});break;case"270":a=(c,d,u,h)=>({x:1-(d+h-n)/o,y:(c-s)/i,width:h/o,height:u/i});break;default:a=(c,d,u,h)=>({x:(c-s)/i,y:(d-n)/o,width:u/i,height:h/o});break}const l=[];for(let c=0,d=t.rangeCount;c<d;c++){const u=t.getRangeAt(c);if(!u.collapsed)for(const{x:h,y:f,width:p,height:g}of u.getClientRects())p===0||g===0||l.push(a(h,f,p,g))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#a||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#a?.delete(e)}renderAnnotationElement(e){const t=this.#a?.get(e.data.id);if(!t)return;const s=this.#r.getRawValue(t);s&&(this.#E===re.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){const n=this.#L?.get(e);n&&(n.setCanvas(t,s),this.#L.delete(e))}addMissingCanvas(e,t){(this.#L||=new Map).set(e,t)}}class St{#e=null;#t=!1;#n=null;#s=null;#o=null;#i=null;#r=!1;#a=null;#c=null;#l=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#u=e._uiManager.useNewAltTextFlow,St.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){St._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#s=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",St.#f.missing),t.setAttribute("data-l10n-id",St.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;e.addEventListener("contextmenu",lt,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const n=i=>{i.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#r=!0,n(i))},{signal:s}),await this.#p(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await St._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){const t=this.#a=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#a.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:n,cancel:i=!1}){s&&(this.#l=s,this.#h=n),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#n&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#s=null,this.#o=null,this.#a?.remove(),this.#a=null}async#p(){const e=this.#n;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",St.#f[this.#m]),this.#s?.setAttribute("data-l10n-id",St.#f[`${this.#m}-label`]),!this.#e){this.#o?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#o?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#o;if(!t){this.#o=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const n=100,i=this.#c._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#o.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#o?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class $n{#e=null;#t=null;#n=!1;#s=null;#o=null;#i=null;#r=null;#a=null;#c=!1;#l=null;constructor(e){this.#s=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#s.commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(this.#s._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const n=this.#s.commentButtonColor;n&&(s.backgroundColor=n)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#s.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#s._uiManager.updatePopupColor(this.#s)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#s.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:s}=this.#e.getBoundingClientRect(),{x:n,y:i,width:o,height:a}=this.#s.parent.boundingClientRect;return[(e-n)/o,(t+s-i)/a]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#s._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#s._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=this.#s._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",lt,{signal:s}),t&&(e.addEventListener("focusin",i=>{this.#s._focusEventsAllowed=!1,Ce(i)},{capture:!0,signal:s}),e.addEventListener("focusout",i=>{this.#s._focusEventsAllowed=!0,Ce(i)},{capture:!0,signal:s})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const n=i=>{i.preventDefault(),e===this.#t?this.edit():this.#s.toggleComment(!0)};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#n=!0,n(i))},{signal:s}),e.addEventListener("pointerenter",()=>{this.#s.toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{this.#s.toggleComment(!1,!1)},{signal:s}),e}edit(e){const t=this.commentPopupPositionInLayer;let s,n;if(t)[s,n]=t;else{[s,n]=this.#s.commentButtonPosition;const{width:d,height:u,x:h,y:f}=this.#s;s=h+s*d,n=f+n*u}const i=this.#s.parent.boundingClientRect,{x:o,y:a,width:l,height:c}=i;this.#s._uiManager.editComment(this.#s,o+s*l,a+n*c,{...e,parentDimensions:i})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#o}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#i,date:this.#a,deleted:this.isDeleted()}}set data(e){if(e!==this.#r&&(this.#i=null),e===null){this.#r="",this.#c=!0;return}this.#r=e,this.#a=new Date,this.#c=!1}setInitialText(e,t=null){this.#o=e,this.data=e,this.#a=null,this.#i=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#r="",this.#i=null,this.#a=null,this.#s=null,this.#n=!1,this.#c=!1}}class Ei{#e;#t=!1;#n=null;#s;#o;#i;#r;#a=null;#c;#l=null;#h;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:n=null,onPinching:i=null,onPinchEnd:o=null,signal:a}){this.#e=e,this.#n=s,this.#s=t,this.#o=n,this.#i=i,this.#r=o,this.#h=new AbortController,this.#c=AbortSignal.any([a,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Pt.pixelRatio}#f(e){if(this.#s?.())return;if(e.touches.length===1){if(this.#a)return;const n=this.#a=new AbortController,i=AbortSignal.any([this.#c,n.signal]),o=this.#e,a={capture:!0,signal:i,passive:!1},l=c=>{c.pointerType==="touch"&&(this.#a?.abort(),this.#a=null)};o.addEventListener("pointerdown",c=>{c.pointerType==="touch"&&(Ce(c),l(c))},a),o.addEventListener("pointerup",l,a),o.addEventListener("pointercancel",l,a);return}if(!this.#u){this.#u=new AbortController;const n=AbortSignal.any([this.#c,this.#u.signal]),i=this.#e,o={signal:n,capture:!1,passive:!1};i.addEventListener("touchmove",this.#m.bind(this),o);const a=this.#p.bind(this);i.addEventListener("touchend",a,o),i.addEventListener("touchcancel",a,o),o.capture=!0,i.addEventListener("pointerdown",Ce,o),i.addEventListener("pointermove",Ce,o),i.addEventListener("pointercancel",Ce,o),i.addEventListener("pointerup",Ce,o),this.#o?.()}if(Ce(e),e.touches.length!==2||this.#n?.()){this.#l=null;return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;Ce(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:n,screenY:i}=t,{screenX:o,screenY:a}=s,l=this.#l,{touch0X:c,touch0Y:d,touch1X:u,touch1Y:h}=l,f=u-c,p=h-d,g=o-n,m=a-i,v=Math.hypot(g,m)||1,_=Math.hypot(f,p)||1;if(!this.#t&&Math.abs(_-v)<=Ei.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=n,l.touch0Y=i,l.touch1X=o,l.touch1Y=a,!this.#t){this.#t=!0;return}const w=[(n+o)/2,(i+a)/2];this.#i?.(w,_,v)}#p(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#r?.()),this.#l&&(Ce(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#a?.abort(),this.#a=null}}class Q{#e=null;#t=null;#n=null;#s=null;#o=null;#i=!1;#r=null;#a="";#c=null;#l=null;#h=null;#u=null;#f=null;#m="";#p=!1;#d=null;#g=!1;#y=!1;#b=!1;#v=null;#C=0;#x=0;#w=null;#T=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#S=Q._zIndex++;static _borderLineWidth=-1;static _colorManager=new mo;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Q.prototype._resizeWithKeyboard,t=ts.TRANSLATE_SMALL,s=ts.TRANSLATE_BIG;return ae(this,"_resizerKeyboardManager",new En([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Q.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[i,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ae(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new iv({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Q._l10n??=e,Q._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Q._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Q._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(e){this.#A=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#F(),this.#u?.remove(),this.#u=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,n){const[i,o]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(e+s)/i,this.y=(t+n)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,n]=this.parentDimensions;this.setAt(e*s,t*n,this.width*s,this.height*n),this._onTranslated()}#M([e,t],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#M(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#d||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[n,i]}=this;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,c]=this.getBaseTranslation();o+=l,a+=c;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}get _hasBeenResized(){return!!this.#d&&(this.#d[2]!==this.width||this.#d[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Q,n=s/e,i=s/t;switch(this.rotation){case 90:return[-n,i];case 180:return[n,i];case 270:return[n,-i];default:return[-n,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,n]}=this;let{x:i,y:o,width:a,height:l}=this;if(a*=s,l*=n,i*=s,o*=n,this._mustFixPosition)switch(e){case 0:i=He(i,0,s-a),o=He(o,0,n-l);break;case 90:i=He(i,0,s-l),o=He(o,a,n);break;case 180:i=He(i,a,s),o=He(o,l,n);break;case 270:i=He(i,l,s),o=He(o,0,n-a);break}this.x=i/=s,this.y=o/=n;const[c,d]=this.getBaseTranslation();i+=c,o+=d,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Q.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Q.#k(e,t,360-this.parentRotation)}#P(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#B(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const n=document.createElement("div");this.#c.append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",this.#I.bind(this,s),{signal:t}),n.addEventListener("contextmenu",lt,{signal:t}),n.tabIndex=-1}this.div.prepend(this.#c)}#I(e,t){t.preventDefault();const{isMac:s}=Fe.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#n?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Ce,{passive:!1,signal:o}),window.addEventListener("contextmenu",lt,{signal:o}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=a,this.div.style.cursor=l,this.#N()};window.addEventListener("pointerup",c,{signal:o}),window.addEventListener("blur",c,{signal:o})}#O(e,t,s,n){this.width=s,this.height=n,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#N(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:n}=this.#h;this.#h=null;const i=this.x,o=this.y,a=this.width,l=this.height;i===e&&o===t&&a===s&&l===n||this.addCommands({cmd:this.#O.bind(this,i,o,a,l),undo:this.#O.bind(this,e,t,s,n),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#L(e,t){const[s,n]=this.parentDimensions,i=this.x,o=this.y,a=this.width,l=this.height,c=Q.MIN_SIZE/s,d=Q.MIN_SIZE/n,u=this.#P(this.rotation),h=(B,j)=>[u[0]*B+u[2]*j,u[1]*B+u[3]*j],f=this.#P(360-this.rotation),p=(B,j)=>[f[0]*B+f[2]*j,f[1]*B+f[3]*j];let g,m,v=!1,_=!1;switch(e){case"topLeft":v=!0,g=(B,j)=>[0,0],m=(B,j)=>[B,j];break;case"topMiddle":g=(B,j)=>[B/2,0],m=(B,j)=>[B/2,j];break;case"topRight":v=!0,g=(B,j)=>[B,0],m=(B,j)=>[0,j];break;case"middleRight":_=!0,g=(B,j)=>[B,j/2],m=(B,j)=>[0,j/2];break;case"bottomRight":v=!0,g=(B,j)=>[B,j],m=(B,j)=>[0,0];break;case"bottomMiddle":g=(B,j)=>[B/2,j],m=(B,j)=>[B/2,0];break;case"bottomLeft":v=!0,g=(B,j)=>[0,j],m=(B,j)=>[B,0];break;case"middleLeft":_=!0,g=(B,j)=>[0,j/2],m=(B,j)=>[B,j/2];break}const w=g(a,l),x=m(a,l);let S=h(...x);const b=Q._round(i+S[0]),A=Q._round(o+S[1]);let E=1,C=1,k,D;if(t.fromKeyboard)({deltaX:k,deltaY:D}=t);else{const{screenX:B,screenY:j}=t,[T,M]=this.#l;[k,D]=this.screenToPageTranslation(B-T,j-M),this.#l[0]=B,this.#l[1]=j}if([k,D]=p(k/s,D/n),v){const B=Math.hypot(a,l);E=C=Math.max(Math.min(Math.hypot(x[0]-w[0]-k,x[1]-w[1]-D)/B,1/a,1/l),c/a,d/l)}else _?E=He(Math.abs(x[0]-w[0]-k),c,1)/a:C=He(Math.abs(x[1]-w[1]-D),d,1)/l;const q=Q._round(a*E),Y=Q._round(l*C);S=h(...m(q,Y));const F=b-S[0],G=A-S[1];this.#d||=[this.x,this.y,this.width,this.height],this.width=q,this.height=Y,this.x=F,this.y=G,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new sn(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(St.initialize(Q._l10n),this.#n=new St(this),this.#e&&(this.#n.data=this.#e,this.#e=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#s?.focusButton()}addCommentButton(){return this.#s||=new $n(this)}addStandaloneCommentButton(){if(this.#o){this._uiManager.isEditingMode()&&this.#o.classList.remove("hidden");return}this.hasComment&&(this.#o=this.#s.renderForStandalone(),this.div.append(this.#o))}removeStandaloneCommentButton(){this.#s.removeStandaloneCommentButton(),this.#o=null}hideStandaloneCommentButton(){this.#o?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:n}}=this.#s;return{text:t,richText:e,date:s,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#s||=new $n(this),this.#s.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(this.#s||=new $n(this),this.#s.setInitialText(e,s),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){return this.#s?.hasBeenEdited()}get hasDeletedComment(){return this.#s?.isDeleted()}get hasComment(){return!!this.#s&&!this.#s.isEmpty()&&!this.#s.isDeleted()}async editComment(e){this.#s||=new $n(this),this.#s.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#s.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,n]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,a=o+i+1,l=n-100,c=a+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,l,c,n]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#s.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#i?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#H();const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),Ec(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new Ei({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#j.bind(this),onPinching:this.#E.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#j(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#E(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const o=this.#P(this.rotation),a=(b,A)=>[o[0]*b+o[2]*A,o[1]*b+o[3]*A],[l,c]=this.parentDimensions,d=this.x,u=this.y,h=this.width,f=this.height,p=Q.MIN_SIZE/l,g=Q.MIN_SIZE/c;i=Math.max(Math.min(i,1/h,1/f),p/h,g/f);const m=Q._round(h*i),v=Q._round(f*i);if(m===h&&v===f)return;this.#d||=[d,u,h,f];const _=a(h/2,f/2),w=Q._round(d+_[0]),x=Q._round(u+_[1]),S=a(m/2,v/2);this.x=w-S[0],this.y=x-S[1],this.width=m,this.height=v,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#N()}pointerdown(e){const{isMac:t}=Fe.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#$(e);return}this.#R(e)}#R(e){const{isMac:t}=Fe.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,i=this._uiManager.combinedSignal(n),o={capture:!0,passive:!1,signal:i},a=c=>{n.abort(),this.#r=null,this.#p=!1,this._uiManager.endDragSession()||this.#R(c),s&&this._onStopDragging()};t&&(this.#C=e.clientX,this.#x=e.clientY,this.#r=e.pointerId,this.#a=e.pointerType,window.addEventListener("pointermove",c=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:u,pointerId:h}=c;if(h!==this.#r){Ce(c);return}const[f,p]=this.screenToPageTranslation(d-this.#C,u-this.#x);this.#C=d,this.#x=u,this._uiManager.dragSelectedEditors(f,p)},o),window.addEventListener("touchmove",Ce,o),window.addEventListener("pointerdown",c=>{c.pointerType===this.#a&&(this.#T||c.isPrimary)&&a(c),Ce(c)},o));const l=c=>{if(!this.#r||this.#r===c.pointerId){a(c);return}Ce(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const n=this.parentScale,[i,o]=this.pageDimensions,[a,l]=this.pageTranslation,c=e/n,d=t/n,u=this.x*i,h=this.y*o,f=this.width*i,p=this.height*o;switch(s){case 0:return[u+c+a,o-h-d-p+l,u+c+f+a,o-h-d+l];case 90:return[u+d+a,o-h+c+l,u+d+p+a,o-h+c+f+l];case 180:return[u-c-f+a,o-h+d+l,u-c+a,o-h+d+p+l];case 270:return[u-d-p+a,o-h-c-f+l,u-d+a,o-h-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,n,i,o]=e,a=i-s,l=o-n;switch(this.rotation){case 0:return[s,t-o,a,l];case 90:return[s,t-n,l,a];case 180:return[i,t-n,a,l];case 270:return[i,t-o,l,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Q._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#s?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:n,deleted:i,richText:o},uid:a,pageIndex:l,creationDate:c,modificationDate:d}=this;return{id:a,pageIndex:l,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:c,modificationDate:s||d,popupRef:!i,color:t,opacity:n}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&n>0&&e<i&&s>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#H()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,s){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});n.rotation=e.rotation,n.#e=e.accessibilityData,n._isCopy=e.isCopy||!1;const[i,o]=n.pageDimensions,[a,l,c,d]=n.getRectInCurrentCoords(e.rect,o);return n.x=a/i,n.y=l/o,n.width=c/i,n.height=d/o,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#F(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#T?.destroy(),this.#T=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,n,i,o]=this.getPDFRect();return[Q._round(s+(i-s)*e),Q._round(n+(o-n)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#s.commentPopupPositionInLayer}set commentPopupPosition(e){this.#s.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#s.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#s.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#s.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#G.bind(this),a=this.#W.bind(this),l=this._uiManager._signal;for(const c of this.#t){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",o,{signal:l}),c.addEventListener("blur",a,{signal:l}),c.addEventListener("focus",this.#X.bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",Q._l10nResizer[d])}}const s=this.#t[0];let n=0;for(const o of t){if(o===s)break;n++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==n){if(i<n)for(let a=0;a<n-i;a++)this.#c.append(this.#c.firstChild);else if(i>n)for(let a=0;a<i-n;a++)this.#c.firstChild.before(this.#c.lastChild);let o=0;for(const a of t){const c=this.#t[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Q._l10nResizer[c])}}this.#z(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#G(e){Q._resizerKeyboardManager.exec(this,e)}#W(e){this.#b&&e.relatedTarget?.parentNode!==this.#c&&this.#F()}#X(e){this.#m=this.#b?e:""}#z(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#b&&this.#L(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#F(){this.#b=!1,this.#z(-1),this.#N()}_stopResizingWithKeyboard(){this.#F(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(e){this.#g=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:s}=e;let n=this.#w.get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},Q._telemetryTimeout),this.#w.set(s,n);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}updateFakeAnnotationElement(e){if(!this.#u&&!this.deleted){this.#u=e.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class iv extends Q{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ta=3285377520,rt=4294901760,At=65535;class Tc{constructor(e){this.h1=e?e&4294967295:Ta,this.h2=e?e&4294967295:Ta}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let g=0,m=e.length;g<m;g++){const v=e.charCodeAt(g);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,i=s-n*4,o=new Uint32Array(t.buffer,0,n);let a=0,l=0,c=this.h1,d=this.h2;const u=3432918353,h=461845907,f=u&At,p=h&At;for(let g=0;g<n;g++)g&1?(a=o[g],a=a*u&rt|a*f&At,a=a<<15|a>>>17,a=a*h&rt|a*p&At,c^=a,c=c<<13|c>>>19,c=c*5+3864292196):(l=o[g],l=l*u&rt|l*f&At,l=l<<15|l>>>17,l=l*h&rt|l*p&At,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,i){case 3:a^=t[n*4+2]<<16;case 2:a^=t[n*4+1]<<8;case 1:a^=t[n*4],a=a*u&rt|a*f&At,a=a<<15|a>>>17,a=a*h&rt|a*p&At,n&1?c^=a:d^=a}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&rt|e*36045&At,t=t*4283543511&rt|((t<<16|e>>>16)*2950163797&rt)>>>16,e^=t>>>1,e=e*444984403&rt|e*60499&At,t=t*3301882366&rt|((t<<16|e>>>16)*3120437893&rt)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Dr=Object.freeze({map:null,hash:"",transfer:void 0});class yo{#e=!1;#t=null;#n=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){const t=this.#s.get(e);if(t!==void 0&&(t instanceof Q&&this.#n.delete(t.annotationElementId),this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#s.values())if(s instanceof Q)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let n=!1;if(s!==void 0)for(const[i,o]of Object.entries(t))s[i]!==o&&(n=!0,s[i]=o);else n=!0,this.#s.set(e,t);n&&this.#o(),t instanceof Q&&((this.#n||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#s.has(e)}get size(){return this.#s.size}#o(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new kc(this)}get serializable(){if(this.#s.size===0)return Dr;const e=new Map,t=new Tc,s=[],n=Object.create(null);let i=!1;for(const[o,a]of this.#s){const l=a instanceof Q?a.serialize(!1,n):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),i||=!!l.bitmap)}if(i)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Dr}get editorStats(){let e=null;const t=new Map;let s=0,n=0;for(const i of this.#s.values()){if(!(i instanceof Q)){i.popup&&(i.popup.deleted?n+=1:s+=1);continue}i.isCommentDeleted?n+=1:i.hasEditedComment&&(s+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:a}=o;t.has(a)||t.set(a,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const l=e[a]||=new Map;for(const[c,d]of Object.entries(o)){if(c==="type")continue;let u=l.get(c);u||(u=new Map,l.set(c,u));const h=u.get(d)??0;u.set(d,h+1)}}if((n>0||s>0)&&(e||=Object.create(null),e.comments={deleted:n,edited:s}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const s=this.#n?.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#n?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#n)for(const t of this.#n.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class kc extends yo{#e;constructor(e){super();const{map:t,hash:s,transfer:n}=e.serializable,i=structuredClone(t,n?{transfer:n}:null);this.#e={map:i,hash:s,transfer:n}}get print(){me("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return ae(this,"modifiedIds",{ids:new Set,hash:""})}}class rv{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||this.#e.has(e.loadedName))){if(he(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:o}=e,a=new FontFace(n,i,o);this.addNativeFontFace(a);try{await a.load(),this.#e.add(n),s?.(e)}catch{ie(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw ie(`Failed to load font '${s.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return ae(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ae(this,"isSyncFontLoadingSupported",qe||Fe.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(he(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:t,callback:e};return s.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ae(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(x,S){return x.charCodeAt(S)<<24|x.charCodeAt(S+1)<<16|x.charCodeAt(S+2)<<8|x.charCodeAt(S+3)&255}function n(x,S,b,A){const E=x.substring(0,S),C=x.substring(S+b);return E+A+C}let i,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;function d(x,S){if(++c>30){ie("Load test font never loaded."),S();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){S();return}setTimeout(d.bind(null,x,S))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=n(h,976,u.length,u);const p=16,g=1482184792;let m=s(h,p);for(i=0,o=u.length-3;i<o;i+=4)m=m-g+s(u,i)|0;i<u.length&&(m=m-g+s(u+"XXX",i)|0),h=n(h,p,4,$y(m));const v=`url(data:font/opentype;base64,${btoa(h)});`,_=`@font-face {font-family:"${u}";src:${v}}`;this.insertRule(_);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const x of[e.loadedName,u]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=x,w.append(S)}this._document.body.append(w),d(u,()=>{w.remove(),t.complete()})}}class ov{#e;constructor(e,t=null,s,n){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,s&&Object.assign(this,s),n&&(this.charProcOperatorList=n)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${xc(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let n;try{n=e.get(s)}catch(o){ie(`getPathGenerator - ignoring character: "${o}".`)}const i=new Path2D(n||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}function av(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(qe)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function lv(r){if(qe&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return An(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function qn(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const Ir=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,cv=r=>typeof r=="object"&&typeof r?.name=="string",dv=jy.bind(null,Ir,cv);class uv{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[n]of this.#e)n.call(this,s)})}addEventListener(e,t,s=null){let n=null;if(s?.signal instanceof AbortSignal){const{signal:i}=s;if(i.aborted){ie("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);n=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}this.#e.set(t,n)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Hn={DATA:1,ERROR:2},ke={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ka(){}function We(r){if(r instanceof es||r instanceof Tr||r instanceof wa||r instanceof ai||r instanceof Yi)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new es(r.message);case"InvalidPDFException":return new Tr(r.message);case"PasswordException":return new wa(r.message,r.code);case"ResponseException":return new ai(r.message,r.status,r.missing);case"UnknownErrorException":return new Yi(r.message,r.details)}return new Yi(r.message,r.toString())}class Qs{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#s(e);return}if(e.callback){const s=e.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Hn.DATA)n.resolve(e.data);else if(e.callback===Hn.ERROR)n.reject(We(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,n=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:s,targetName:n,callback:Hn.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:s,targetName:n,callback:Hn.ERROR,callbackId:e.callbackId,reason:We(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const n=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[n]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},s)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,s,n){const i=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:i,data:t,desiredSize:c.desiredSize},n),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[i].pullCall=d,l.postMessage({sourceName:o,targetName:a,stream:ke.PULL,streamId:i,desiredSize:c.desiredSize}),d.promise},cancel:c=>{he(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[i].cancelCall=d,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:ke.CANCEL,streamId:i,reason:We(c)}),d.promise}},s)}#n(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(c,d=1,u){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=d,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:n,stream:ke.ENQUEUE,streamId:t,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:ke.CLOSE,streamId:t}),delete o.streamSinks[t])},error(c){he(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:ke.ERROR,streamId:t,reason:We(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ke.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ke.START_COMPLETE,streamId:t,reason:We(c)})})}#s(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case ke.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(We(e.reason));break;case ke.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(We(e.reason));break;case ke.PULL:if(!a){i.postMessage({sourceName:s,targetName:n,stream:ke.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||ka).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ke.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ke.PULL_COMPLETE,streamId:t,reason:We(c)})});break;case ke.ENQUEUE:if(he(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case ke.CLOSE:if(he(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#o(o,t);break;case ke.ERROR:he(o,"error should have stream controller"),o.controller.error(We(e.reason)),this.#o(o,t);break;case ke.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(We(e.reason)),this.#o(o,t);break;case ke.CANCEL:if(!a)break;const l=We(e.reason);Promise.try(a.onCancel||ka,l).then(function(){i.postMessage({sourceName:s,targetName:n,stream:ke.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:n,stream:ke.CANCEL_COMPLETE,streamId:t,reason:We(c)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#o(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class Pc{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){me("Abstract method `_createCanvas` called.")}}class hv extends Pc{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class Mc{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){me("Abstract method `_fetch` called.")}}class Pa extends Mc{async _fetch(e){const t=await xn(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):An(t)}}class Dc{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,n,i){return"none"}destroy(e=!1){}}class fv extends Dc{#e;#t;#n;#s;#o;#i;#r=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#s=e,this.#o=t}get#a(){return this.#t||=new Map}get#c(){return this.#i||=new Map}get#l(){if(!this.#n){const e=this.#o.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#o.createElementNS(Ot,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#o.createElementNS(Ot,"defs"),e.append(s),s.append(this.#n),this.#o.body.append(e)}return this.#n}#h(e){if(e.length===1){const l=e[0],c=new Array(256);for(let u=0;u<256;u++)c[u]=l[u]/255;const d=c.join(",");return[d,d,d]}const[t,s,n]=e,i=new Array(256),o=new Array(256),a=new Array(256);for(let l=0;l<256;l++)i[l]=t[l]/255,o[l]=s[l]/255,a[l]=n[l]/255;return[i.join(","),o.join(","),a.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#o.URL;t!==this.#o.baseURI&&(Ci(t)?ie('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=wc(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#a.get(e);if(t)return t;const[s,n,i]=this.#h(e),o=e.length===1?s:`${s}${n}${i}`;if(t=this.#a.get(o),t)return this.#a.set(e,t),t;const a=`g_${this.#s}_transfer_map_${this.#r++}`,l=this.#u(a);this.#a.set(e,l),this.#a.set(o,l);const c=this.#p(a);return this.#g(s,n,i,c),l}addHCMFilter(e,t){const s=`${e}-${t}`,n="base";let i=this.#c.get(n);if(i?.key===s||(i?(i.filter?.remove(),i.key=s,i.url="none",i.filter=null):(i={key:s,url:"none",filter:null},this.#c.set(n,i)),!e||!t))return i.url;const o=this.#b(e);e=K.makeHexColor(...o);const a=this.#b(t);if(t=K.makeHexColor(...a),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const l=new Array(256);for(let f=0;f<=255;f++){const p=f/255;l[f]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}const c=l.join(","),d=`g_${this.#s}_hcm_filter`,u=i.filter=this.#p(d);this.#g(c,c,c,u),this.#m(u);const h=(f,p)=>{const g=o[f]/255,m=a[f]/255,v=new Array(p+1);for(let _=0;_<=p;_++)v[_]=g+_/p*(m-g);return v.join(",")};return this.#g(h(0,5),h(1,5),h(2,5),u),i.url=this.#u(d),i.url}addAlphaFilter(e){let t=this.#a.get(e);if(t)return t;const[s]=this.#h([e]),n=`alpha_${s}`;if(t=this.#a.get(n),t)return this.#a.set(e,t),t;const i=`g_${this.#s}_alpha_map_${this.#r++}`,o=this.#u(i);this.#a.set(e,o),this.#a.set(n,o);const a=this.#p(i);return this.#y(s,a),o}addLuminosityFilter(e){let t=this.#a.get(e||"luminosity");if(t)return t;let s,n;if(e?([s]=this.#h([e]),n=`luminosity_${s}`):n="luminosity",t=this.#a.get(n),t)return this.#a.set(e,t),t;const i=`g_${this.#s}_luminosity_map_${this.#r++}`,o=this.#u(i);this.#a.set(e,o),this.#a.set(n,o);const a=this.#p(i);return this.#f(a),e&&this.#y(s,a),o}addHighlightHCMFilter(e,t,s,n,i){const o=`${t}-${s}-${n}-${i}`;let a=this.#c.get(e);if(a?.key===o||(a?(a.filter?.remove(),a.key=o,a.url="none",a.filter=null):(a={key:o,url:"none",filter:null},this.#c.set(e,a)),!t||!s))return a.url;const[l,c]=[t,s].map(this.#b.bind(this));let d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[h,f]=[n,i].map(this.#b.bind(this));u<d&&([d,u,h,f]=[u,d,f,h]),this.#l.style.color="";const p=(v,_,w)=>{const x=new Array(256),S=(u-d)/w,b=v/255,A=(_-v)/(255*w);let E=0;for(let C=0;C<=w;C++){const k=Math.round(d+C*S),D=b+C*A;for(let q=E;q<=k;q++)x[q]=D;E=k+1}for(let C=E;C<256;C++)x[C]=x[E-1];return x.join(",")},g=`g_${this.#s}_hcm_${e}_filter`,m=a.filter=this.#p(g);return this.#m(m),this.#g(p(h[0],f[0],5),p(h[1],f[1],5),p(h[2],f[2],5),m),a.url=this.#u(g),a.url}destroy(e=!1){e&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#r=0)}#f(e){const t=this.#o.createElementNS(Ot,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#o.createElementNS(Ot,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#o.createElementNS(Ot,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#d(e,t,s){const n=this.#o.createElementNS(Ot,t);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)}#g(e,t,s,n){const i=this.#o.createElementNS(Ot,"feComponentTransfer");n.append(i),this.#d(i,"feFuncR",e),this.#d(i,"feFuncG",t),this.#d(i,"feFuncB",s)}#y(e,t){const s=this.#o.createElementNS(Ot,"feComponentTransfer");t.append(s),this.#d(s,"feFuncA",e)}#b(e){return this.#l.style.color=e,Cn(getComputedStyle(this.#l).getPropertyValue("color"))}}class Ic{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){me("Abstract method `_fetch` called.")}}class Ma extends Ic{async _fetch(e){const t=await xn(e,"arraybuffer");return new Uint8Array(t)}}class Rc{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){me("Abstract method `_fetch` called.")}}class Da extends Rc{async _fetch(e){const t=await xn(e,"arraybuffer");return new Uint8Array(t)}}qe&&ie("Please use the `legacy` build in Node.js environments.");async function vo(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class pv extends Dc{}class gv extends Pc{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class mv extends Mc{async _fetch(e){return vo(e)}}class yv extends Ic{async _fetch(e){return vo(e)}}class vv extends Rc{async _fetch(e){return vo(e)}}const As="__forcedDependency",{floor:Ia,ceil:Ra}=Math;function zn(r,e,t,s,n,i){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],s),r[e*4+2]=Math.max(r[e*4+2],n),r[e*4+3]=Math.max(r[e*4+3],i)}const Rr=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class bv{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===Rr}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Un=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};class wv{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[As]:[]};#n=new Map;#s=[];#o=[];#i=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#a=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#u=new Map;#f;#m;#p;#d;#g;constructor(e,t,s=!1){this.#f=e.width,this.#m=e.height,this.#y(t),s&&(this.#g=new Map)}growOperationsCount(e){e>=this.#d.length&&this.#y(e,this.#d)}#y(e,t){const s=new ArrayBuffer(e*4);this.#p=new Uint8ClampedArray(s),this.#d=new Uint32Array(s),t&&t.length>0?(this.#d.set(t),this.#d.fill(Rr,t.length)):this.#d.fill(Rr)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[As]:{__proto__:this.#t[As]}},this.#r={__proto__:this.#r},this.#s.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#r=Object.getPrototypeOf(this.#r);const s=this.#s.pop();return s!==void 0&&(Un(this.#g,e)?.dependencies.add(s),this.#d[e]=this.#d[s]),this}recordOpenMarker(e){return this.#s.push(e),this}getOpenMarker(){return this.#s.length===0?null:this.#s.at(-1)}recordCloseMarker(e){const t=this.#s.pop();return t!==void 0&&(Un(this.#g,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}beginMarkedContent(e){return this.#o.push(e),this}endMarkedContent(e){const t=this.#o.pop();return t!==void 0&&(Un(this.#g,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}pushBaseTransform(e){return this.#i.push(K.multiplyByDOMMatrix(this.#i.at(-1),e.getTransform())),this}popBaseTransform(){return this.#i.length>1&&this.#i.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#n.set(e,t),this}recordSimpleDataFromNamed(e,t,s){this.#e[e]=this.#n.get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(As,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(As,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#a[0]=1/0,this.#a[1]=1/0,this.#a[2]=-1/0,this.#a[3]=-1/0),this}recordClipBox(e,t,s,n,i,o){const a=K.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];K.axialAlignedBoundingBox([s,i,n,o],a,l);const c=K.intersect(this.#r,l);return c?(this.#r[0]=c[0],this.#r[1]=c[1],this.#r[2]=c[2],this.#r[3]=c[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(e,t,s,n,i,o){const a=this.#r;if(a[0]===1/0)return this;const l=K.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform());if(a[0]===-1/0)return K.axialAlignedBoundingBox([s,i,n,o],l,this.#a),this;const c=[1/0,1/0,-1/0,-1/0];return K.axialAlignedBoundingBox([s,i,n,o],l,c),this.#a[0]=Math.min(this.#a[0],Math.max(c[0],a[0])),this.#a[1]=Math.min(this.#a[1],Math.max(c[1],a[1])),this.#a[2]=Math.max(this.#a[2],Math.min(c[2],a[2])),this.#a[3]=Math.max(this.#a[3],Math.min(c[3],a[3])),this}recordCharacterBBox(e,t,s,n=1,i=0,o=0,a){const l=s.bbox;let c,d;if(l&&(c=l[2]!==l[0]&&l[3]!==l[1]&&this.#u.get(s),c!==!1&&(d=[0,0,0,0],K.axialAlignedBoundingBox(l,s.fontMatrix,d),(n!==1||i!==0||o!==0)&&K.scaleMinMax([n,0,0,-n,i,o],d),c)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!a)return this.recordFullPageBBox(e);const u=a();return l&&d&&c===void 0&&(c=d[0]<=i-u.actualBoundingBoxLeft&&d[2]>=i+u.actualBoundingBoxRight&&d[1]<=o-u.actualBoundingBoxAscent&&d[3]>=o+u.actualBoundingBoxDescent,this.#u.set(s,c),c)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,i-u.actualBoundingBoxLeft,i+u.actualBoundingBoxRight,o-u.actualBoundingBoxAscent,o+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#a[0]=Math.max(0,this.#r[0]),this.#a[1]=Math.max(0,this.#r[1]),this.#a[2]=Math.min(this.#f,this.#r[2]),this.#a[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const s=this.#l,n=this.#e,i=this.#t;for(const o of t)o in this.#e?s.add(n[o]):o in i&&i[o].forEach(s.add,s);return this}recordNamedDependency(e,t){return this.#n.has(t)&&this.#l.add(this.#n.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[As]),this.#g){const s=Un(this.#g,e),{dependencies:n}=s;this.#l.forEach(n.add,n),this.#s.forEach(n.add,n),this.#o.forEach(n.add,n),n.delete(e),s.isRenderingOperation=!0}if(this.#c===e){const s=Ia(this.#a[0]*256/this.#f),n=Ia(this.#a[1]*256/this.#m),i=Ra(this.#a[2]*256/this.#f),o=Ra(this.#a[3]*256/this.#m);zn(this.#p,e,s,n,i,o);for(const a of this.#l)a!==e&&zn(this.#p,a,s,n,i,o);for(const a of this.#s)a!==e&&zn(this.#p,a,s,n,i,o);for(const a of this.#o)a!==e&&zn(this.#p,a,s,n,i,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const s=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const n of s)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#a[0]),this.#r[1]=Math.max(this.#r[1],this.#a[1]),this.#r[2]=Math.min(this.#r[2],this.#a[2]),this.#r[3]=Math.min(this.#r[3],this.#a[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#u.clear(),new bv(this.#d,this.#p)}takeDebugMetadata(){return this.#g}}class li{#e;#t;#n;#s=0;#o=0;constructor(e,t,s){if(e instanceof li&&e.#n===!!s)return e;this.#e=e,this.#t=t,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#o++,this.#e.save(this.#t),this}restore(e){return this.#o>0&&(this.#e.restore(this.#t),this.#o--),this}recordOpenMarker(e){return this.#s++,this}getOpenMarker(){return this.#s>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#s--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#n||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,s,n,i,o){return this.#n||this.#e.recordClipBox(this.#t,t,s,n,i,o),this}recordBBox(e,t,s,n,i,o){return this.#n||this.#e.recordBBox(this.#t,t,s,n,i,o),this}recordCharacterBBox(e,t,s,n,i,o,a){return this.#n||this.#e.recordCharacterBBox(this.#t,t,s,n,i,o,a),this}recordFullPageBBox(e){return this.#n||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#n||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const ot={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Le={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Or(r,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,s),r.clip(n)}class bo{isModifyingCurrentTransform(){return!1}getPattern(){me("Abstract method `getPattern` called.")}}class _v extends bo{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,n){let i;if(n===Le.STROKE||n===Le.FILL){const o=t.current.getClippedPathBoundingBox(n,xe(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,c=t.cachedCanvases.getCanvas("pattern",a,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=K.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Or(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),i=e.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(s);i.setTransform(u)}else Or(e,this._bbox),i=this._createGradient(e);return i}}function Ji(r,e,t,s,n,i,o,a){const l=e.coords,c=e.colors,d=r.data,u=r.width*4;let h;l[t+1]>l[s+1]&&(h=t,t=s,s=h,h=i,i=o,o=h),l[s+1]>l[n+1]&&(h=s,s=n,n=h,h=o,o=a,a=h),l[t+1]>l[s+1]&&(h=t,t=s,s=h,h=i,i=o,o=h);const f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,g=(l[s]+e.offsetX)*e.scaleX,m=(l[s+1]+e.offsetY)*e.scaleY,v=(l[n]+e.offsetX)*e.scaleX,_=(l[n+1]+e.offsetY)*e.scaleY;if(p>=_)return;const w=c[i],x=c[i+1],S=c[i+2],b=c[o],A=c[o+1],E=c[o+2],C=c[a],k=c[a+1],D=c[a+2],q=Math.round(p),Y=Math.round(_);let F,G,B,j,T,M,H,V;for(let O=q;O<=Y;O++){if(O<m){const te=O<p?0:(p-O)/(p-m);F=f-(f-g)*te,G=w-(w-b)*te,B=x-(x-A)*te,j=S-(S-E)*te}else{let te;O>_?te=1:m===_?te=0:te=(m-O)/(m-_),F=g-(g-v)*te,G=b-(b-C)*te,B=A-(A-k)*te,j=E-(E-D)*te}let W;O<p?W=0:O>_?W=1:W=(p-O)/(p-_),T=f-(f-v)*W,M=w-(w-C)*W,H=x-(x-k)*W,V=S-(S-D)*W;const oe=Math.round(Math.min(F,T)),de=Math.round(Math.max(F,T));let ye=u*O+oe*4;for(let te=oe;te<=de;te++)W=(F-te)/(F-T),W<0?W=0:W>1&&(W=1),d[ye++]=G-(G-M)*W|0,d[ye++]=B-(B-H)*W|0,d[ye++]=j-(j-V)*W|0,d[ye++]=255}}function Av(r,e,t){const s=e.coords,n=e.colors;let i,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(s.length/a)-1,c=a-1;for(i=0;i<l;i++){let d=i*a;for(let u=0;u<c;u++,d++)Ji(r,t,s[d],s[d+1],s[d+a],n[d],n[d+1],n[d+a]),Ji(r,t,s[d+a+1],s[d+1],s[d+a],n[d+a+1],n[d+1],n[d+a])}break;case"triangles":for(i=0,o=s.length;i<o;i+=3)Ji(r,t,s[i],s[i+1],s[i+2],n[i],n[i+1],n[i+2]);break;default:throw new Error("illegal figure")}}class xv extends bo{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),f=c/u,p=d/h,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/f,scaleY:1/p},m=u+4,v=h+4,_=s.getCanvas("mesh",m,v),w=_.context,x=w.createImageData(u,h);if(t){const b=x.data;for(let A=0,E=b.length;A<E;A+=4)b[A]=t[0],b[A+1]=t[1],b[A+2]=t[2],b[A+3]=255}for(const b of this._figures)Av(x,b,g);return w.putImageData(x,2,2),{canvas:_.canvas,offsetX:a-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,n){Or(e,this._bbox);const i=new Float32Array(2);if(n===Le.SHADING)K.singularValueDecompose2dScale(xe(e),i);else if(this.matrix){K.singularValueDecompose2dScale(this.matrix,i);const[a,l]=i;K.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=a,i[1]*=l}else K.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,n===Le.SHADING?null:this._background,t.cachedCanvases);return n!==Le.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class Sv extends bo{getPattern(){return"hotpink"}}function Cv(r){switch(r[0]){case"RadialAxial":return new _v(r);case"Mesh":return new xv(r);case"Dummy":return new Sv}throw new Error(`Unknown IR type: ${r[0]}`)}const Oa={COLORED:1,UNCOLORED:2};class wo{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,n){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(e,t){const{bbox:s,operatorList:n,paintType:i,tilingType:o,color:a,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:d}=this;c=Math.abs(c),d=Math.abs(d),Si("TilingType: "+o);const u=s[0],h=s[1],f=s[2],p=s[3],g=f-u,m=p-h,v=new Float32Array(2);K.singularValueDecompose2dScale(this.matrix,v);const[_,w]=v;K.singularValueDecompose2dScale(this.baseTransform,v);const x=_*v[0],S=w*v[1];let b=g,A=m,E=!1,C=!1;const k=Math.ceil(c*x),D=Math.ceil(d*S),q=Math.ceil(g*x),Y=Math.ceil(m*S);k>=q?b=c:E=!0,D>=Y?A=d:C=!0;const F=this.getSizeAndScale(b,this.ctx.canvas.width,x),G=this.getSizeAndScale(A,this.ctx.canvas.height,S),B=e.cachedCanvases.getCanvas("pattern",F.size,G.size),j=B.context,T=l.createCanvasGraphics(j,t);if(T.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(T,i,a),j.translate(-F.scale*u,-G.scale*h),T.transform(0,F.scale,0,0,G.scale,0,0),j.save(),T.dependencyTracker?.save(),this.clipBbox(T,u,h,f,p),T.baseTransform=xe(T.ctx),T.executeOperatorList(n),T.endDrawing(),T.dependencyTracker?.restore(),j.restore(),E||C){const M=B.canvas;E&&(b=c),C&&(A=d);const H=this.getSizeAndScale(b,this.ctx.canvas.width,x),V=this.getSizeAndScale(A,this.ctx.canvas.height,S),O=H.size,W=V.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",O,W),de=oe.context,ye=E?Math.floor(g/c):0,te=C?Math.floor(m/d):0;for(let Ne=0;Ne<=ye;Ne++)for(let it=0;it<=te;it++)de.drawImage(M,O*Ne,W*it,O,W,0,0,O,W);return{canvas:oe.canvas,scaleX:H.scale,scaleY:V.scale,offsetX:u,offsetY:h}}return{canvas:B.canvas,scaleX:F.scale,scaleY:G.scale,offsetX:u,offsetY:h}}getSizeAndScale(e,t,s){const n=Math.max(wo.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=n?i=n:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,n,i){const o=n-t,a=i-s;e.ctx.rect(t,s,o,a),K.axialAlignedBoundingBox([t,s,n,i],xe(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const n=e.ctx,i=e.current;switch(t){case Oa.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;n.fillStyle=i.fillColor=o,n.strokeStyle=i.strokeColor=a;break;case Oa.UNCOLORED:n.fillStyle=n.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new Ny(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,n,i){let o=s;n!==Le.SHADING&&(o=K.transform(o,t.baseTransform),this.matrix&&(o=K.transform(o,this.matrix)));const a=this.createPatternCanvas(t,i);let l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(l),c}}function Ev({src:r,srcPos:e=0,dest:t,width:s,height:n,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const a=Fe.isLittleEndian?4278190080:255,[l,c]=o?[i,a]:[a,i],d=s>>3,u=s&7,h=r.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<n;p++){for(const m=e+d;e<m;e++){const v=e<h?r[e]:255;t[f++]=v&128?c:l,t[f++]=v&64?c:l,t[f++]=v&32?c:l,t[f++]=v&16?c:l,t[f++]=v&8?c:l,t[f++]=v&4?c:l,t[f++]=v&2?c:l,t[f++]=v&1?c:l}if(u===0)continue;const g=e<h?r[e++]:255;for(let m=0;m<u;m++)t[f++]=g&1<<7-m?c:l}return{srcPos:e,destPos:f}}const La=16,Fa=100,Tv=15,Ba=10,Ge=16,Qi=new DOMMatrix,Ze=new Float32Array(2),ks=new Float32Array([1/0,1/0,-1/0,-1/0]);function kv(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},r.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},r.transform=function(t,s,n,i,o,a){e.transform(t,s,n,i,o,a),this.__originalTransform(t,s,n,i,o,a)},r.setTransform=function(t,s,n,i,o,a){e.setTransform(t,s,n,i,o,a),this.__originalSetTransform(t,s,n,i,o,a)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},r.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},r.bezierCurveTo=function(t,s,n,i,o,a){e.bezierCurveTo(t,s,n,i,o,a),this.__originalBezierCurveTo(t,s,n,i,o,a)},r.rect=function(t,s,n,i){e.rect(t,s,n,i),this.__originalRect(t,s,n,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Pv{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,s)):(n=this.canvasFactory.create(t,s),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function jn(r,e,t,s,n,i,o,a,l,c){const[d,u,h,f,p,g]=xe(r);if(u===0&&h===0){const _=o*d+p,w=Math.round(_),x=a*f+g,S=Math.round(x),b=(o+l)*d+p,A=Math.abs(Math.round(b)-w)||1,E=(a+c)*f+g,C=Math.abs(Math.round(E)-S)||1;return r.setTransform(Math.sign(d),0,0,Math.sign(f),w,S),r.drawImage(e,t,s,n,i,0,0,A,C),r.setTransform(d,u,h,f,p,g),[A,C]}if(d===0&&f===0){const _=a*h+p,w=Math.round(_),x=o*u+g,S=Math.round(x),b=(a+c)*h+p,A=Math.abs(Math.round(b)-w)||1,E=(o+l)*u+g,C=Math.abs(Math.round(E)-S)||1;return r.setTransform(0,Math.sign(u),Math.sign(h),0,w,S),r.drawImage(e,t,s,n,i,0,0,C,A),r.setTransform(d,u,h,f,p,g),[C,A]}r.drawImage(e,t,s,n,i,o,a,l,c);const m=Math.hypot(d,u),v=Math.hypot(h,f);return[m*l,v*c]}class Na{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Er;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Re.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,s){s?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ks.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Le.FILL,t=null){const s=this.minMax.slice();if(e===Le.STROKE){t||me("Stroke bounding box must include transform."),K.singularValueDecompose2dScale(t,Ze);const n=Ze[0]*this.lineWidth/2,i=Ze[1]*this.lineWidth/2;s[0]-=n,s[1]-=i,s[2]+=n,s[3]+=i}return s}updateClipFromPath(){const e=K.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ks,0)}getClippedPathBoundingBox(e=Le.FILL,t=null){return K.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function $a(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,s=e.width,n=t%Ge,i=(t-n)/Ge,o=n===0?i:i+1,a=r.createImageData(s,Ge);let l=0,c;const d=e.data,u=a.data;let h,f,p,g;if(e.kind===Zn.GRAYSCALE_1BPP){const m=d.byteLength,v=new Uint32Array(u.buffer,0,u.byteLength>>2),_=v.length,w=s+7>>3,x=4294967295,S=Fe.isLittleEndian?4278190080:255;for(h=0;h<o;h++){for(p=h<i?Ge:n,c=0,f=0;f<p;f++){const b=m-l;let A=0;const E=b>w?s:b*8-7,C=E&-8;let k=0,D=0;for(;A<C;A+=8)D=d[l++],v[c++]=D&128?x:S,v[c++]=D&64?x:S,v[c++]=D&32?x:S,v[c++]=D&16?x:S,v[c++]=D&8?x:S,v[c++]=D&4?x:S,v[c++]=D&2?x:S,v[c++]=D&1?x:S;for(;A<E;A++)k===0&&(D=d[l++],k=128),v[c++]=D&k?x:S,k>>=1}for(;c<_;)v[c++]=0;r.putImageData(a,0,h*Ge)}}else if(e.kind===Zn.RGBA_32BPP){for(f=0,g=s*Ge*4,h=0;h<i;h++)u.set(d.subarray(l,l+g)),l+=g,r.putImageData(a,0,f),f+=Ge;h<o&&(g=s*n*4,u.set(d.subarray(l,l+g)),r.putImageData(a,0,f))}else if(e.kind===Zn.RGB_24BPP)for(p=Ge,g=s*p,h=0;h<o;h++){for(h>=i&&(p=n,g=s*p),c=0,f=g;f--;)u[c++]=d[l++],u[c++]=d[l++],u[c++]=d[l++],u[c++]=255;r.putImageData(a,0,h*Ge)}else throw new Error(`bad image kind: ${e.kind}`)}function qa(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,n=t%Ge,i=(t-n)/Ge,o=n===0?i:i+1,a=r.createImageData(s,Ge);let l=0;const c=e.data,d=a.data;for(let u=0;u<o;u++){const h=u<i?Ge:n;({srcPos:l}=Ev({src:c,srcPos:l,dest:d,width:s,height:h,nonBlackColor:0})),r.putImageData(a,0,u*Ge)}}function Xs(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)r[s]!==void 0&&(e[s]=r[s]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Vn(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function Ha(r,e){if(e)return!0;K.singularValueDecompose2dScale(r,Ze);const t=Math.fround(Pt.pixelRatio*Ns.PDF_TO_CSS_UNITS);return Ze[0]<=t&&Ze[1]<=t}const Mv=["butt","round","square"],Dv=["miter","round","bevel"],Iv={},za={};class Ds{constructor(e,t,s,n,i,{optionalContentConfig:o,markedContentStack:a=null},l,c,d){this.ctx=e,this.current=new Na(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new Pv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,s=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:n=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=a,s){const l=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...xe(this.compositeCtx))}this.ctx.save(),Vn(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=xe(this.ctx)}executeOperatorList(e,t,s,n,i){const o=e.argsArray,a=e.fnArray;let l=t||0;const c=o.length;if(c===l)return l;const d=c-l>Ba&&typeof s=="function",u=d?Date.now()+Tv:0;let h=0;const f=this.commonObjs,p=this.objs;let g,m;for(;;){if(n!==void 0&&l===n.nextBreakPoint)return n.breakIt(l,s),l;if(!i||i(l))if(g=a[l],m=o[l]??null,g!==un.dependency)m===null?this[g](l):this[g](l,...m);else for(const v of m){this.dependencyTracker?.recordNamedData(v,l);const _=v.startsWith("g_")?f:p;if(!_.has(v))return _.get(v,s),l}if(l++,l===c)return l;if(d&&++h>Ba){if(Date.now()>u)return s(),l;h=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,n=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,l=n,c="prescale1",d,u;for(;i>2&&a>1||o>2&&l>1;){let h=a,f=l;i>2&&a>1&&(h=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),i/=a/h),o>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/f),d=this.cachedCanvases.getCanvas(c,h,f),u=d.context,u.clearRect(0,0,h,f),u.drawImage(e,0,0,a,l,0,0,h,f),e=d.canvas,a=h,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e,t){const s=this.ctx,{width:n,height:i}=t,o=this.current.fillColor,a=this.current.patternFill,l=xe(s);let c,d,u,h;if((t.bitmap||t.data)&&t.count>1){const k=t.bitmap||t.data.buffer;d=JSON.stringify(a?l:[l.slice(0,4),o]),c=this._cachedBitmapsMap.get(k),c||(c=new Map,this._cachedBitmapsMap.set(k,c));const D=c.get(d);if(D&&!a){const q=Math.round(Math.min(l[0],l[2])+l[4]),Y=Math.round(Math.min(l[1],l[3])+l[5]);return this.dependencyTracker?.recordDependencies(e,ot.transformAndFill),{canvas:D,offsetX:q,offsetY:Y}}u=D}u||(h=this.cachedCanvases.getCanvas("maskCanvas",n,i),qa(h.context,t));let f=K.transform(l,[1/n,0,0,-1/i,0,0]);f=K.transform(f,[1,0,0,1,0,-i]);const p=ks.slice();K.axialAlignedBoundingBox([0,0,n,i],f,p);const[g,m,v,_]=p,w=Math.round(v-g)||1,x=Math.round(_-m)||1,S=this.cachedCanvases.getCanvas("fillCanvas",w,x),b=S.context,A=g,E=m;b.translate(-A,-E),b.transform(...f),u||(u=this._scaleImage(h.canvas,_t(b)),u=u.img,c&&a&&c.set(d,u)),b.imageSmoothingEnabled=Ha(xe(b),t.interpolate),jn(b,u,0,0,u.width,u.height,0,0,n,i),b.globalCompositeOperation="source-in";const C=K.transform(_t(b),[1,0,0,1,-A,-E]);return b.fillStyle=a?o.getPattern(s,this,C,Le.FILL,e):o,b.fillRect(0,0,n,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,S.canvas)),this.dependencyTracker?.recordDependencies(e,ot.transformAndFill),{canvas:S.canvas,offsetX:Math.round(A),offsetY:Math.round(E)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=Mv[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Dv[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){this.dependencyTracker?.recordSimpleData("dash",e);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[s,n]of t)switch(s){case"LW":this.setLineWidth(e,n);break;case"LC":this.setLineCap(e,n);break;case"LJ":this.setLineJoin(e,n);break;case"ML":this.setMiterLimit(e,n);break;case"D":this.setDash(e,n[0],n[1]);break;case"RI":this.setRenderingIntent(e,n);break;case"FL":this.setFlatness(e,n);break;case"Font":this.setFont(e,n[0],n[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=n;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=n;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,s);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),Xs(this.suspendedCtx,o),kv(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Xs(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,n){const i=n[0],o=n[1],a=n[2]-i,l=n[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,s,a,l,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,n,i,o,a,l,c,d,u){let h=e.canvas,f=l-d,p=c-u;if(o)if(f<0||p<0||f+s>h.width||p+n>h.height){const m=this.cachedCanvases.getCanvas("maskExtension",s,n),v=m.context;v.drawImage(h,-f,-p),v.globalCompositeOperation="destination-atop",v.fillStyle=o,v.fillRect(0,0,s,n),v.globalCompositeOperation="source-over",h=m.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const m=new Path2D;m.rect(f,p,s,n),e.clip(m),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(f,p,s,n),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(l,c,s,n),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(h,f,p,s,n,l,c,s,n),t.restore()}save(e){this.inSMaskMode&&Xs(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Xs(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,n,i,o,a){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,s,n,i,o,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,n){let[i]=s;if(!n){i||=s[0]=new Path2D,this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===un.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,n[0]-o,n[2]+o,n[1]-o,n[3]+o).recordDependencies(e,["transform"])}if(!(i instanceof Path2D)){const o=s[0]=new Path2D;for(let a=0,l=i.length;a<l;)switch(i[a++]){case Nn.moveTo:o.moveTo(i[a++],i[a++]);break;case Nn.lineTo:o.lineTo(i[a++],i[a++]);break;case Nn.curveTo:o.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);break;case Nn.closePath:o.closePath();break;default:ie(`Unrecognized drawing path operator: ${i[a-1]}`);break}i=o}K.axialAlignedBoundingBox(n,xe(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){const n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const o=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,_t(n),Le.STROKE,e),o){const a=new Path2D;a.addPath(t,n.getTransform().invertSelf().multiplySelf(o)),t=a}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,ot.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Le.STROKE,xe(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){const n=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let a=!1;if(o){const c=i.isModifyingCurrentTransform()?n.getTransform():null;if(this.dependencyTracker?.save(e),n.save(),n.fillStyle=i.getPattern(n,this,_t(n),Le.FILL,e),c){const d=new Path2D;d.addPath(t,n.getTransform().invertSelf().multiplySelf(c)),t=d}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),this.dependencyTracker?.recordDependencies(e,ot.fill),a&&(n.restore(),this.dependencyTracker?.restore(e)),s&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,ot.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Iv}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=za}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;t!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",e),n.recordCloseMarker(e)}if(t!==void 0){const n=new Path2D,i=s.getTransform().invertSelf();for(const{transform:o,x:a,y:l,fontSize:c,path:d}of t)d&&n.addPath(d,new DOMMatrix(o).preMultiplySelf(i).translate(a,l).scale(c,-c));s.clip(n)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||Er,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ie("Invalid font matrix for font "+t),s<0?(s=-s,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=s,n.isType3Font)return;const o=n.loadedName||"sans-serif",a=n.systemFontInfo?.css||`"${o}", ${n.fallbackName}`;let l="normal";n.black?l="900":n.bold&&(l="bold");const c=n.italic?"italic":"normal";let d=s;s<La?d=La:s>Fa&&(d=Fa),this.current.fontSizeScale=s/d,this.ctx.font=`${c} ${l} ${d}px ${a}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){this.dependencyTracker?.recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#n(e,t,s){const n=new Path2D;return n.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),n}paintChar(e,t,s,n,i,o){const a=this.ctx,l=this.current,c=l.font,d=l.textRenderingMode,u=l.fontSize/l.fontSizeScale,h=d&Re.FILL_STROKE_MASK,f=!!(d&Re.ADD_TO_PATH_FLAG),p=l.patternFill&&!c.missingFile,g=l.patternStroke&&!c.missingFile;let m;if((c.disableFontFace||f||p||g)&&!c.missingFile&&(m=c.getPathGenerator(this.commonObjs,t)),m&&(c.disableFontFace||p||g)){a.save(),a.translate(s,n),a.scale(u,-u),this.dependencyTracker?.recordCharacterBBox(e,a,c);let v;if(h===Re.FILL||h===Re.FILL_STROKE)if(i){v=a.getTransform(),a.setTransform(...i);const _=this.#n(m,v,i);a.fill(_)}else a.fill(m);if(h===Re.STROKE||h===Re.FILL_STROKE)if(o){v||=a.getTransform(),a.setTransform(...o);const{a:_,b:w,c:x,d:S}=v,b=K.inverseTransform(o),A=K.transform([_,w,x,S,0,0],b);K.singularValueDecompose2dScale(A,Ze),a.lineWidth*=Math.max(Ze[0],Ze[1])/u,a.stroke(this.#n(m,v,o))}else a.lineWidth/=u,a.stroke(m);a.restore()}else(h===Re.FILL||h===Re.FILL_STROKE)&&(a.fillText(t,s,n),this.dependencyTracker?.recordCharacterBBox(e,a,c,u,s,n,()=>a.measureText(t))),(h===Re.STROKE||h===Re.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,a,c,u,s,n,()=>a.measureText(t)).recordDependencies(e,ot.stroke),a.strokeText(t,s,n));f&&((this.pendingTextPaths||=[]).push({transform:xe(a),x:s,y:n,fontSize:u,path:m}),this.dependencyTracker?.recordCharacterBBox(e,a,c,u,s,n))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return ae(this,"isFontSubpixelAAEnabled",s)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,ot.showText).resetBBox(e),this.current.textRenderingMode&Re.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,n=s.font;if(n.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const i=s.fontSize;if(i===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,a=s.fontSizeScale,l=s.charSpacing,c=s.wordSpacing,d=s.fontDirection,u=s.textHScale*d,h=t.length,f=n.vertical,p=f?1:-1,g=n.defaultVMetrics,m=i*s.fontMatrix[0],v=s.textRenderingMode===Re.FILL&&!n.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),d>0?o.scale(u,-1):o.scale(u,1);let _,w;if(s.patternFill){o.save();const E=s.fillColor.getPattern(o,this,_t(o),Le.FILL,e);_=xe(o),o.restore(),o.fillStyle=E}if(s.patternStroke){o.save();const E=s.strokeColor.getPattern(o,this,_t(o),Le.STROKE,e);w=xe(o),o.restore(),o.strokeStyle=E}let x=s.lineWidth;const S=s.textMatrixScale;if(S===0||x===0){const E=s.textRenderingMode&Re.FILL_STROKE_MASK;(E===Re.STROKE||E===Re.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=S;if(a!==1&&(o.scale(a,a),x/=a),o.lineWidth=x,n.isInvalidPDFjsFont){const E=[];let C=0;for(const D of t)E.push(D.unicode),C+=D.width;const k=E.join("");if(o.fillText(k,0,0),this.dependencyTracker!==null){const D=o.measureText(k);this.dependencyTracker.recordBBox(e,this.ctx,-D.actualBoundingBoxLeft,D.actualBoundingBoxRight,-D.actualBoundingBoxAscent,D.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=C*m*u,o.restore(),this.compose();return}let b=0,A;for(A=0;A<h;++A){const E=t[A];if(typeof E=="number"){b+=p*E*i/1e3;continue}let C=!1;const k=(E.isSpace?c:0)+l,D=E.fontChar,q=E.accent;let Y,F,G=E.width;if(f){const T=E.vmetric||g,M=-(E.vmetric?T[1]:G*.5)*m,H=T[2]*m;G=T?-T[0]:G,Y=M/a,F=(b+H)/a}else Y=b/a,F=0;let B;if(n.remeasure&&G>0){B=o.measureText(D);const T=B.width*1e3/i*a;if(G<T&&this.isFontSubpixelAAEnabled){const M=G/T;C=!0,o.save(),o.scale(M,1),Y/=M}else G!==T&&(Y+=(G-T)/2e3*i/a)}if(this.contentVisible&&(E.isInFont||n.missingFile)){if(v&&!q)o.fillText(D,Y,F),this.dependencyTracker?.recordCharacterBBox(e,o,B?{bbox:null}:n,i/a,Y,F,()=>B??o.measureText(D));else if(this.paintChar(e,D,Y,F,_,w),q){const T=Y+i*q.offset.x/a,M=F-i*q.offset.y/a;this.paintChar(e,q.fontChar,T,M,_,w)}}const j=f?G*m-k*d:G*m+k*d;b+=j,C&&o.restore()}f?s.y-=b:s.x+=b*u,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,n=this.current,i=n.font,o=n.fontSize,a=n.fontDirection,l=i.vertical?1:-1,c=n.charSpacing,d=n.wordSpacing,u=n.textHScale*a,h=n.fontMatrix||Er,f=t.length,p=n.textRenderingMode===Re.INVISIBLE;let g,m,v,_;if(p||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),n.textMatrix&&s.transform(...n.textMatrix),s.translate(n.x,n.y+n.textRise),s.scale(u,a);const w=this.dependencyTracker;for(this.dependencyTracker=w?new li(w,e):null,g=0;g<f;++g){if(m=t[g],typeof m=="number"){_=l*m*o/1e3,this.ctx.translate(_,0),n.x+=_*u;continue}const x=(m.isSpace?d:0)+c,S=i.charProcOperatorList[m.operatorListId];S?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...h),this.executeOperatorList(S),this.restore()):ie(`Type3 character "${m.operatorListId}" is not available.`);const b=[m.width,0];K.applyTransform(b,h),v=b[0]*o+x,s.translate(v,0),n.x+=v*u}s.restore(),w&&(this.dependencyTracker=w)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,n,i,o,a){const l=new Path2D;l.rect(n,i,o-n,a-i),this.ctx.clip(l),this.dependencyTracker?.recordBBox(e,this.ctx,n,o,i,a).recordClipBox(e,this.ctx,n,o,i,a),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const n=this.baseTransform||xe(this.ctx),i={createCanvasGraphics:(o,a)=>new Ds(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new li(this.dependencyTracker,a,!0):null)};s=new wo(t,this.ctx,i,n)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=Cv(this.getObject(e,t)),this.cachedPatterns.set(t,n)),s&&(n.matrix=s),n}shadingFill(e,t){if(!this.contentVisible)return;const s=this.ctx;this.save(e);const n=this._getPattern(e,t);s.fillStyle=n.getPattern(s,this,_t(s),Le.SHADING,e);const i=_t(s);if(i){const{width:o,height:a}=s.canvas,l=ks.slice();K.axialAlignedBoundingBox([0,0,o,a],i,l);const[c,d,u,h]=l;this.ctx.fillRect(c,d,u-c,h-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,ot.transform).recordDependencies(e,ot.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){me("Should not call beginInlineImage")}beginImageData(){me("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=xe(this.ctx),s)){K.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[n,i,o,a]=s,l=new Path2D;l.rect(n,i,o-n,a-i),this.ctx.clip(l),this.dependencyTracker?.recordClipBox(e,this.ctx,n,o,i,a),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||Si("TODO: Support non-isolated groups."),t.knockout&&ie("Knockout groups not supported.");const n=xe(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=ks.slice();K.axialAlignedBoundingBox(t.bbox,xe(s),i);const o=[0,0,s.canvas.width,s.canvas.height];i=K.intersect(i,o)||[0,0,0,0];const a=Math.floor(i[0]),l=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),d=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let u="groupAt"+this.groupLevel;t.smask&&(u+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(u,c,d),f=h.context;f.translate(-a,-l),f.transform(...n);let p=new Path2D;const[g,m,v,_]=t.bbox;if(p.rect(g,m,v-g,_-m),t.matrix){const w=new Path2D;w.addPath(p,new DOMMatrix(t.matrix)),p=w}f.clip(p),t.smask&&this.smaskStack.push({canvas:h.canvas,context:f,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(a,l),s.save()),Xs(s,f),this.ctx=f,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const i=xe(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...i);const o=ks.slice();K.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],i,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,s,n,i,o){if(this.#e(),Vn(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const a=s[2]-s[0],l=s[3]-s[1];if(o&&this.annotationCanvasMap){n=n.slice(),n[4]-=s[0],n[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=a,s[3]=l,K.singularValueDecompose2dScale(xe(this.ctx),Ze);const{viewportScale:c}=this,d=Math.ceil(a*this.outputScaleX*c),u=Math.ceil(l*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,u);const{canvas:h,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(t,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(Ze[0],0,0,-Ze[1],0,l*Ze[1]),Vn(this.ctx)}else{Vn(this.ctx),this.endPath(e);const c=new Path2D;c.rect(s[0],s[1],a,l),this.ctx.clip(c)}}this.current=new Na(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...n),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const n=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,i.offsetX,i.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,n=0,i=0,o,a){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const c=xe(l);l.transform(s,n,i,o,0,0);const d=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]),this.dependencyTracker?.resetBBox(e);for(let u=0,h=a.length;u<h;u+=2){const f=K.transform(c,[s,n,i,o,a[u],a[u+1]]);l.drawImage(d.canvas,f[4],f[5]),this.dependencyTracker?.recordBBox(e,this.ctx,f[4],f[4]+d.canvas.width,f[5],f[5]+d.canvas.height)}l.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx,n=this.current.fillColor,i=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,ot.transformAndFill);for(const o of t){const{data:a,width:l,height:c,transform:d}=o,u=this.cachedCanvases.getCanvas("maskCanvas",l,c),h=u.context;h.save();const f=this.getObject(e,a,o);qa(h,f),h.globalCompositeOperation="source-in",h.fillStyle=i?n.getPattern(h,this,_t(s),Le.FILL,e):n,h.fillRect(0,0,l,c),h.restore(),s.save(),s.transform(...d),s.scale(1,-1),jn(s,u.canvas,0,0,l,c,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,l,0,c),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){ie("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,n,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){ie("Dependent image isn't ready yet");return}const a=o.width,l=o.height,c=[];for(let d=0,u=i.length;d<u;d+=2)c.push({transform:[s,0,0,n,i[d],i[d+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(e,o,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:n}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,n),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const s=t.width,n=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/s,-1/n);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,n).context;$a(d,t),a=this.applyTransferMapsToCanvas(d)}const l=this._scaleImage(a,_t(i));i.imageSmoothingEnabled=Ha(xe(i),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,i,0,s,-n,0).recordDependencies(e,ot.imageXObject).recordOperation(e),jn(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-n,s,n),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const o=t.width,a=t.height,c=this.cachedCanvases.getCanvas("inlineImage",o,a).context;$a(c,t),i=this.applyTransferMapsToCanvas(c)}this.dependencyTracker?.resetBBox(e);for(const o of s)n.save(),n.transform(...o.transform),n.scale(1,-1),jn(n,i,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,1,-1,0),n.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,ot.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip?(n||(this.pendingClip===za?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=xe(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:n,d:i}=this.ctx.getTransform();let o,a;if(s===0&&n===0){const l=Math.abs(t),c=Math.abs(i);if(l===c)if(e===0)o=a=1/l;else{const d=l*e;o=a=d<1?1/d:1}else if(e===0)o=1/l,a=1/c;else{const d=l*e,u=c*e;o=d<1?1/d:1,a=u<1?1/u:1}}else{const l=Math.abs(t*i-s*n),c=Math.hypot(t,s),d=Math.hypot(n,i);if(e===0)o=d/l,a=c/l;else{const u=e*l;o=d>u?d/u:1,a=c>u?c/u:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:n}}=this,[i,o]=this.getScaleForStroking();if(i===o){s.lineWidth=(n||1)*i,s.stroke(e);return}const a=s.getLineDash();t&&s.save(),s.scale(i,o),Qi.a=1/i,Qi.d=1/o;const l=new Path2D;if(l.addPath(e,Qi),a.length>0){const c=Math.max(i,o);s.setLineDash(a.map(d=>d/c)),s.lineDashOffset/=c}s.lineWidth=n||1,s.stroke(l),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in un)Ds.prototype[r]!==void 0&&(Ds.prototype[un[r]]=Ds.prototype[r]);class Is{#e;#t;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,s={};let n=0;for(const c of Is.strings){const d=t.encode(e[c]);s[c]=d,n+=4+d.length}const i=new ArrayBuffer(n),o=new Uint8Array(i),a=new DataView(i);let l=0;for(const c of Is.strings){const d=s[c],u=d.length;a.setUint32(l,u),o.set(d,l+4),l+=4+u}return he(l===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}#s(e){he(e<Is.strings.length,"Invalid string index");let t=0;for(let n=0;n<e;n++)t+=this.#t.getUint32(t)+4;const s=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,s))}get fontFamily(){return this.#s(0)}get fontWeight(){return this.#s(1)}get italicAngle(){return this.#s(2)}}class Rs{#e;#t;#n;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,s={};let n=0;for(const h of Rs.strings){const f=t.encode(e[h]);s[h]=f,n+=4+f.length}n+=4;let i,o,a=1+n;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),a+=4+i.length+4+o.length);const l=new ArrayBuffer(a),c=new Uint8Array(l),d=new DataView(l);let u=0;d.setUint8(u++,e.guessFallback?1:0),d.setUint32(u,0),u+=4,n=0;for(const h of Rs.strings){const f=s[h],p=f.length;n+=4+p,d.setUint32(u,p),c.set(f,u+4),u+=4+p}return d.setUint32(u-n-4,n),e.style&&(d.setUint32(u,i.length),c.set(i,u+4),u+=4+i.length,d.setUint32(u,o.length),c.set(o,u+4),u+=4+o.length),he(u<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(u)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#s(e){he(e<Rs.strings.length,"Invalid string index");let t=5;for(let n=0;n<e;n++)t+=this.#t.getUint32(t)+4;const s=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,s))}get css(){return this.#s(0)}get loadedName(){return this.#s(1)}get baseFontName(){return this.#s(2)}get src(){return this.#s(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),s=this.#n.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const n=this.#t.getUint32(e),i=this.#n.decode(new Uint8Array(this.#e,e+4,n));return{style:s,weight:i}}}class ge{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#n=this.#t+1+8;static#s=this.#n+1+48;static#o=this.#s+1+6;#i;#r;#a;constructor({data:e,extra:t}){this.#i=e,this.#r=new TextDecoder,this.#a=new DataView(this.#i),t&&Object.assign(this,t)}#c(e){he(e<ge.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,n=this.#a.getUint8(t)>>s&3;return n===0?void 0:n===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return he(e<ge.numbers.length,"Invalid number index"),this.#a.getFloat64(ge.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=ge.#t;if(this.#a.getUint8(e)===0)return;e+=1;const s=[];for(let n=0;n<4;n++)s.push(this.#a.getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=ge.#n;if(this.#a.getUint8(e)===0)return;e+=1;const s=[];for(let n=0;n<6;n++)s.push(this.#a.getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=ge.#s;if(this.#a.getUint8(e)===0)return;e+=1;const s=[];for(let n=0;n<3;n++)s.push(this.#a.getInt16(e,!0)),e+=2;return s}#h(e){he(e<ge.strings.length,"Invalid string index");let t=ge.#o+4;for(let i=0;i<e;i++)t+=this.#a.getUint32(t)+4;const s=this.#a.getUint32(t),n=new Uint8Array(s);return n.set(new Uint8Array(this.#i,t+4,s)),this.#r.decode(n)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=ge.#o;const t=this.#a.getUint32(e);e+=4+t;const s=this.#a.getUint32(e);e+=4+s;const n=this.#a.getUint32(e);e+=4+n;const i=this.#a.getUint32(e);if(i!==0)return new Uint8Array(this.#i,e+4,i)}clearData(){let e=ge.#o;const t=this.#a.getUint32(e);e+=4+t;const s=this.#a.getUint32(e);e+=4+s;const n=this.#a.getUint32(e);e+=4+n;const i=this.#a.getUint32(e);new Uint8Array(this.#i,e+4,i).fill(0),this.#a.setUint32(e,0)}get cssFontInfo(){let e=ge.#o;const t=this.#a.getUint32(e);e+=4+t;const s=this.#a.getUint32(e);e+=4+s;const n=this.#a.getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(this.#i,e+4,n)),new Is(i.buffer)}get systemFontInfo(){let e=ge.#o;const t=this.#a.getUint32(e);e+=4+t;const s=this.#a.getUint32(e);if(s===0)return null;const n=new Uint8Array(s);return n.set(new Uint8Array(this.#i,e+4,s)),new Rs(n.buffer)}static write(e){const t=e.systemFontInfo?Rs.write(e.systemFontInfo):null,s=e.cssFontInfo?Is.write(e.cssFontInfo):null,n=new TextEncoder,i={};let o=0;for(const g of ge.strings)i[g]=n.encode(e[g]),o+=4+i[g].length;const a=ge.#o+4+o+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(a),c=new Uint8Array(l),d=new DataView(l);let u=0;const h=ge.bools.length;let f=0,p=0;for(let g=0;g<h;g++){const m=e[ge.bools[g]];f|=(m===void 0?0:m?2:1)<<p,p+=2,(p===8||g===h-1)&&(d.setUint8(u++,f),f=0,p=0)}he(u===ge.#e,"FontInfo.write: Boolean properties offset mismatch");for(const g of ge.numbers)d.setFloat64(u,e[g]),u+=8;if(he(u===ge.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(u++,4);for(const g of e.bbox)d.setInt16(u,g,!0),u+=2}else d.setUint8(u++,0),u+=8;if(he(u===ge.#n,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(u++,6);for(const g of e.fontMatrix)d.setFloat64(u,g,!0),u+=8}else d.setUint8(u++,0),u+=48;if(he(u===ge.#s,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(u++,1);for(const g of e.defaultVMetrics)d.setInt16(u,g,!0),u+=2}else d.setUint8(u++,0),u+=6;he(u===ge.#o,"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(ge.#o,0),u+=4;for(const g of ge.strings){const m=i[g],v=m.length;d.setUint32(u,v),c.set(m,u+4),u+=4+v}if(d.setUint32(ge.#o,u-ge.#o-4),!t)d.setUint32(u,0),u+=4;else{const g=t.byteLength;d.setUint32(u,g),he(u+4+g<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),c.set(new Uint8Array(t),u+4),u+=4+g}if(!s)d.setUint32(u,0),u+=4;else{const g=s.byteLength;d.setUint32(u,g),he(u+4+g<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),c.set(new Uint8Array(s),u+4),u+=4+g}return e.data===void 0?(d.setUint32(u,0),u+=4):(d.setUint32(u,e.data.length),c.set(e.data,u+4),u+=4+e.data.length),he(u<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(u)}}class Os{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class Rv{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Cs=Symbol("INTERNAL");class Ov{#e=!1;#t=!1;#n=!1;#s=!0;constructor(e,{name:t,intent:s,usage:n,rbGroups:i}){this.#e=!!(e&Ye.DISPLAY),this.#t=!!(e&Ye.PRINT),this.name=t,this.intent=s,this.usage=n,this.rbGroups=i}get visible(){if(this.#n)return this.#s;if(!this.#s)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==Cs&&me("Internal method `_setVisible` called."),this.#n=s,this.#s=t}}class Lv{#e=null;#t=new Map;#n=null;#s=null;constructor(e,t=Ye.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#s=e.order;for(const s of e.groups)this.#t.set(s.id,new Ov(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(Cs,!1);for(const s of e.on)this.#t.get(s)._setVisible(Cs,!0);for(const s of e.off)this.#t.get(s)._setVisible(Cs,!1);this.#n=this.getHash()}}#o(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let n=1;n<t;n++){const i=e[n];let o;if(Array.isArray(i))o=this.#o(i);else if(this.#t.has(i))o=this.#t.get(i).visible;else return ie(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Si("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ie(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#o(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return ie(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return ie(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return ie(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return ie(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ie(`Unknown optional content policy ${e.policy}.`),!0}return ie(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const n=this.#t.get(e);if(!n){ie(`Optional content group not found: ${e}`);return}if(s&&t&&n.rbGroups.length)for(const i of n.rbGroups)for(const o of i)o!==e&&this.#t.get(o)?._setVisible(Cs,!1,!0);n._setVisible(Cs,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const i=this.#t.get(n);if(i)switch(s){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#s?this.#s.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new Tc;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class Fv{constructor(e,{disableRange:t=!1,disableStream:s=!1}){he(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:i,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,i?.length>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});he(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){he(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Bv(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Nv(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class Bv{constructor(e,t,s=!1,n=null){this._stream=e,this._done=s||!1,this._filename=po(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Nv{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function $v(r){let e=!0,t=s("filename\\*","i").exec(r);if(t){t=t[1];let d=a(t);return d=unescape(d),d=l(d),d=c(d),i(d)}if(t=o(r),t){const d=c(t);return i(d)}if(t=s("filename","i").exec(r),t){t=t[1];let d=a(t);return d=c(d),i(d)}function s(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function n(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const h=new TextDecoder(d,{fatal:!0}),f=An(u);u=h.decode(f),e=!1}catch{}}return u}function i(d){return e&&/[\x80-\xff]/.test(d)&&(d=n("utf-8",d),e&&(d=n("iso-8859-1",d))),d}function o(d){const u=[];let h;const f=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=f.exec(d))!==null;){let[,g,m,v]=h;if(g=parseInt(g,10),g in u){if(g===0)break;continue}u[g]=[m,v]}const p=[];for(let g=0;g<u.length&&g in u;++g){let[m,v]=u[g];v=a(v),m&&(v=unescape(v),g===0&&(v=l(v))),p.push(v)}return p.join("")}function a(d){if(d.startsWith('"')){const u=d.slice(1).split('\\"');for(let h=0;h<u.length;++h){const f=u[h].indexOf('"');f!==-1&&(u[h]=u[h].slice(0,f),u.length=h+1),u[h]=u[h].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function l(d){const u=d.indexOf("'");if(u===-1)return d;const h=d.slice(0,u),p=d.slice(u+1).replace(/^[^']*'/,"");return n(h,p)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,h,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,m){return String.fromCharCode(parseInt(m,16))}),n(h,p);try{p=atob(p)}catch{}return n(h,p)})}return""}function Oc(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const s in e){const n=e[s];n!==void 0&&t.append(s,n)}return t}function Ti(r){return URL.parse(r)?.origin??null}function Lc({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(n.suggestedLength=i,i<=2*t)||s||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function Fc(r){const e=r.get("Content-Disposition");if(e){let t=$v(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(po(t))return t}return null}function Tn(r,e){return new ai(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function Bc(r){return r===200||r===206}function Nc(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function $c(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ie(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class qv{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Oc(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return he(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Hv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new zv(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Hv{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),n=t.url;fetch(n,Nc(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Ti(i.url),!Bc(i.status))throw Tn(i.status,n);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:a,suggestedLength:l}=Lc({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=Fc(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new es("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$c(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class zv{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const o=n.url;fetch(o,Nc(i,this._withCredentials,this._abortController)).then(a=>{const l=Ti(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!Bc(a.status))throw Tn(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:$c(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const er=200,tr=206;function Uv(r){const e=r.response;return typeof e!="string"?e:An(e).buffer}class jv{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Oc(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=tr):n.expectedStatus=er,t.responseType="arraybuffer",he(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){s.onError(n.status);return}const i=n.status||er;if(!(i===er&&s.expectedStatus===tr)&&i!==s.expectedStatus){s.onError(n.status);return}const a=Uv(n);if(i===tr){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?s.onDone({begin:parseInt(c[1],10),chunk:a}):(ie('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Vv{constructor(e){this._source=e,this._manager=new jv(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return he(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Wv(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new Gv(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Wv{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ti(t.responseURL);const s=t.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...c]=a.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=Lc({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=Fc(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Tn(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Gv{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Ti(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Tn(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Xv=/^[a-z][a-z0-9\-+.]+:/i;function Yv(r){if(Xv.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class Kv{constructor(e){this.source=e,this.url=Yv(e.url),he(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return he(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Zv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Jv(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Zv{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=Tn(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new es("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Jv{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Ys=Symbol("INITIAL_DATA");class qc{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Ys}}get(e,t=null){if(t){const n=this.#t(e);return n.promise.then(()=>t(n.data)),null}const s=this.#e[e];if(!s||s.data===Ys)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==Ys}delete(e){const t=this.#e[e];return!t||t.data===Ys?!1:(delete this.#e[e],!0)}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Ys&&(yield[e,t])}}}const Qv=1e5,Ua=30;class $e{#e=Promise.withResolvers();#t=null;#n=!1;#s=!!globalThis.FontInspector?.enabled;#o=null;#i=null;#r=0;#a=0;#c=null;#l=null;#h=0;#u=0;#f=Object.create(null);#m=[];#p=null;#d=[];#g=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#C=new WeakMap;static#x=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#u=s.scale*Pt.pixelRatio,this.#h=s.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:i,pageX:o,pageY:a}=s.rawDims;this.#y=[1,0,0,-1,-o,a+i],this.#a=n,this.#r=i,$e.#P(),us(t,s),this.#e.promise.finally(()=>{$e.#w.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Fe.platform;return ae(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#o??=t.lang,Object.assign(this.#f,t.styles),this.#T(t.items),e()},this.#e.reject)};return this.#c=this.#p.getReader(),$e.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*Pt.pixelRatio,n=e.rotation;if(n!==this.#h&&(t?.(),this.#h=n,us(this.#l,{rotation:n})),s!==this.#u){t?.(),this.#u=s;const i={div:null,properties:null,ctx:$e.#M(this.#o)};for(const o of this.#d)i.properties=this.#g.get(o),i.div=o,this.#S(i)}}cancel(){const e=new es("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#d}get textContentItemsStr(){return this.#m}#T(e){if(this.#n)return;this.#i.ctx??=$e.#M(this.#o);const t=this.#d,s=this.#m;for(const n of e){if(t.length>Qv){ie("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),n.id&&this.#t.setAttribute("id",`${n.id}`),i.append(this.#t)}else n.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(n.str),this.#A(n)}}#A(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#d.push(t);const n=K.transform(this.#y,e.transform);let i=Math.atan2(n[1],n[0]);const o=this.#f[e.fontName];o.vertical&&(i+=Math.PI/2);let a=this.#s&&o.fontSubstitution||o.fontFamily;a=$e.fontFamilyMap.get(a)||a;const l=Math.hypot(n[2],n[3]),c=l*$e.#B(a,o,this.#o);let d,u;i===0?(d=n[4],u=n[5]-c):(d=n[4]+c*Math.sin(i),u=n[5]-c*Math.cos(i));const h="calc(var(--total-scale-factor) *",f=t.style;this.#t===this.#l?(f.left=`${(100*d/this.#a).toFixed(2)}%`,f.top=`${(100*u/this.#r).toFixed(2)}%`):(f.left=`${h}${d.toFixed(2)}px)`,f.top=`${h}${u.toFixed(2)}px)`),f.fontSize=`${h}${($e.#x*l).toFixed(2)}px)`,f.fontFamily=a,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#s&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const g=Math.abs(e.transform[0]),m=Math.abs(e.transform[3]);g!==m&&Math.max(g,m)/Math.min(g,m)>1.5&&(p=!0)}if(p&&(s.canvasWidth=o.vertical?e.height:e.width),this.#g.set(t,s),this.#i.div=t,this.#i.properties=s,this.#S(this.#i),s.hasText&&this.#t.append(t),s.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this.#t.append(g)}}#S(e){const{div:t,properties:s,ctx:n}=e,{style:i}=t;let o="";if($e.#x>1&&(o=`scale(${1/$e.#x})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:a}=i,{canvasWidth:l,fontSize:c}=s;$e.#k(n,c*this.#u,a);const{width:d}=n.measureText(t.textContent);d>0&&(o=`scaleX(${l*this.#u/d}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(i.transform=o)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#M(e=null){let t=this.#v.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#k(e,t,s){const n=this.#C.get(e);t===n.size&&s===n.family||(e.font=`${t}px ${s}`,n.size=t,n.family=s)}static#P(){if(this.#x!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#x=e.getBoundingClientRect().height,e.remove()}static#B(e,t,s){const n=this.#b.get(e);if(n)return n;const i=this.#M(s);i.canvas.width=i.canvas.height=Ua,this.#k(i,Ua,e);const o=i.measureText(""),a=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let c=.8;return a?c=a/(a+l):(Fe.platform.isFirefox&&ie("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),this.#b.set(e,c),c}}const eb=100;function Hc(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new _o,{docId:t}=e,s=r.url?av(r.url):null,n=r.data?lv(r.data):null,i=r.httpHeaders||null,o=r.withCredentials===!0,a=r.password??null,l=r.range instanceof zc?r.range:null,c=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let d=r.worker instanceof fn?r.worker:null;const u=r.verbosity,h=typeof r.docBaseUrl=="string"&&!Ci(r.docBaseUrl)?r.docBaseUrl:null,f=qn(r.cMapUrl),p=r.cMapPacked!==!1,g=r.CMapReaderFactory||(qe?mv:Pa),m=qn(r.iccUrl),v=qn(r.standardFontDataUrl),_=r.StandardFontDataFactory||(qe?yv:Ma),w=qn(r.wasmUrl),x=r.WasmFactory||(qe?vv:Da),S=r.stopAtErrors!==!0,b=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,A=r.isEvalSupported!==!1,E=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!qe,C=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!qe&&(Fe.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,D=typeof r.disableFontFace=="boolean"?r.disableFontFace:qe,q=r.fontExtraProperties===!0,Y=r.enableXfa===!0,F=r.ownerDocument||globalThis.document,G=r.disableRange===!0,B=r.disableStream===!0,j=r.disableAutoFetch===!0,T=r.pdfBug===!0,M=r.CanvasFactory||(qe?gv:hv),H=r.FilterFactory||(qe?pv:fv),V=r.enableHWA===!0,O=r.useWasm!==!1,W=l?l.length:r.length??NaN,oe=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!qe&&!D,de=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(g===Pa&&_===Ma&&x===Da&&f&&v&&w&&Js(f,document.baseURI)&&Js(v,document.baseURI)&&Js(w,document.baseURI)),ye=null;Ly(u);const te={canvasFactory:new M({ownerDocument:F,enableHWA:V}),filterFactory:new H({docId:t,ownerDocument:F}),cMapReaderFactory:de?null:new g({baseUrl:f,isCompressed:p}),standardFontDataFactory:de?null:new _({baseUrl:v}),wasmFactory:de?null:new x({baseUrl:w})};d||(d=fn.create({verbosity:u,port:Os.workerPort}),e._worker=d);const Ne={docId:t,apiVersion:"5.4.296",data:n,password:a,disableAutoFetch:j,rangeChunkSize:c,length:W,docBaseUrl:h,enableXfa:Y,evaluatorOptions:{maxImageSize:b,disableFontFace:D,ignoreErrors:S,isEvalSupported:A,isOffscreenCanvasSupported:E,isImageDecoderSupported:C,canvasMaxAreaInBytes:k,fontExtraProperties:q,useSystemFonts:oe,useWasm:O,useWorkerFetch:de,cMapUrl:f,iccUrl:m,standardFontDataUrl:v,wasmUrl:w}},it={ownerDocument:F,pdfBug:T,styleElement:ye,loadingParams:{disableAutoFetch:j,enableXfa:Y}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Ut=d.messageHandler.sendWithPromise("GetDocRequest",Ne,n?[n.buffer]:null);let yt;if(l)yt=new Fv(l,{disableRange:G,disableStream:B});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");const vt=Js(s)?qv:qe?Kv:Vv;yt=new vt({url:s,length:W,httpHeaders:i,withCredentials:o,rangeChunkSize:c,disableRange:G,disableStream:B})}return Ut.then(vt=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Us=new Qs(t,vt,d.port),ko=new nb(Us,e,yt,it,te,V);e._transport=ko,Us.send("Ready",null)})}).catch(e._capability.reject),e}class _o{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${_o.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class zc{#e=Promise.withResolvers();#t=[];#n=[];#s=[];#o=[];constructor(e,t,s=!1,n=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=n}addRangeListener(e){this.#o.push(e)}addProgressListener(e){this.#s.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const s of this.#o)s(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const s of this.#s)s(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class tb{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class sb{#e=!1;constructor(e,t,s,n=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=n?new Aa:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new qc,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:i=!1}={}){return new Sn({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:n="display",annotationMode:i=Gt.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:u=null,isEditing:h=!1,recordOperations:f=!1,operationsFilter:p=null}){this._stats?.time("Overall");const g=this._transport.getRenderingIntent(n,i,u,h),{renderingIntent:m,cacheKey:v}=g;this.#e=!1,l||=this._transport.getOptionalContentConfig(m);let _=this._intentStates.get(v);_||(_=Object.create(null),this._intentStates.set(v,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const w=!!(m&Ye.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(g));const x=!!(this._pdfBug&&globalThis.StepperManager?.enabled),S=!this.recordedBBoxes&&(f||x),b=C=>{if(_.renderTasks.delete(A),S){const k=A.gfx?.dependencyTracker.take();k&&(A.stepper&&A.stepper.setOperatorBBoxes(k,A.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=k))}w&&(this.#e=!0),this.#t(),C?(A.capability.reject(C),this._abortOperatorList({intentState:_,reason:C instanceof Error?C:new Error(C)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new Ps({callback:b,params:{canvas:t,canvasContext:e,dependencyTracker:S?new wv(t,_.operatorList.length,x):null,viewport:s,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:p});(_.renderTasks||=new Set).add(A);const E=A.task;return Promise.all([_.displayReadyCapability.promise,l]).then(([C,k])=>{if(this.destroyed){b();return}if(this._stats?.time("Rendering"),!(k.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:C,optionalContentConfig:k}),A.operatorListChanged()}).catch(b),E}getOperatorList({intent:e="display",annotationMode:t=Gt.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){function i(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,s,n,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>hn.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,n){function i(){o.read().then(function({value:l,done:c}){if(c){s(a);return}a.lang??=l.lang,Object.assign(a.styles,l.styles),a.items.push(...l.items),i()},n)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Aa),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,n=e.length;s<n;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:n}){const{map:i,transfer:o}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:n},o).getReader(),c=this._intentStates.get(t);c.streamReader=l;const d=()=>{l.read().then(({value:u,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),d())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const h of c.renderTasks)h.operatorListChanged();this.#t()}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof fo){let n=eb;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new es(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,i]of this._intentStates)if(i===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}var Xt,ct,Ft,os,di,as,ls,Ue,Jn,Uc,jc,en,Ls,Qn;const we=class we{constructor({name:e=null,port:t=null,verbosity:s=Fy()}={}){bt(this,Ue);bt(this,Xt,Promise.withResolvers());bt(this,ct,null);bt(this,Ft,null);bt(this,os,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(be(we,ls).has(t))throw new Error("Cannot use more than one PDFWorker per port.");be(we,ls).set(t,this),wt(this,Ue,Uc).call(this,t)}else wt(this,Ue,jc).call(this)}get promise(){return be(this,Xt).promise}get port(){return be(this,Ft)}get messageHandler(){return be(this,ct)}destroy(){this.destroyed=!0,be(this,os)?.terminate(),Ve(this,os,null),be(we,ls).delete(be(this,Ft)),Ve(this,Ft,null),be(this,ct)?.destroy(),Ve(this,ct,null)}static create(e){const t=be(this,ls).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new we(e)}static get workerSrc(){if(Os.workerSrc)return Os.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ae(this,"_setupFakeWorkerGlobal",(async()=>be(this,Ls,Qn)?be(this,Ls,Qn):(await import(this.workerSrc)).WorkerMessageHandler)())}};Xt=new WeakMap,ct=new WeakMap,Ft=new WeakMap,os=new WeakMap,di=new WeakMap,as=new WeakMap,ls=new WeakMap,Ue=new WeakSet,Jn=function(){be(this,Xt).resolve(),be(this,ct).send("configure",{verbosity:this.verbosity})},Uc=function(e){Ve(this,Ft,e),Ve(this,ct,new Qs("main","worker",e)),be(this,ct).on("ready",()=>{}),wt(this,Ue,Jn).call(this)},jc=function(){if(be(we,as)||be(we,Ls,Qn)){wt(this,Ue,en).call(this);return}let{workerSrc:e}=we;try{we._isSameOrigin(window.location,e)||(e=we._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Qs("main","worker",t),n=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?be(this,Xt).reject(new Error("Worker was destroyed")):wt(this,Ue,en).call(this)},i=new AbortController;t.addEventListener("error",()=>{be(this,os)||n()},{signal:i.signal}),s.on("test",a=>{if(i.abort(),this.destroyed||!a){n();return}Ve(this,ct,s),Ve(this,Ft,t),Ve(this,os,t),wt(this,Ue,Jn).call(this)}),s.on("ready",a=>{if(i.abort(),this.destroyed){n();return}try{o()}catch{wt(this,Ue,en).call(this)}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{Si("The worker has been disabled.")}wt(this,Ue,en).call(this)},en=function(){be(we,as)||(ie("Setting up fake worker."),Ve(we,as,!0)),we._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){be(this,Xt).reject(new Error("Worker was destroyed"));return}const t=new uv;Ve(this,Ft,t);const s=`fake${Mo(we,di)._++}`,n=new Qs(s+"_worker",s,t);e.setup(n,t),Ve(this,ct,new Qs(s,s+"_worker",t)),wt(this,Ue,Jn).call(this)}).catch(e=>{be(this,Xt).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Ls=new WeakSet,Qn=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},bt(we,Ls),bt(we,di,0),bt(we,as,!1),bt(we,ls,new WeakMap),qe&&(Ve(we,as,!0),Os.workerSrc||="./pdf.worker.mjs"),we._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!s?.origin||s.origin==="null")return!1;const n=new URL(t,s);return s.origin===n.origin},we._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},we.fromPort=e=>{if(Xy("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return we.create(e)};let fn=we;class nb{#e=new Map;#t=new Map;#n=new Map;#s=new Map;#o=null;constructor(e,t,s,n,i,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new qc,this.fontLoader=new rv({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#i(e,t=null){const s=this.#e.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,n),n}get annotationStorage(){return ae(this,"annotationStorage",new yo)}getRenderingIntent(e,t=Gt.ENABLE,s=null,n=!1,i=!1){let o=Ye.DISPLAY,a=Dr;switch(e){case"any":o=Ye.ANY;break;case"display":break;case"print":o=Ye.PRINT;break;default:ie(`getRenderingIntent - invalid intent: ${e}`)}const l=o&Ye.PRINT&&s instanceof kc?s:this.annotationStorage;switch(t){case Gt.DISABLE:o+=Ye.ANNOTATIONS_DISABLE;break;case Gt.ENABLE:break;case Gt.ENABLE_FORMS:o+=Ye.ANNOTATIONS_FORMS;break;case Gt.ENABLE_STORAGE:o+=Ye.ANNOTATIONS_STORAGE,a=l.serializable;break;default:ie(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(o+=Ye.IS_EDITING),i&&(o+=Ye.OPLIST);const{ids:c,hash:d}=l.modifiedIds,u=[o,a.hash,d];return{renderingIntent:o,cacheKey:u.join("_"),annotationStorageSerializable:a,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#o?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#n.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),$e.cleanup(),this._networkStream?.cancelAllRequests(new es("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,n)=>{he(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},n.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){n.close();return}he(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{n.error(i)})},n.onCancel=i=>{this._fullReader.cancel(i),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:o}=this._fullReader;return(!n||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(s,n)=>{he(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){n.close();return}n.onPull=()=>{i.read().then(function({value:o,done:a}){if(a){n.close();return}he(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{n.error(o)})},n.onCancel=o=>{i.cancel(o),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new tb(s,this))}),e.on("DocException",s=>{t._capability.reject(We(s))}),e.on("PasswordRequest",s=>{this.#o=Promise.withResolvers();try{if(!t.onPassword)throw We(s);const n=i=>{i instanceof Error?this.#o.reject(i):this.#o.resolve({password:i})};t.onPassword(n,s.code)}catch(n){this.#o.reject(n)}return this.#o.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,n,i])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":if("error"in i){const d=i.error;ie(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const o=new ge(i),a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(d,u)=>globalThis.FontInspector.fontAdded(d,u):null,l=new ov(o,a,i.extra,i.charProcOperatorList);this.fontLoader.bind(l).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l.fontExtraProperties&&l.data&&l.clearData(),this.commonObjs.resolve(s,l)});break;case"CopyLocalImage":const{imageRef:c}=i;he(c,"The imageRef must be defined.");for(const d of this.#t.values())for(const[,u]of d.objs)if(u?.ref===c)return u.dataLen?(this.commonObjs.resolve(s,structuredClone(u)),u.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([s,n,i,o])=>{if(this.destroyed)return;const a=this.#t.get(n);if(!a.objs.has(s)){if(a._intentStates.size===0){o?.bitmap?.close();return}switch(i){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[s.type];if(!n)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ie("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#n.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#s.set(i.refStr,e);const o=new sb(t,i,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,n),n}getPageIndex(e){return Ir(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new Lv(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(n=>({info:n[0],metadata:n[1]?new Rv(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),$e.cleanup()}}cachedPageNumber(e){if(!Ir(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#s.get(t)??null}}class ib{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Ps{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:n,annotationCanvasMap:i,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:h=null,enableHWA:f=!1,operationsFilter:p=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ib(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=f,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Ps.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ps.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:n,background:i,dependencyTracker:o}=this.params,a=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ds(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:n,viewport:s,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Ps.#t.delete(this._canvas),e||=new fo(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ps.#t.delete(this._canvas),this.callback())))}}const rb="5.4.296",ob="f56dc8601";class at{#e=null;#t=null;#n;#s=null;#o=!1;#i=!1;#r=null;#a;#c=null;#l=null;static#h=null;static get _keyboardManager(){return ae(this,"_keyboardManager",new En([[["Escape","mac+Escape"],at.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],at.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],at.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],at.prototype._moveToPrevious],[["Home","mac+Home"],at.prototype._moveToBeginning],[["End","mac+End"],at.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#r=e):this.#i=!0,this.#l=e?._uiManager||t,this.#a=this.#l._eventBus,this.#n=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",at.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#r&&(e.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#p.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,e.append(s),e}renderMainDropdown(){const e=this.#s=this.#u();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#u(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",lt,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(e.id=`${this.#r.id}_colorpicker_dropdown`);for(const[s,n]of this.#l.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",n),i.title=s,i.setAttribute("data-l10n-id",at.#h[s]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=n,i.ariaSelected=n===this.#n,i.addEventListener("click",this.#f.bind(this,n),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:ue.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#p(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#g){this.#p(e);return}if(e.target===this.#e){this.#s.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#s?.firstChild||e.target===this.#e){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#p(e);return}this.#s.firstChild?.focus()}_moveToEnd(e){if(!this.#g){this.#p(e);return}this.#s.lastChild?.focus()}#m(e){at._keyboardManager.exec(this,e)}#p(e){if(this.#g){this.hideDropdown();return}if(this.#o=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#d.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#s){this.#s.classList.remove("hidden");return}const t=this.#s=this.#u();this.#e.append(t)}#d(e){this.#s?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#g){this.#r?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#o})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#s)return;const t=this.#l.highlightColors.values();for(const s of this.#s.children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#s?.remove(),this.#s=null}}class pn{#e=null;#t=null;#n=null;static#s=null;constructor(e){this.#t=e,this.#n=e._uiManager,pn.#s||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,colorValue:s}=this.#t,n=this.#e=document.createElement("input");return n.type="color",n.value=s||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",pn.#s[e]),n.addEventListener("input",()=>{this.#n.updateParams(t,n.value)},{signal:this.#n._signal}),n}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function ja(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Ks(r){return Math.max(0,Math.min(255,255*r))}class Va{static CMYK_G([e,t,s,n]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ks(e),[e,e,e]}static G_HTML([e]){const t=ja(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Ks)}static RGB_HTML(e){return`#${e.map(ja).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,s+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,s,n]){return[Ks(1-Math.min(1,e+n)),Ks(1-Math.min(1,s+n)),Ks(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const n=1-e,i=1-t,o=1-s,a=Math.min(n,i,o);return["CMYK",n,i,o,a]}}class ab{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){me("Abstract method `_createSVG` called.")}}class ci extends ab{_createSVG(e){return document.createElementNS(Ot,e)}}const lb=9,hs=new WeakSet,cb=new Date().getTimezoneOffset()*60*1e3;class Wa{static create(e){switch(e.data.annotationType){case Pe.LINK:return new Ao(e);case Pe.TEXT:return new ub(e);case Pe.WIDGET:switch(e.data.fieldType){case"Tx":return new hb(e);case"Btn":return e.data.radioButton?new Vc(e):e.data.checkBox?new pb(e):new gb(e);case"Ch":return new mb(e);case"Sig":return new fb(e)}return new ys(e);case Pe.POPUP:return new Lr(e);case Pe.FREETEXT:return new Wc(e);case Pe.LINE:return new vb(e);case Pe.SQUARE:return new bb(e);case Pe.CIRCLE:return new wb(e);case Pe.POLYLINE:return new Gc(e);case Pe.CARET:return new Ab(e);case Pe.INK:return new xo(e);case Pe.POLYGON:return new _b(e);case Pe.HIGHLIGHT:return new Xc(e);case Pe.UNDERLINE:return new xb(e);case Pe.SQUIGGLY:return new Sb(e);case Pe.STRIKEOUT:return new Cb(e);case Pe.STAMP:return new Yc(e);case Pe.FILEATTACHMENT:return new Eb(e);default:return new Se(e)}}}class Se{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Se._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:n}=this.data;let i=-1/0,o=-1/0;if(t?.length>=8){for(let a=0;a<t.length;a+=8)t[a+1]>o?(o=t[a+1],i=t[a+2]):t[a+1]===o&&(i=Math.max(i,t[a+2]));return[i,o]}if(s?.length>=1){for(const a of s)for(let l=0,c=a.length;l<c;l+=2)a[l+1]>o?(o=a[l+1],i=a[l]):a[l+1]===o&&(i=Math.max(i,a[l]));if(i!==1/0)return[i,o]}return n?[n[2],n[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/s,e[1]=100*(e[1]-o)/n,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${dn}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${dn}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:s}=e;t&&this.#s(t);let n=this.#n?.popup||this.popup;!n&&s?.text&&(this._createPopup(s),n=this.#n.popup),n&&(n.updateEdited(e),s?.deleted&&(n.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#e&&(this.#s(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#s(e){const{container:{style:t},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:l}}}}=this;s?.splice(0,4,...e),t.left=`${100*(e[0]-a)/i}%`,t.top=`${100*(o-e[3]+l)/o}%`,n===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(n)}_createContainer(e){const{data:t,parent:{page:s,viewport:n}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof ys)&&!(this instanceof Ao)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof Lr){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,i),i}const{width:a,height:l}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,m=t.borderStyle.verticalCornerRadius;if(g>0||m>0){const _=`calc(${g}px * var(--total-scale-factor)) / calc(${m}px * var(--total-scale-factor))`;o.borderRadius=_}else if(this instanceof Vc){const _=`calc(${a}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;o.borderRadius=_}switch(t.borderStyle.style){case Ss.SOLID:o.borderStyle="solid";break;case Ss.DASHED:o.borderStyle="dashed";break;case Ss.BEVELED:ie("Unimplemented border style: beveled");break;case Ss.INSET:ie("Unimplemented border style: inset");break;case Ss.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(this.#t=!0,o.borderColor=K.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const c=K.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:u,pageX:h,pageY:f}=n.rawDims;o.left=`${100*(c[0]-h)/d}%`,o.top=`${100*(c[1]-f)/u}%`;const{rotation:p}=t;return t.hasOwnCanvas||p===0?(o.width=`${100*a/d}%`,o.height=`${100*l/u}%`):this.setRotation(p,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*o/n}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,n)=>{const i=n.detail[t],o=i[0],a=i.slice(1);n.target.style[s]=Va[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:Va[`${o}_rgb`](a)})};return ae(this,"_commonActions",{display:t=>{const{display:s}=t.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const n of Object.keys(t.detail))(e[n]||s[n])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[n,i]of Object.entries(t)){const o=s[n];if(o){const a={detail:{[n]:i},target:e};o(a),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,n,i]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,m,v,_]=e.subarray(2,6);if(n===g&&i===m&&t===v&&s===_)return}const{style:o}=this.container;let a;if(this.#t){const{borderColor:g,borderWidth:m}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${m}">`],this.container.classList.add("hasBorder")}const l=n-t,c=i-s,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0),u.role="none";const h=d.createElement("defs");u.append(h);const f=d.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),h.append(f);for(let g=2,m=e.length;g<m;g+=8){const v=e[g],_=e[g+1],w=e[g+2],x=e[g+3],S=d.createElement("rect"),b=(w-t)/l,A=(i-_)/c,E=(v-w)/l,C=(_-x)/c;S.setAttribute("x",b),S.setAttribute("y",A),S.setAttribute("width",E),S.setAttribute("height",C),f.append(S),a?.push(`<rect vector-effect="non-scaling-stroke" x="${b}" y="${A}" width="${E}" height="${C}"/>`)}this.#t&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath=`url(#${p})`}_createPopup(e=null){const{data:t}=this;let s,n;e?(s={str:e.text},n=e.date):(s=t.contentsObj,n=t.modificationDate);const i=this.#n=new Lr({data:{color:t.color,titleObj:t.titleObj,modificationDate:n,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(i.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){me("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:i,id:o,exportValues:a}of n){if(i===-1||o===t)continue;const l=typeof a=="string"?a:null,c=document.querySelector(`[data-element-id="${o}"]`);if(c&&!hs.has(c)){ie(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(e)){const{exportValue:i}=n,o=n.getAttribute("data-element-id");o!==t&&hs.has(n)&&s.push({id:o,exportValue:i,domElement:n})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class db extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class Ao extends Se{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action,e.overlaidText),n=!0):e.attachment?(this.#t(s,e.attachment,e.overlaidText,e.attachmentDest),n=!0):e.setOCGState?(this.#n(s,e.setOCGState,e.overlaidText),n=!0):e.dest?(this._bindLink(s,e.dest,e.overlaidText),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,s=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),s&&(e.title=s)}_bindNamedAction(e,t,s=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),s&&(e.title=s),this.#e()}#t(e,t,s="",n=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:s&&(e.title=s),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t,s=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),s&&(e.title=s),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(t.actions)){const i=s.get(n);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:n}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ie('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:n,refs:i,include:o}=t,a=[];if(n.length!==0||i.length!==0){const d=new Set(i);for(const u of n){const h=this._fieldObjects[u]||[];for(const{id:f}of h)d.add(f)}for(const u of Object.values(this._fieldObjects))for(const h of u)d.has(h.id)===o&&a.push(h)}else for(const d of Object.values(this._fieldObjects))a.push(...d);const l=this.annotationStorage,c=[];for(const d of a){const{id:u}=d;switch(c.push(u),d.type){case"text":{const f=d.defaultValue||"";l.setValue(u,{value:f});break}case"checkbox":case"radiobutton":{const f=d.defaultValue===d.exportValues;l.setValue(u,{value:f});break}case"combobox":case"listbox":{const f=d.defaultValue||"";l.setValue(u,{value:f});break}default:continue}const h=document.querySelector(`[data-element-id="${u}"]`);if(h){if(!hs.has(h)){ie(`_bindResetFormAction - element not allowed: ${u}`);continue}}else continue;h.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class ub extends Se{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ys extends Se{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Fe.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,n,i){s.includes("mouse")?e.addEventListener(s,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(o)}})})}_setEventListeners(e,t,s,n){for(const[i,o]of s)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,o,n),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":K.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||lb,i=e.style;let o;const a=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(c/(Xi*n))||1,u=c/d;o=Math.min(n,l(u/Xi))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(n,l(c/Xi))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=K.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class hb extends ys{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,n){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),i.setValue(o.id,{[n]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=e.getValue(t,{value:this.data.fieldValue});let i=n.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&i.length>o&&(i=i.slice(0,o));let a=n.formattedValue||this.data.textContent?.join(`
`)||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const l={userValue:i,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=a??i,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",a??i),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),hs.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:c,datetimeType:d,timeStep:u}=this.data,h=!!d&&this.enableScripting;c&&(s.title=c),this._setRequired(s,this.data.required),o&&(s.maxLength=o),s.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),l.formattedValue=null}),s.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue??"";s.value=l.userValue=g,l.formattedValue=null});let f=p=>{const{formattedValue:g}=l;g!=null&&(p.target.value=g),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",g=>{if(l.focused)return;const{target:m}=g;if(h&&(m.type=d,u&&(m.step=u)),l.userValue){const v=l.userValue;if(h)if(d==="time"){const _=new Date(v),w=[_.getHours(),_.getMinutes(),_.getSeconds()];m.value=w.map(x=>x.toString().padStart(2,"0")).join(":")}else m.value=new Date(v-cb).toISOString().split(d==="date"?"T":".",1)[0];else m.value=v}l.lastCommittedValue=m.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),s.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(v){l.userValue=v.detail.value??"",h||e.setValue(t,{value:l.userValue.toString()}),v.target.value=l.userValue},formattedValue(v){const{formattedValue:_}=v.detail;l.formattedValue=_,_!=null&&v.target!==document.activeElement&&(v.target.value=_);const w={formattedValue:_};h&&(w.value=_),e.setValue(t,w)},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{const{charLimit:_}=v.detail,{target:w}=v;if(_===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",_);let x=l.userValue;!x||x.length<=_||(x=x.slice(0,_),w.value=l.userValue=x,e.setValue(t,{value:x}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),s.addEventListener("keydown",g=>{l.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(l.commitKey=3),m===-1)return;const{value:v}=g.target;l.lastCommittedValue!==v&&(l.lastCommittedValue=v,l.userValue=v,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const p=f;f=null,s.addEventListener("blur",g=>{if(!l.focused||!g.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{target:m}=g;let{value:v}=m;if(h){if(v&&d==="time"){const _=v.split(":").map(w=>parseInt(w,10));v=new Date(2e3,0,1,_[0],_[1],_[2]||0).valueOf(),m.step=""}else v.includes("T")||(v=`${v}T00:00`),v=new Date(v).valueOf();m.type="text"}l.userValue=v,l.lastCommittedValue!==v&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:l.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}),p(g)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",g=>{l.lastCommittedValue=null;const{data:m,target:v}=g,{value:_,selectionStart:w,selectionEnd:x}=v;let S=w,b=x;switch(g.inputType){case"deleteWordBackward":{const A=_.substring(0,w).match(/\w*[^\w]*$/);A&&(S-=A[0].length);break}case"deleteWordForward":{const A=_.substring(w).match(/^[^\w]*\w*/);A&&(b+=A[0].length);break}case"deleteContentBackward":w===x&&(S-=1);break;case"deleteContentForward":w===x&&(b+=1);break}g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:m||"",willCommit:!1,selStart:S,selEnd:b}})}),this._setEventListeners(s,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/o;s.classList.add("comb"),s.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class fb extends ys{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class pb extends ys{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return hs.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,s)){const d=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(s,{value:l})}),i.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Vc extends ys{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(s,{value:n})),n)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(hs.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const c of this._getElementsByName(a,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:l})}),i.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",a=>{const l={value:c=>{const d=o===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const h=d&&u.id===s;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class gb extends Ao{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class mb extends ys{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");hs.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",d=>{const u=this.data.defaultFieldValue;for(const h of n.options)h.selected=h.value===u});for(const d of this.data.options){const u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,s.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),i=!1),n.append(u)}let o=null;if(i){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),n.prepend(d),o=()=>{d.remove(),n.removeEventListener("input",o),o=null},n.addEventListener("input",o)}const a=d=>{const u=d?"value":"textContent",{options:h,multiple:f}=n;return f?Array.prototype.filter.call(h,p=>p.selected).map(p=>p[u]):h.selectedIndex===-1?null:h[h.selectedIndex][u]};let l=a(!1);const c=d=>{const u=d.target.options;return Array.prototype.map.call(u,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",d=>{const u={value(h){o?.();const f=h.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const g of n.options)g.selected=p.has(g.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(h){n.multiple=!0},remove(h){const f=n.options,p=h.detail.remove;f[p].selected=!1,n.remove(p),f.length>0&&Array.prototype.findIndex.call(f,m=>m.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},clear(h){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(h){const{index:f,displayValue:p,exportValue:g}=h.detail.insert,m=n.children[f],v=document.createElement("option");v.textContent=p,v.value=g,m?m.before(v):n.append(v),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},items(h){const{items:f}=h.detail;for(;n.length!==0;)n.remove(0);for(const p of f){const{displayValue:g,exportValue:m}=p,v=document.createElement("option");v.textContent=g,v.value=m,n.append(v)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:a(!0),items:c(h)}),l=a(!1)},indices(h){const f=new Set(h.detail.indices);for(const p of h.target.options)p.selected=f.has(p.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(u,d)}),n.addEventListener("input",d=>{const u=a(!0),h=a(!1);e.setValue(t,{value:u}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:h,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):n.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Lr extends Se{constructor(e){const{data:t,elements:s,parent:n}=e,i=!!n._commentManager;if(super(e,{isRenderable:!i&&Se._hasPopupData(t)}),this.elements=s,i&&Se._hasPopupData(t)){const o=this.popup=this.#e();for(const a of s)a.popup=o}else this.popup=null}#e(){return new yb({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),s=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",s.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(n=>`${ho}${n}`).join(",")),this.container}}class yb{#e=null;#t=this.#j.bind(this);#n=this.#$.bind(this);#s=this.#R.bind(this);#o=this.#_.bind(this);#i=null;#r=null;#a=null;#c=null;#l=null;#h=null;#u=null;#f=!1;#m=null;#p=null;#d=null;#g=null;#y=null;#b=null;#v=null;#C=null;#x=null;#w=null;#T=!1;#A=null;#S=null;constructor({container:e,color:t,elements:s,titleObj:n,modificationDate:i,contentsObj:o,richText:a,parent:l,rect:c,parentRect:d,open:u,commentManager:h=null}){this.#r=e,this.#x=n,this.#a=o,this.#C=a,this.#h=l,this.#i=t,this.#v=c,this.#u=d,this.#l=s,this.#e=h,this.#A=s[0],this.#c=kr.toDateObject(i),this.trigger=s.flatMap(f=>f.getElementsToTriggerPopup()),h?this.renderCommentButton():(this.#M(),this.#r.hidden=!0,u&&this.#_())}#M(){if(this.#p)return;this.#p=new AbortController;const{signal:e}=this.#p;for(const t of this.trigger)t.addEventListener("click",this.#o,{signal:e}),t.addEventListener("pointerenter",this.#s,{signal:e}),t.addEventListener("pointerleave",this.#n,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#k(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#y||this.#k(),!this.#y))return;const{signal:e}=this.#p=new AbortController,t=!!this.#A.extraPopupElement,s=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},n=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#g=this.#A.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",n,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#g=document.createElement("button");o.className="annotationCommentButton";const a=this.#A.container;o.style.zIndex=a.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#B(),this.#P(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",n,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),a.after(o)}}#P(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.renderCommentButton();const[e,t]=this.#y,{style:s}=this.#g;s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`}#B(){this.#A.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#A.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:n,modificationDate:i}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:n,modificationDate:i}}get elementBeforePopup(){return this.#g}get comment(){return this.#S||=this.#A.commentText,this.#S}set comment(e){e!==this.comment&&(this.#A.commentText=this.#S=e)}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#g&&(this.#g.classList.toggle("selected",e),this.#g.ariaExpanded=t)}setSelectedCommentButton(e){this.#g.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:e,y:t,height:s}=this.#g.getBoundingClientRect(),{x:n,y:i,width:o,height:a}=this.#A.layer.getBoundingClientRect();return[(e-n)/o,(t+s-i)/a]}set commentPopupPosition(e){this.#b=e}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=this.#b||this.commentButtonPosition.map(c=>c/100),n=this.parentBoundingClientRect,{x:i,y:o,width:a,height:l}=n;this.#e.showDialog(null,this,i+t*a,o+s*l,{...e,parentDimensions:n})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#i){const s=e.style.outlineColor=K.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#x?.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=this.#x}if(e.append(t),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),t.append(s)}Cc({html:this.#I||this.#a.str,dir:this.#a?.dir,className:"popupContent"},e),this.#r.append(e)}get#I(){const e=this.#C,t=this.#a;return e?.str&&(!t?.str||t.str===e.str)&&this.#C.html||null}get#O(){return this.#I?.attributes?.style?.fontSize||0}get#N(){return this.#I?.attributes?.style?.color||null}#L(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:this.#N,fontSize:this.#O?`calc(${this.#O}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:n});return s}#j(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:e,popup:t,deleted:s}){if(this.#e){s?(this.remove(),this.#S=null):t&&(t.deleted?this.remove():(this.#B(),this.#S=t.text)),e&&(this.#y=null,this.#k(),this.#P());return}if(s||t?.deleted){this.remove();return}this.#M(),this.#w||={contentsObj:this.#a,richText:this.#C},e&&(this.#d=null),t&&t.text&&(this.#C=this.#L(t.text),this.#c=kr.toDateObject(t.date),this.#a=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#a,richText:this.#C}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#d=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#T=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#E(){if(this.#d!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:n,pageY:i}}}=this.#h;let o=!!this.#u,a=o?this.#u:this.#v;for(const p of this.#l)if(!a||K.intersect(p.data.rect,a)!==null){a=p.data.rect,o=!0;break}const l=K.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,u=l[0]+d,h=l[1];this.#d=[100*(u-n)/t,100*(h-i)/s];const{style:f}=this.#r;f.left=`${this.#d[0]}%`,f.top=`${this.#d[1]}%`}#_(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#R(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#t)):(this.#$(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#t))}#R(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#E(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#$(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#r.hidden=!0)}maybeShow(){this.#e||(this.#M(),this.#T&&(this.#m||this.#R(),this.#T=!1,this.#r.hidden=!1))}get isVisible(){return this.#e?!1:this.#r.hidden===!1}}class Wc extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=re.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class vb extends Se{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:s}=this,n=this.svgFactory.create(t,s,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),n.append(i),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class bb extends Se{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:s}=this,n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",s-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class wb extends Se{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:s}=this,n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",s/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",s/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gc extends Se{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:n},width:i,height:o}=this;if(!t)return this.container;const a=this.svgFactory.create(i,o,!0);let l=[];for(let d=0,u=t.length;d<u;d+=2){const h=t[d]-e[0],f=e[3]-t[d+1];l.push(`${h},${f}`)}l=l.join(" ");const c=this.#e=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class _b extends Gc{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ab extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class xo extends Se{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?re.HIGHLIGHT:re.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:n,popupRef:i}}=this,{transform:o,width:a,height:l}=this.#n(t,e),c=this.svgFactory.create(a,l,!0),d=this.#e=this.svgFactory.createElement("svg:g");c.append(d),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let u=0,h=s.length;u<h;u++){const f=this.svgFactory.createElement(this.svgElementName);this.#t.push(f),f.setAttribute("points",s[u].join(",")),d.append(f)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:n}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),s)for(let o=0,a=this.#t.length;o<a;o++)this.#t[o].setAttribute("points",s[o].join(","));if(n){const{transform:o,width:a,height:l}=this.#n(this.data.rotation,n);i.parentElement.setAttribute("viewBox",`0 0 ${a} ${l}`),i.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Xc extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=re.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class xb extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class Sb extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class Cb extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class Yc extends Se{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=re.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Eb extends Se{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:n}=Fe.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(n?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class So{#e=null;#t=null;#n=null;#s=new Map;#o=null;#i=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:n,page:i,viewport:o,structTreeLayer:a,commentManager:l,linkService:c,annotationStorage:d}){this.div=e,this.#e=t,this.#t=s,this.#o=a||null,this.#i=c||null,this.#n=d||new yo,this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=l||null}hasEditableAnnotations(){return this.#s.size>0}async#r(e,t,s){const n=e.firstChild||e,i=n.id=`${ho}${t}`,o=await this.#o?.getAriaAttributes(i);if(o)for(const[a,l]of o)n.setAttribute(a,l);s?s.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,n,!1))}async render(e){const{annotations:t}=e,s=this.div;us(s,this.viewport);const n=new Map,i={data:null,layer:s,linkService:this.#i,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new ci,annotationStorage:this.#n,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const a=o.annotationType===Pe.POPUP;if(a){const d=n.get(o.id);if(!d)continue;i.elements=d}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const l=Wa.create(i);if(!l.isRenderable)continue;if(!a&&o.popupRef){const d=n.get(o.popupRef);d?d.push(l):n.set(o.popupRef,[l])}const c=l.render();o.hidden&&(c.style.visibility="hidden"),await this.#r(c,o.id,i.elements),l.extraPopupElement?.popup?.renderCommentButton(),l._isEditable&&(this.#s.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#a()}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#i,svgFactory:new ci,parent:this};for(const s of e){s.borderStyle||=So._defaultBorderStyle,t.data=s;const n=Wa.create(t);if(!n.isRenderable)continue;const i=n.render();await this.#r(i,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,us(t,{rotation:e.rotation}),this.#a(),t.hidden=!1}#a(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const n=e.querySelector(`[data-annotation-id="${t}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:i}=n;i?i.nodeName==="CANVAS"?i.replaceWith(s):i.classList.contains("annotationContent")?i.after(s):i.before(s):n.append(s);const o=this.#s.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,n.id,s),o._hasNoCanvas=!1):o.canvas=s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:n}=e,i=new db({data:{id:s,rect:e.getPDFRect(),rotation:n},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#i,annotationStorage:this.#n}),o=i.render();return t.append(o),this.#e?.moveElementInDOM(t,o,o,!1),i.createOrUpdatePopup(),i}static get _defaultBorderStyle(){return ae(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ss.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Wn=/\r\n?|\n/g;class Ie extends Q{#e="";#t=`${this.id}-editor`;#n=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Ie.prototype,t=i=>i.isEmpty(),s=ts.TRANSLATE_SMALL,n=ts.TRANSLATE_BIG;return ae(this,"_keyboardManager",new En([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}]]))}static _type="freetext";static _editorType=re.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||Ie._defaultColor||Q._defaultLineColor,this.#s=e.fontSize||Ie._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){Q.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case ue.FREETEXT_SIZE:Ie._defaultFontSize=t;break;case ue.FREETEXT_COLOR:Ie._defaultColor=t;break}}updateParams(e,t){switch(e){case ue.FREETEXT_SIZE:this.#o(t);break;case ue.FREETEXT_COLOR:this.#i(t);break}}static get defaultPropertiesToUpdate(){return[[ue.FREETEXT_SIZE,Ie._defaultFontSize],[ue.FREETEXT_COLOR,Ie._defaultColor||Q._defaultLineColor]]}get propertiesToUpdate(){return[[ue.FREETEXT_SIZE,this.#s],[ue.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new pn(this),[["colorPicker",this._colorPicker]]}get colorType(){return ue.FREETEXT_COLOR}#o(e){const t=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--total-scale-factor))`,this.translate(0,-(n-this.#s)*this.parentScale),this.#s=n,this.#a()},s=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#i(e){const t=n=>{this.color=n,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ie._internalPadding*e,-(Ie._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(Ie.#c(s)),t=s);return e.join(`
`)}#a(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:i}=this,o=i.style.display,a=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",n.div.append(this.div),s=i.getBoundingClientRect(),i.remove(),i.style.display=o,i.classList.toggle("hidden",a)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#r().trimEnd();if(e===t)return;const s=n=>{if(this.#e=n,!n){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#a()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#a()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ie._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[a,l]=this.getInitialTranslation();[a,l]=this.pageTranslationToScreen(a,l);const[c,d]=this.pageDimensions,[u,h]=this.pageTranslation;let f,p;switch(this.rotation){case 0:f=e+(o[0]-u)/c,p=t+this.height-(o[1]-h)/d;break;case 90:f=e+(o[0]-u)/c,p=t-(o[1]-h)/d,[a,l]=[l,-a];break;case 180:f=e-this.width+(o[0]-u)/c,p=t-(o[1]-h)/d,[a,l]=[-a,-l];break;case 270:f=e+(o[0]-u-this.height*d)/c,p=t+(o[1]-h-this.width*c)/d,[a,l]=[-l,a];break}this.setAt(f*n,p*i,a,l)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Wn,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const n=Ie.#u(t.getData("text")||"").replaceAll(Wn,`
`);if(!n)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const o=i.getRangeAt(0);if(!n.includes(`
`)){o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:a,startOffset:l}=o,c=[],d=[];if(a.nodeType===Node.TEXT_NODE){const f=a.parentElement;if(d.push(a.nodeValue.slice(l).replaceAll(Wn,"")),f!==this.editorDiv){let p=c;for(const g of this.editorDiv.childNodes){if(g===f){p=d;continue}p.push(Ie.#c(g))}}c.push(a.nodeValue.slice(0,l).replaceAll(Wn,""))}else if(a===this.editorDiv){let f=c,p=0;for(const g of this.editorDiv.childNodes)p++===l&&(f=d),f.push(Ie.#c(g))}this.#e=`${c.join(`
`)}${n}${d.join(`
`)}`,this.#l();const u=new Range;let h=Math.sumPrecise(c.map(f=>f.length));for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const p=f.nodeValue.length;if(h<=p){u.setStart(f,h),u.setEnd(f,h);break}h-=p}i.removeAllRanges(),i.addRange(u)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#u(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=Ie._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,s){let n=null;if(e instanceof Wc){const{data:{defaultAppearanceData:{fontSize:o,fontColor:a},rect:l,rotation:c,id:d,popupRef:u,richText:h,contentsObj:f,creationDate:p,modificationDate:g},textContent:m,textPosition:v,parent:{page:{pageNumber:_}}}=e;if(!m||m.length===0)return null;n=e={annotationType:re.FREETEXT,color:Array.from(a),fontSize:o,value:m.join(`
`),position:v,pageIndex:_-1,rect:l.slice(0),rotation:c,annotationElementId:d,id:d,deleted:!1,popupRef:u,comment:f?.str||null,richText:h,creationDate:p,modificationDate:g}}const i=await super.deserialize(e,t,s);return i.#s=e.fontSize,i.color=K.makeHexColor(...e.color),i.#e=Ie.#u(e.value),i._initialData=n,e.comment&&i.setCommentData(e),i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Q._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(e),{color:t,fontSize:this.#s,value:this.#h()});return this.addComment(s),e?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(e){const{value:t,fontSize:s,color:n,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((o,a)=>o!==n[a])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:s}=t;s.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,s.color=this.color,t.replaceChildren();for(const n of this.#e.split(`
`)){const i=document.createElement("div");i.append(n?document.createTextNode(n):document.createElement("br")),t.append(i)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class X{static PRECISION=1e-4;toSVGPath(){me("Abstract method `toSVGPath` must be implemented.")}get box(){me("Abstract getter `box` must be implemented.")}serialize(e,t){me("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,n,i,o){o||=new Float32Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*n,o[a+1]=s+e[a+1]*i;return o}static _rescaleAndSwap(e,t,s,n,i,o){o||=new Float32Array(e.length);for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*n,o[a+1]=s+e[a]*i;return o}static _translate(e,t,s,n){n||=new Float32Array(e.length);for(let i=0,o=e.length;i<o;i+=2)n[i]=t+e[i],n[i+1]=s+e[i+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,n,i){switch(i){case 90:return[1-t/s,e/n];case 180:return[1-e/s,1-t/n];case 270:return[t/s,1-e/n];default:return[e/s,t/n]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,n,i,o){return[(e+5*s)/6,(t+5*n)/6,(5*s+i)/6,(5*n+o)/6,(s+i)/2,(n+o)/2]}}class rs{#e;#t=[];#n;#s;#o=[];#i=new Float32Array(18);#r;#a;#c;#l;#h;#u;#f=[];static#m=8;static#p=2;static#d=rs.#m+rs.#p;constructor({x:e,y:t},s,n,i,o,a=0){this.#e=s,this.#u=i*n,this.#s=o,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=a,this.#l=rs.#m*n,this.#c=rs.#d*n,this.#h=n,this.#f.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#g(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[s,n,i,o]=this.#e;return[(this.#r+(e[0]-t[0])/2-s)/i,(this.#a+(e[1]-t[1])/2-n)/o,(this.#r+(t[0]-e[0])/2-s)/i,(this.#a+(t[1]-e[1])/2-n)/o]}add({x:e,y:t}){this.#r=e,this.#a=t;const[s,n,i,o]=this.#e;let[a,l,c,d]=this.#i.subarray(8,12);const u=e-c,h=t-d,f=Math.hypot(u,h);if(f<this.#c)return!1;const p=f-this.#l,g=p/f,m=g*u,v=g*h;let _=a,w=l;a=c,l=d,c+=m,d+=v,this.#f?.push(e,t);const x=-v/p,S=m/p,b=x*this.#u,A=S*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([c+b,d+A],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([c-b,d-A],16),isNaN(this.#i[6])?(this.#o.length===0&&(this.#i.set([a+b,l+A],2),this.#o.push(NaN,NaN,NaN,NaN,(a+b-s)/i,(l+A-n)/o),this.#i.set([a-b,l-A],14),this.#t.push(NaN,NaN,NaN,NaN,(a-b-s)/i,(l-A-n)/o)),this.#i.set([_,w,a,l,c,d],6),!this.isEmpty()):(this.#i.set([_,w,a,l,c,d],6),Math.abs(Math.atan2(w-l,_-a)-Math.atan2(v,m))<Math.PI/2?([a,l,c,d]=this.#i.subarray(2,6),this.#o.push(NaN,NaN,NaN,NaN,((a+c)/2-s)/i,((l+d)/2-n)/o),[a,l,_,w]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((_+a)/2-s)/i,((w+l)/2-n)/o),!0):([_,w,a,l,c,d]=this.#i.subarray(0,6),this.#o.push(((_+5*a)/6-s)/i,((w+5*l)/6-n)/o,((5*a+c)/6-s)/i,((5*l+d)/6-n)/o,((a+c)/2-s)/i,((l+d)/2-n)/o),[c,d,a,l,_,w]=this.#i.subarray(12,18),this.#t.push(((_+5*a)/6-s)/i,((w+5*l)/6-n)/o,((5*a+c)/6-s)/i,((5*l+d)/6-n)/o,((a+c)/2-s)/i,((l+d)/2-n)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#o,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#y();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);this.#v(s);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return this.#b(s),s.join(" ")}#y(){const[e,t,s,n]=this.#e,[i,o,a,l]=this.#g();return`M${(this.#i[2]-e)/s} ${(this.#i[3]-t)/n} L${(this.#i[4]-e)/s} ${(this.#i[5]-t)/n} L${i} ${o} L${a} ${l} L${(this.#i[16]-e)/s} ${(this.#i[17]-t)/n} L${(this.#i[14]-e)/s} ${(this.#i[15]-t)/n} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,s,n,i]=this.#e,o=this.#i.subarray(4,6),a=this.#i.subarray(16,18),[l,c,d,u]=this.#g();e.push(`L${(o[0]-t)/n} ${(o[1]-s)/i} L${l} ${c} L${d} ${u} L${(a[0]-t)/n} ${(a[1]-s)/i}`)}newFreeDrawOutline(e,t,s,n,i,o){return new Kc(e,t,s,n,i,o)}getOutlines(){const e=this.#o,t=this.#t,s=this.#i,[n,i,o,a]=this.#e,l=new Float32Array((this.#f?.length??0)+2);for(let u=0,h=l.length-2;u<h;u+=2)l[u]=(this.#f[u]-n)/o,l[u+1]=(this.#f[u+1]-i)/a;if(l[l.length-2]=(this.#r-n)/o,l[l.length-1]=(this.#a-i)/a,isNaN(s[6])&&!this.isEmpty())return this.#C(l);const c=new Float32Array(this.#o.length+24+this.#t.length);let d=e.length;for(let u=0;u<d;u+=2){if(isNaN(e[u])){c[u]=c[u+1]=NaN;continue}c[u]=e[u],c[u+1]=e[u+1]}d=this.#w(c,d);for(let u=t.length-6;u>=6;u-=6)for(let h=0;h<6;h+=2){if(isNaN(t[u+h])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=t[u+h],c[d+1]=t[u+h+1],d+=2}return this.#x(c,d),this.newFreeDrawOutline(c,l,this.#e,this.#h,this.#n,this.#s)}#C(e){const t=this.#i,[s,n,i,o]=this.#e,[a,l,c,d]=this.#g(),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-n)/o,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-n)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-n)/o,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-n)/o],0),this.newFreeDrawOutline(u,e,this.#e,this.#h,this.#n,this.#s)}#x(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#w(e,t){const s=this.#i.subarray(4,6),n=this.#i.subarray(16,18),[i,o,a,l]=this.#e,[c,d,u,h]=this.#g();return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/a,(s[1]-o)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(n[0]-i)/a,(n[1]-o)/l],t),t+=24}}class Kc extends X{#e;#t=new Float32Array(4);#n;#s;#o;#i;#r;constructor(e,t,s,n,i,o){super(),this.#r=e,this.#o=t,this.#e=s,this.#i=n,this.#n=i,this.#s=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#a(o);const[a,l,c,d]=this.#t;for(let u=0,h=e.length;u<h;u+=2)e[u]=(e[u]-a)/c,e[u+1]=(e[u+1]-l)/d;for(let u=0,h=t.length;u<h;u+=2)t[u]=(t[u]-a)/c,t[u+1]=(t[u+1]-l)/d}toSVGPath(){const e=[`M${this.#r[4]} ${this.#r[5]}`];for(let t=6,s=this.#r.length;t<s;t+=6){if(isNaN(this.#r[t])){e.push(`L${this.#r[t+4]} ${this.#r[t+5]}`);continue}e.push(`C${this.#r[t]} ${this.#r[t+1]} ${this.#r[t+2]} ${this.#r[t+3]} ${this.#r[t+4]} ${this.#r[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,n],i){const o=s-e,a=n-t;let l,c;switch(i){case 0:l=X._rescale(this.#r,e,n,o,-a),c=X._rescale(this.#o,e,n,o,-a);break;case 90:l=X._rescaleAndSwap(this.#r,e,t,o,a),c=X._rescaleAndSwap(this.#o,e,t,o,a);break;case 180:l=X._rescale(this.#r,s,t,-o,a),c=X._rescale(this.#o,s,t,-o,a);break;case 270:l=X._rescaleAndSwap(this.#r,s,n,-o,-a),c=X._rescaleAndSwap(this.#o,s,n,-o,-a);break}return{outline:Array.from(l),points:[Array.from(c)]}}#a(e){const t=this.#r;let s=t[4],n=t[5];const i=[s,n,s,n];let o=s,a=n,l=s,c=n;const d=e?Math.max:Math.min,u=new Float32Array(4);for(let f=6,p=t.length;f<p;f+=6){const g=t[f+4],m=t[f+5];isNaN(t[f])?(K.pointBoundingBox(g,m,i),a>m?(o=g,a=m):a===m&&(o=d(o,g)),c<m?(l=g,c=m):c===m&&(l=d(l,g))):(u[0]=u[1]=1/0,u[2]=u[3]=-1/0,K.bezierBoundingBox(s,n,...t.slice(f,f+6),u),K.rectBoundingBox(u[0],u[1],u[2],u[3],i),a>u[1]?(o=u[0],a=u[1]):a===u[1]&&(o=d(o,u[0])),c<u[3]?(l=u[2],c=u[3]):c===u[3]&&(l=d(l,u[2]))),s=g,n=m}const h=this.#t;h[0]=i[0]-this.#n,h[1]=i[1]-this.#n,h[2]=i[2]-i[0]+2*this.#n,h[3]=i[3]-i[1]+2*this.#n,this.firstPoint=[o,a],this.lastPoint=[l,c]}get box(){return this.#t}newOutliner(e,t,s,n,i,o=0){return new rs(e,t,s,n,i,o)}getNewOutline(e,t){const[s,n,i,o]=this.#t,[a,l,c,d]=this.#e,u=i*c,h=o*d,f=s*c+a,p=n*d+l,g=this.newOutliner({x:this.#o[0]*u+f,y:this.#o[1]*h+p},this.#e,this.#i,e,this.#s,t??this.#n);for(let m=2;m<this.#o.length;m+=2)g.add({x:this.#o[m]*u+f,y:this.#o[m+1]*h+p});return g.getOutlines()}}class Fr{#e;#t;#n;#s=[];#o=[];constructor(e,t=0,s=0,n=!0){const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:g,y:m,width:v,height:_}of e){const w=Math.floor((g-t)/o)*o,x=Math.ceil((g+v+t)/o)*o,S=Math.floor((m-t)/o)*o,b=Math.ceil((m+_+t)/o)*o,A=[w,S,b,!0],E=[x,S,b,!1];this.#s.push(A,E),K.rectBoundingBox(w,S,x,b,i)}const a=i[2]-i[0]+2*s,l=i[3]-i[1]+2*s,c=i[0]-s,d=i[1]-s;let u=n?-1/0:1/0,h=1/0;const f=this.#s.at(n?-1:-2),p=[f[0],f[2]];for(const g of this.#s){const[m,v,_,w]=g;!w&&n?v<h?(h=v,u=m):v===h&&(u=Math.max(u,m)):w&&!n&&(v<h?(h=v,u=m):v===h&&(u=Math.min(u,m))),g[0]=(m-c)/a,g[1]=(v-d)/l,g[2]=(_-d)/l}this.#e=new Float32Array([c,d,a,l]),this.#t=[u,h],this.#n=p}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#l(t)),this.#a(t)):(this.#c(t),e.push(...this.#l(t)));return this.#i(e)}#i(e){const t=[],s=new Set;for(const o of e){const[a,l,c]=o;t.push([a,l,o],[a,c,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],c=t[o+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let i;for(;s.size>0;){const o=s.values().next().value;let[a,l,c,d,u]=o;s.delete(o);let h=a,f=l;for(i=[a,c],n.push(i);;){let p;if(s.has(d))p=d;else if(s.has(u))p=u;else break;s.delete(p),[a,l,c,d,u]=p,h!==a&&(i.push(h,f,a,f===l?l:c),h=a),f=f===l?c:l}i.push(h,f)}return new Tb(n,this.#e,this.#t,this.#n)}#r(e){const t=this.#o;let s=0,n=t.length-1;for(;s<=n;){const i=s+n>>1,o=t[i][0];if(o===e)return i;o<e?s=i+1:n=i-1}return n+1}#a([,e,t]){const s=this.#r(e);this.#o.splice(s,0,[e,t])}#c([,e,t]){const s=this.#r(e);for(let n=s;n<this.#o.length;n++){const[i,o]=this.#o[n];if(i!==e)break;if(i===e&&o===t){this.#o.splice(n,1);return}}for(let n=s-1;n>=0;n--){const[i,o]=this.#o[n];if(i!==e)break;if(i===e&&o===t){this.#o.splice(n,1);return}}}#l(e){const[t,s,n]=e,i=[[t,s,n]],o=this.#r(n);for(let a=0;a<o;a++){const[l,c]=this.#o[a];for(let d=0,u=i.length;d<u;d++){const[,h,f]=i[d];if(!(c<=h||f<=l)){if(h>=l){if(f>c)i[d][1]=c;else{if(u===1)return[];i.splice(d,1),d--,u--}continue}i[d][2]=l,f>c&&i.push([t,c,f])}}}return i}}class Tb extends X{#e;#t;constructor(e,t,s,n){super(),this.#t=e,this.#e=t,this.firstPoint=s,this.lastPoint=n}toSVGPath(){const e=[];for(const t of this.#t){let[s,n]=t;e.push(`M${s} ${n}`);for(let i=2;i<t.length;i+=2){const o=t[i],a=t[i+1];o===s?(e.push(`V${a}`),n=a):a===n&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,t,s,n],i){const o=[],a=s-e,l=n-t;for(const c of this.#t){const d=new Array(c.length);for(let u=0;u<c.length;u+=2)d[u]=e+c[u]*a,d[u+1]=n-c[u+1]*l;o.push(d)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Br extends rs{newFreeDrawOutline(e,t,s,n,i,o){return new kb(e,t,s,n,i,o)}}class kb extends Kc{newOutliner(e,t,s,n,i,o=0){return new Br(e,t,s,n,i,o)}}class Ee extends Q{#e=null;#t=0;#n;#s=null;#o=null;#i=null;#r=null;#a=0;#c=null;#l=null;#h=null;#u=!1;#f=null;#m=null;#p=null;#d="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=re.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Ee.prototype;return ae(this,"_keyboardManager",new En([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Ee._defaultColor,this.#g=e.thickness||Ee._defaultThickness,this.opacity=e.opacity||Ee._defaultOpacity,this.#n=e.boxes||null,this.#y=e.methodOfCreation||"",this.#d=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#v(e),this.#A()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#r=e.focusNode,this.#a=e.focusOffset,this.#b(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new Fr(this.#n,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Fr(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:n}=this.#i;this.#m=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#l=e;const n=1.5;if(this.#i=e.getNewOutline(this.#g/2+n,.0025),t>=0)this.#h=t,this.#s=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const u=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Ee.#S(this.#l.box,(u-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Ee.#S(this.#i.box,u),path:{d:this.#i.toSVGPath()}})}const[i,o,a,l]=e.box;switch(this.rotation){case 0:this.x=i,this.y=o,this.width=a,this.height=l;break;case 90:{const[u,h]=this.parentDimensions;this.x=o,this.y=1-i,this.width=a*h/u,this.height=l*u/h;break}case 180:this.x=1-i,this.y=1-o,this.width=a,this.height=l;break;case 270:{const[u,h]=this.parentDimensions;this.x=1-o,this.y=i,this.width=a*h/u,this.height=l*u/h;break}}const{firstPoint:c}=e;this.#f=[(c[0]-i)/a,(c[1]-o)/l];const{lastPoint:d}=this.#i;this.#m=[(d[0]-i)/a,(d[1]-o)/l]}static initialize(e,t){Q.initialize(e,t),Ee._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case ue.HIGHLIGHT_COLOR:Ee._defaultColor=t;break;case ue.HIGHLIGHT_THICKNESS:Ee._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case ue.HIGHLIGHT_COLOR:this.#C(t);break;case ue.HIGHLIGHT_THICKNESS:this.#x(t);break}}static get defaultPropertiesToUpdate(){return[[ue.HIGHLIGHT_COLOR,Ee._defaultColor],[ue.HIGHLIGHT_THICKNESS,Ee._defaultThickness]]}get propertiesToUpdate(){return[[ue.HIGHLIGHT_COLOR,this.color||Ee._defaultColor],[ue.HIGHLIGHT_THICKNESS,this.#g||Ee._defaultThickness],[ue.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#o?.updateColor(this.color),super.onUpdatedColor()}#C(e){const t=(i,o)=>{this.color=i,this.opacity=o,this.onUpdatedColor()},s=this.color,n=this.opacity;this.addCommands({cmd:t.bind(this,e,Ee._defaultOpacity),undo:t.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#x(e){const t=this.#g,s=n=>{this.#g=n,this.#w(n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#o=new at({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#T():e&&(this.#A(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#u&&(this.#v({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#T(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#A(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#s}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#s))}static#S([e,t,s,n],i){switch(i){case 90:return[1-t-n,e,n,s];case 180:return[1-e-s,1-t-n,s,n];case 270:return[t,1-e-s,n,s]}return[e,t,s,n]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#u?(e=(e-this.rotation+360)%360,s=Ee.#S(this.#l.box,e)):s=Ee.#S([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Ee.#S(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#d&&(e.setAttribute("aria-label",this.#d),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#s,this.setDims(this.width,this.height),Ec(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(e){Ee._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#r,this.#a)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#k(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#P(){return this.#u?this.rotation:0}#B(){if(this.#u)return null;const[e,t]=this.pageDimensions,[s,n]=this.pageTranslation,i=this.#n,o=new Float32Array(i.length*8);let a=0;for(const{x:l,y:c,width:d,height:u}of i){const h=l*e+s,f=(1-c)*t+n;o[a]=o[a+4]=h,o[a+1]=o[a+3]=f,o[a+2]=o[a+6]=h+d*e,o[a+5]=o[a+7]=f-u*t,a+=8}return o}#I(e){return this.#l.serialize(e,this.#P())}static startHighlighting(e,t,{target:s,x:n,y:i}){const{x:o,y:a,width:l,height:c}=s.getBoundingClientRect(),d=new AbortController,u=e.combinedSignal(d),h=f=>{d.abort(),this.#N(e,f)};window.addEventListener("blur",h,{signal:u}),window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("pointerdown",Ce,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",lt,{signal:u}),s.addEventListener("pointermove",this.#O.bind(this,e),{signal:u}),this._freeHighlight=new Br({x:n,y:i},[o,a,l,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#O(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#N(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let n=null;if(e instanceof Xc){const{data:{quadPoints:p,rect:g,rotation:m,id:v,color:_,opacity:w,popupRef:x,richText:S,contentsObj:b,creationDate:A,modificationDate:E},parent:{page:{pageNumber:C}}}=e;n=e={annotationType:re.HIGHLIGHT,color:Array.from(_),opacity:w,quadPoints:p,boxes:null,pageIndex:C-1,rect:g.slice(0),rotation:m,annotationElementId:v,id:v,deleted:!1,popupRef:x,richText:S,comment:b?.str||null,creationDate:A,modificationDate:E}}else if(e instanceof xo){const{data:{inkLists:p,rect:g,rotation:m,id:v,color:_,borderStyle:{rawWidth:w},popupRef:x,richText:S,contentsObj:b,creationDate:A,modificationDate:E},parent:{page:{pageNumber:C}}}=e;n=e={annotationType:re.HIGHLIGHT,color:Array.from(_),thickness:w,inkLists:p,boxes:null,pageIndex:C-1,rect:g.slice(0),rotation:m,annotationElementId:v,id:v,deleted:!1,popupRef:x,richText:S,comment:b?.str||null,creationDate:A,modificationDate:E}}const{color:i,quadPoints:o,inkLists:a,opacity:l}=e,c=await super.deserialize(e,t,s);c.color=K.makeHexColor(...i),c.opacity=l||1,a&&(c.#g=e.thickness),c._initialData=n,e.comment&&c.setCommentData(e);const[d,u]=c.pageDimensions,[h,f]=c.pageTranslation;if(o){const p=c.#n=[];for(let g=0;g<o.length;g+=8)p.push({x:(o[g]-h)/d,y:1-(o[g+1]-f)/u,width:(o[g+2]-o[g])/d,height:(o[g+1]-o[g+5])/u});c.#b(),c.#A(),c.rotate(c.rotation)}else if(a){c.#u=!0;const p=a[0],g={x:p[0]-h,y:u-(p[1]-f)},m=new Br(g,[0,0,d,u],1,c.#g/2,!0,.001);for(let w=0,x=p.length;w<x;w+=2)g.x=p[w]-h,g.y=u-(p[w+1]-f),m.add(g);const{id:v,clipPathId:_}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:m.toSVGPath()}},!0,!0);c.#v({highlightOutlines:m.getOutlines(),highlightId:v,clipPathId:_}),c.#A(),c.rotate(c.parentRotation)}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Q._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(e);return Object.assign(s,{color:t,opacity:this.opacity,thickness:this.#g,quadPoints:this.#B(),outlines:this.#I(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#L(s)?null:(s.id=this.annotationElementId,s)}#L(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((s,n)=>s!==t[n])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Zc{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){me("Not implemented")}}class se extends Q{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#s=null;static#o=null;static#i=NaN;static#r=null;static#a=null;static#c=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#l(e),this.#f())}#l({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#d(e.box)}#h(e,t){const{id:s}=t.drawLayer.draw(se._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[n,i]of Object.entries(t))s.has(n)?Object.assign(e[n],i):e[n]=i;return e}static getDefaultDrawingOptions(e){me("Not implemented")}static get typesMap(){me("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(se.#n.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)e.push([s,t[n]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,n]of this.constructor.typesMap)e.push([s,t[n]]);return e}_updateProperty(e,t,s){const n=this._drawingOptions,i=n[t],o=a=>{n.updateProperty(t,a);const l=this.#e.updateProperty(t,a);l&&this.#d(l),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,se._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,se._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,se._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#d(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#u()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#m([e,t,s,n]){const{parentDimensions:[i,o],rotation:a}=this;switch(a){case 90:return[t,1-e,s*(o/i),n*(i/o)];case 180:return[1-e,1-t,s,n];case 270:return[1-t,e,s*(o/i),n*(i/o)];default:return[e,t,s,n]}}#p(){const{x:e,y:t,width:s,height:n,parentDimensions:[i,o],rotation:a}=this;switch(a){case 90:return[1-t,e,s*(i/o),n*(o/i)];case 180:return[1-e,1-t,s,n];case 270:return[t,1-e,s*(i/o),n*(o/i)];default:return[e,t,s,n]}}#d(e){[this.x,this.y,this.width,this.height]=this.#m(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:e,y:t,width:s,height:n,rotation:i,parentRotation:o,parentDimensions:[a,l]}=this;switch((i*4+o)/90){case 1:return[1-t-n,e,n,s];case 2:return[1-e-s,1-t-n,s,n];case 3:return[t,1-e-s,n,s];case 4:return[e,t-s*(a/l),n*(l/a),s*(a/l)];case 5:return[1-t,e,s*(a/l),n*(l/a)];case 6:return[1-e-n*(l/a),1-t,n*(l/a),s*(a/l)];case 7:return[t-s*(a/l),1-e-n*(l/a),s*(a/l),n*(l/a)];case 8:return[e-s,t-n,s,n];case 9:return[1-t,e-s,n,s];case 10:return[1-e,1-t,s,n];case 11:return[t-n,1-e,n,s];case 12:return[e-n*(l/a),t,n*(l/a),s*(a/l)];case 13:return[1-t-s*(a/l),e-n*(l/a),s*(a/l),n*(l/a)];case 14:return[1-e,1-t-s*(a/l),n*(l/a),s*(a/l)];case 15:return[t,1-e,s*(a/l),n*(l/a)];default:return[e,t,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,se._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#d(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const s=super.render();s.classList.add("draw");const n=document.createElement("div");return s.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),s}static createDrawerInstance(e,t,s,n,i){me("Not implemented")}static startDrawing(e,t,s,n){const{target:i,offsetX:o,offsetY:a,pointerId:l,pointerType:c}=n;if(se.#r&&se.#r!==c)return;const{viewport:{rotation:d}}=e,{width:u,height:h}=i.getBoundingClientRect(),f=se.#s=new AbortController,p=e.combinedSignal(f);if(se.#i||=l,se.#r??=c,window.addEventListener("pointerup",g=>{se.#i===g.pointerId?this._endDraw(g):se.#a?.delete(g.pointerId)},{signal:p}),window.addEventListener("pointercancel",g=>{se.#i===g.pointerId?this._currentParent.endDrawingSession():se.#a?.delete(g.pointerId)},{signal:p}),window.addEventListener("pointerdown",g=>{se.#r===g.pointerType&&((se.#a||=new Set).add(g.pointerId),se.#n.isCancellable()&&(se.#n.removeLastElement(),se.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",lt,{signal:p}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),i.addEventListener("touchmove",g=>{g.timeStamp===se.#c&&Ce(g)},{signal:p}),e.toggleDrawing(),t._editorUndoBar?.hide(),se.#n){e.drawLayer.updateProperties(this._currentDrawId,se.#n.startNew(o,a,u,h,d));return}t.updateUIForDefaultProperties(this),se.#n=this.createDrawerInstance(o,a,u,h,d),se.#o=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(se.#o.toSVGProperties(),se.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(se.#c=-1,!se.#n)return;const{offsetX:t,offsetY:s,pointerId:n}=e;if(se.#i===n){if(se.#a?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,se.#n.add(t,s)),se.#c=e.timeStamp,Ce(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,se.#n=null,se.#o=null,se.#r=null,se.#c=NaN),se.#s&&(se.#s.abort(),se.#s=null,se.#i=NaN,se.#a=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,se.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=se.#n,n=this._currentDrawId,i=s.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(n,s.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(n,s.removeLastElement())},mustExec:!1,type:ue.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(ue.DRAW_STEP),!se.#n.isEmpty()){const{pageDimensions:[s,n],scale:i}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:se.#n.getOutlines(s*i,n*i,i,this._INNER_MARGIN),drawingOptions:se.#o,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,n,i,o){me("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:n,pageHeight:i,pageX:o,pageY:a}}=t.viewport,l=this.deserializeDraw(o,a,n,i,this._INNER_MARGIN,e),c=await super.deserialize(e,t,s);return c.createDrawingOptions(e),c.#l({drawOutlines:l}),c.#f(),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){const[t,s]=this.pageTranslation,[n,i]=this.pageDimensions;return this.#e.serialize([t,s,n,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class Pb{#e=new Float64Array(6);#t;#n;#s;#o;#i;#r="";#a=0;#c=new kn;#l;#h;constructor(e,t,s,n,i,o){this.#l=s,this.#h=n,this.#s=i,this.#o=o,[e,t]=this.#u(e,t);const a=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#n=[{line:a,points:this.#i}],this.#e.set(a,0)}updateProperty(e,t){e==="stroke-width"&&(this.#o=t)}#u(e,t){return X._normalizePoint(e,t,this.#l,this.#h,this.#s)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#u(e,t);const[s,n,i,o]=this.#e.subarray(2,6),a=e-i,l=t-o;return Math.hypot(this.#l*a,this.#h*l)<=2?null:(this.#i.push(e,t),isNaN(s)?(this.#e.set([i,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,n,i,o,e,t],0),this.#t.push(...X.createBezierPoints(s,n,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,n,i){this.#l=s,this.#h=n,this.#s=i,[e,t]=this.#u(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const a=this.#n.at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),this.#n.push({line:o,points:this.#i}),this.#e.set(o,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#i=e.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#r="";for(let e=0,t=this.#n.length;e<t;e++){const{line:s,points:n}=this.#n[e];this.#t=s,this.#i=n,this.#a=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const e=X.svgRound(this.#t[4]),t=X.svgRound(this.#t[5]);if(this.#i.length===2)return this.#r=`${this.#r} M ${e} ${t} Z`,this.#r;if(this.#i.length<=6){const n=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,n)} M ${e} ${t}`,this.#a=6}if(this.#i.length===4){const n=X.svgRound(this.#t[10]),i=X.svgRound(this.#t[11]);return this.#r=`${this.#r} L ${n} ${i}`,this.#a=12,this.#r}const s=[];this.#a===0&&(s.push(`M ${e} ${t}`),this.#a=6);for(let n=this.#a,i=this.#t.length;n<i;n+=6){const[o,a,l,c,d,u]=this.#t.slice(n,n+6).map(X.svgRound);s.push(`C${o} ${a} ${l} ${c} ${d} ${u}`)}return this.#r+=s.join(" "),this.#a=this.#t.length,this.#r}getOutlines(e,t,s,n){const i=this.#n.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#c.build(this.#n,e,t,s,this.#s,this.#o,n),this.#e=null,this.#t=null,this.#n=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class kn extends X{#e;#t=0;#n;#s;#o;#i;#r;#a;#c;build(e,t,s,n,i,o,a){this.#o=t,this.#i=s,this.#r=n,this.#a=i,this.#c=o,this.#n=a??0,this.#s=e,this.#u()}get thickness(){return this.#c}setLastElement(e){return this.#s.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#s){if(e.push(`M${X.svgRound(t[4])} ${X.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${X.svgRound(t[10])} ${X.svgRound(t[11])}`);continue}for(let s=6,n=t.length;s<n;s+=6){const[i,o,a,l,c,d]=t.subarray(s,s+6).map(X.svgRound);e.push(`C${i} ${o} ${a} ${l} ${c} ${d}`)}}return e.join("")}serialize([e,t,s,n],i){const o=[],a=[],[l,c,d,u]=this.#h();let h,f,p,g,m,v,_,w,x;switch(this.#a){case 0:x=X._rescale,h=e,f=t+n,p=s,g=-n,m=e+l*s,v=t+(1-c-u)*n,_=e+(l+d)*s,w=t+(1-c)*n;break;case 90:x=X._rescaleAndSwap,h=e,f=t,p=s,g=n,m=e+c*s,v=t+l*n,_=e+(c+u)*s,w=t+(l+d)*n;break;case 180:x=X._rescale,h=e+s,f=t,p=-s,g=n,m=e+(1-l-d)*s,v=t+c*n,_=e+(1-l)*s,w=t+(c+u)*n;break;case 270:x=X._rescaleAndSwap,h=e+s,f=t+n,p=-s,g=-n,m=e+(1-c-u)*s,v=t+(1-l-d)*n,_=e+(1-c)*s,w=t+(1-l)*n;break}for(const{line:S,points:b}of this.#s)o.push(x(S,h,f,p,g,i?new Array(S.length):null)),a.push(x(b,h,f,p,g,i?new Array(b.length):null));return{lines:o,points:a,rect:[m,v,_,w]}}static deserialize(e,t,s,n,i,{paths:{lines:o,points:a},rotation:l,thickness:c}){const d=[];let u,h,f,p,g;switch(l){case 0:g=X._rescale,u=-e/s,h=t/n+1,f=1/s,p=-1/n;break;case 90:g=X._rescaleAndSwap,u=-t/n,h=-e/s,f=1/n,p=1/s;break;case 180:g=X._rescale,u=e/s+1,h=-t/n,f=-1/s,p=1/n;break;case 270:g=X._rescaleAndSwap,u=t/n+1,h=e/s+1,f=-1/n,p=-1/s;break}if(!o){o=[];for(const v of a){const _=v.length;if(_===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(_===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const w=new Float32Array(3*(_-2));o.push(w);let[x,S,b,A]=v.subarray(0,4);w.set([NaN,NaN,NaN,NaN,x,S],0);for(let E=4;E<_;E+=2){const C=v[E],k=v[E+1];w.set(X.createBezierPoints(x,S,b,A,C,k),(E-2)*3),[x,S,b,A]=[b,A,C,k]}}}for(let v=0,_=o.length;v<_;v++)d.push({line:g(o[v].map(w=>w??NaN),u,h,f,p),points:g(a[v].map(w=>w??NaN),u,h,f,p)});const m=new this.prototype.constructor;return m.build(d,s,n,1,l,c,i),m}#l(e=this.#c){const t=this.#n+e/2*this.#r;return this.#a%180===0?[t/this.#o,t/this.#i]:[t/this.#i,t/this.#o]}#h(){const[e,t,s,n]=this.#e,[i,o]=this.#l(0);return[e+i,t+o,s-2*i,n-2*o]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#s){if(n.length<=12){for(let a=4,l=n.length;a<l;a+=6)K.pointBoundingBox(n[a],n[a+1],e);continue}let i=n[4],o=n[5];for(let a=6,l=n.length;a<l;a+=6){const[c,d,u,h,f,p]=n.subarray(a,a+6);K.bezierBoundingBox(i,o,c,d,u,h,f,p,e),i=f,o=p}}const[t,s]=this.#l();e[0]=He(e[0]-t,0,1),e[1]=He(e[1]-s,0,1),e[2]=He(e[2]+t,0,1),e[3]=He(e[3]+s,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,s]=this.#l();this.#c=e;const[n,i]=this.#l(),[o,a]=[n-t,i-s],l=this.#e;return l[0]-=o,l[1]-=a,l[2]+=2*o,l[3]+=2*a,l}updateParentDimensions([e,t],s){const[n,i]=this.#l();this.#o=e,this.#i=t,this.#r=s;const[o,a]=this.#l(),l=o-n,c=a-i,d=this.#e;return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(X.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${X.svgRound(e)} ${X.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,n=0,i=0,o=0,a=0,l=0;switch(this.#t){case 90:n=t/e,i=-e/t,a=e;break;case 180:s=-1,o=-1,a=e,l=t;break;case 270:n=-t/e,i=e/t,l=t;break;default:return""}return`matrix(${s} ${n} ${i} ${o} ${X.svgRound(a)} ${X.svgRound(l)})`}getPathResizingSVGProperties([e,t,s,n]){const[i,o]=this.#l(),[a,l,c,d]=this.#e;if(Math.abs(c-i)<=X.PRECISION||Math.abs(d-o)<=X.PRECISION){const g=e+s/2-(a+c/2),m=t+n/2-(l+d/2);return{path:{"transform-origin":`${X.svgRound(e)} ${X.svgRound(t)}`,transform:`${this.rotationTransform} translate(${g} ${m})`}}}const u=(s-2*i)/(c-2*i),h=(n-2*o)/(d-2*o),f=c/s,p=d/n;return{path:{"transform-origin":`${X.svgRound(a)} ${X.svgRound(l)}`,transform:`${this.rotationTransform} scale(${f} ${p}) translate(${X.svgRound(i)} ${X.svgRound(o)}) scale(${u} ${h}) translate(${X.svgRound(-i)} ${X.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,s,n]){const[i,o]=this.#l(),a=this.#e,[l,c,d,u]=a;if(a[0]=e,a[1]=t,a[2]=s,a[3]=n,Math.abs(d-i)<=X.PRECISION||Math.abs(u-o)<=X.PRECISION){const m=e+s/2-(l+d/2),v=t+n/2-(c+u/2);for(const{line:_,points:w}of this.#s)X._translate(_,m,v,_),X._translate(w,m,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${X.svgRound(e)} ${X.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const h=(s-2*i)/(d-2*i),f=(n-2*o)/(u-2*o),p=-h*(l+i)+e+i,g=-f*(c+o)+t+o;if(h!==1||f!==1||p!==0||g!==0)for(const{line:m,points:v}of this.#s)X._rescale(m,p,g,h,f,m),X._rescale(v,p,g,h,f,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${X.svgRound(e)} ${X.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[n,i]=s,o=this.#e,a=e-o[0],l=t-o[1];if(this.#o===n&&this.#i===i)for(const{line:c,points:d}of this.#s)X._translate(c,a,l,c),X._translate(d,a,l,d);else{const c=this.#o/n,d=this.#i/i;this.#o=n,this.#i=i;for(const{line:u,points:h}of this.#s)X._rescale(u,a,l,c,d,u),X._rescale(h,a,l,c,d,h);o[2]*=c,o[3]*=d}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${X.svgRound(e)} ${X.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${X.svgRound(e[0])} ${X.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class ki extends Zc{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Q._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new ki(this._viewParameters);return e.updateAll(this),e}}class Co extends se{static _type="ink";static _editorType=re.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Q.initialize(e,t),this._defaultDrawingOptions=new ki(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return ae(this,"typesMap",new Map([[ue.INK_THICKNESS,"stroke-width"],[ue.INK_COLOR,"stroke"],[ue.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,n,i){return new Pb(e,t,s,n,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,n,i,o){return kn.deserialize(e,t,s,n,i,o)}static async deserialize(e,t,s){let n=null;if(e instanceof xo){const{data:{inkLists:o,rect:a,rotation:l,id:c,color:d,opacity:u,borderStyle:{rawWidth:h},popupRef:f,richText:p,contentsObj:g,creationDate:m,modificationDate:v},parent:{page:{pageNumber:_}}}=e;n=e={annotationType:re.INK,color:Array.from(d),thickness:h,opacity:u,paths:{points:o},boxes:null,pageIndex:_-1,rect:a.slice(0),rotation:l,annotationElementId:c,id:c,deleted:!1,popupRef:f,richText:p,comment:g?.str||null,creationDate:m,modificationDate:v}}const i=await super.deserialize(e,t,s);return i._initialData=n,e.comment&&i.setCommentData(e),i}get toolbarButtons(){return this._colorPicker||=new pn(this),[["colorPicker",this._colorPicker]]}get colorType(){return ue.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Co.getDefaultDrawingOptions({stroke:K.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s}=this.serializeDraw(e),{_drawingOptions:{stroke:n,"stroke-opacity":i,"stroke-width":o}}=this,a=Object.assign(super.serialize(e),{color:Q._colorManager.convert(n),opacity:i,thickness:o,paths:{lines:t,points:s}});return this.addComment(a),e?(a.isCopy=!0,a):this.annotationElementId&&!this.#e(a)?null:(a.id=this.annotationElementId,a)}#e(e){const{color:t,thickness:s,opacity:n,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,a)=>o!==t[a])||e.thickness!==s||e.opacity!==n||e.pageIndex!==i}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class Nr extends kn{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Gn=8,Zs=3;class Es{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,s,n){return s-=e,n-=t,s===0?n>0?0:4:s===1?n+6:2-n}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#s(e,t,s,n,i,o,a){const l=this.#t(s,n,i,o);for(let c=0;c<8;c++){const d=(-c+l-a+16)%8,u=this.#n[2*d],h=this.#n[2*d+1];if(e[(s+u)*t+(n+h)]!==0)return d}return-1}static#o(e,t,s,n,i,o,a){const l=this.#t(s,n,i,o);for(let c=0;c<8;c++){const d=(c+l+a+16)%8,u=this.#n[2*d],h=this.#n[2*d+1];if(e[(s+u)*t+(n+h)]!==0)return d}return-1}static#i(e,t,s,n){const i=e.length,o=new Int32Array(i);for(let d=0;d<i;d++)o[d]=e[d]<=n?1:0;for(let d=1;d<s-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*s-1-d]=0;let a=1,l;const c=[];for(let d=1;d<s-1;d++){l=1;for(let u=1;u<t-1;u++){const h=d*t+u,f=o[h];if(f===0)continue;let p=d,g=u;if(f===1&&o[h-1]===0)a+=1,g-=1;else if(f>=1&&o[h+1]===0)a+=1,g+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const m=[u,d],v=g===u+1,_={isHole:v,points:m,id:a,parent:0};c.push(_);let w;for(const D of c)if(D.id===l){w=D;break}w?w.isHole?_.parent=v?w.parent:l:_.parent=v?l:w.parent:_.parent=v?l:0;const x=this.#s(o,t,d,u,p,g,0);if(x===-1){o[h]=-a,o[h]!==1&&(l=Math.abs(o[h]));continue}let S=this.#n[2*x],b=this.#n[2*x+1];const A=d+S,E=u+b;p=A,g=E;let C=d,k=u;for(;;){const D=this.#o(o,t,C,k,p,g,1);S=this.#n[2*D],b=this.#n[2*D+1];const q=C+S,Y=k+b;m.push(Y,q);const F=C*t+k;if(o[F+1]===0?o[F]=-a:o[F]===1&&(o[F]=a),q===d&&Y===u&&C===A&&k===E){o[h]!==1&&(l=Math.abs(o[h]));break}else p=C,g=k,C=q,k=Y}}}return c}static#r(e,t,s,n){if(s-t<=4){for(let A=t;A<s-2;A+=2)n.push(e[A],e[A+1]);return}const i=e[t],o=e[t+1],a=e[s-4]-i,l=e[s-3]-o,c=Math.hypot(a,l),d=a/c,u=l/c,h=d*o-u*i,f=l/a,p=1/c,g=Math.atan(f),m=Math.cos(g),v=Math.sin(g),_=p*(Math.abs(m)+Math.abs(v)),w=p*(1-_+_**2),x=Math.max(Math.atan(Math.abs(v+m)*w),Math.atan(Math.abs(v-m)*w));let S=0,b=t;for(let A=t+2;A<s-2;A+=2){const E=Math.abs(h-d*e[A+1]+u*e[A]);E>S&&(b=A,S=E)}S>(c*x)**2?(this.#r(e,t,b+2,n),this.#r(e,b,s,n)):n.push(i,o)}static#a(e){const t=[],s=e.length;return this.#r(e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t}static#c(e,t,s,n,i,o){const a=new Float32Array(o**2),l=-2*n**2,c=o>>1;for(let g=0;g<o;g++){const m=(g-c)**2;for(let v=0;v<o;v++)a[g*o+v]=Math.exp((m+(v-c)**2)/l)}const d=new Float32Array(256),u=-2*i**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/u);const h=e.length,f=new Uint8Array(h),p=new Uint32Array(256);for(let g=0;g<s;g++)for(let m=0;m<t;m++){const v=g*t+m,_=e[v];let w=0,x=0;for(let b=0;b<o;b++){const A=g+b-c;if(!(A<0||A>=s))for(let E=0;E<o;E++){const C=m+E-c;if(C<0||C>=t)continue;const k=e[A*t+C],D=a[b*o+E]*d[Math.abs(k-_)];w+=k*D,x+=D}}const S=f[v]=Math.round(w/x);p[S]++}return[f,p]}static#l(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t}static#h(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let n=-1/0,i=1/0;for(let a=0,l=s.length;a<l;a++){const c=s[a]=e[a<<2];n=Math.max(n,c),i=Math.min(i,c)}const o=255/(n-i);for(let a=0,l=s.length;a<l;a++)s[a]=(s[a]-i)*o;return s}static#u(e){let t,s=-1/0,n=-1/0;const i=e.findIndex(l=>l!==0);let o=i,a=i;for(t=i;t<256;t++){const l=e[t];l>s&&(t-o>n&&(n=t-o,a=t-1),s=l,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:s,height:n}=e,{maxDim:i}=this.#e;let o=s,a=n;if(s>i||n>i){let h=s,f=n,p=Math.log2(Math.max(s,n)/i);const g=Math.floor(p);p=p===g?g-1:g;for(let v=0;v<p;v++){o=Math.ceil(h/2),a=Math.ceil(f/2);const _=new OffscreenCanvas(o,a);_.getContext("2d").drawImage(e,0,0,h,f,0,0,o,a),h=o,f=a,e!==t&&e.close(),e=_.transferToImageBitmap()}const m=Math.min(i/o,i/a);o=Math.round(o*m),a=Math.round(a*m)}const c=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,o,a),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=c.getImageData(0,0,o,a).data;return[this.#h(d),o,a]}static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:n},i,o,a,l){let c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const u=200,h=d.font=`${s} ${n} ${u}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:p,actualBoundingBoxAscent:g,actualBoundingBoxDescent:m,fontBoundingBoxAscent:v,fontBoundingBoxDescent:_,width:w}=d.measureText(e),x=1.5,S=Math.ceil(Math.max(Math.abs(f)+Math.abs(p)||0,w)*x),b=Math.ceil(Math.max(Math.abs(g)+Math.abs(m)||u,Math.abs(v)+Math.abs(_)||u)*x);c=new OffscreenCanvas(S,b),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=h,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,S,b),d.fillStyle="black",d.fillText(e,S*(x-1)/2,b*(3-x)/2);const A=this.#h(d.getImageData(0,0,S,b).data),E=this.#l(A),C=this.#u(E),k=this.#i(A,S,b,C);return this.processDrawnLines({lines:{curves:k,width:S,height:b},pageWidth:i,pageHeight:o,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,s,n,i){const[o,a,l]=this.#f(e),[c,d]=this.#c(o,a,l,Math.hypot(a,l)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),u=this.#u(d),h=this.#i(c,a,l,u);return this.processDrawnLines({lines:{curves:h,width:a,height:l},pageWidth:t,pageHeight:s,rotation:n,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:n,innerMargin:i,mustSmooth:o,areContours:a}){n%180!==0&&([t,s]=[s,t]);const{curves:l,width:c,height:d}=e,u=e.thickness??0,h=[],f=Math.min(t/c,s/d),p=f/t,g=f/s,m=[];for(const{points:_}of l){const w=o?this.#a(_):_;if(!w)continue;m.push(w);const x=w.length,S=new Float32Array(x),b=new Float32Array(3*(x===2?2:x-2));if(h.push({line:b,points:S}),x===2){S[0]=w[0]*p,S[1]=w[1]*g,b.set([NaN,NaN,NaN,NaN,S[0],S[1]],0);continue}let[A,E,C,k]=w;A*=p,E*=g,C*=p,k*=g,S.set([A,E,C,k],0),b.set([NaN,NaN,NaN,NaN,A,E],0);for(let D=4;D<x;D+=2){const q=S[D]=w[D]*p,Y=S[D+1]=w[D+1]*g;b.set(X.createBezierPoints(A,E,C,k,q,Y),(D-2)*3),[A,E,C,k]=[C,k,q,Y]}}if(h.length===0)return null;const v=a?new Nr:new kn;return v.build(h,t,s,1,n,a?0:u,i),{outline:v,newCurves:m,areContours:a,thickness:u,width:c,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:n,height:i}){let o=1/0,a=-1/0,l=0;for(const w of e){l+=w.length;for(let x=2,S=w.length;x<S;x++){const b=w[x]-w[x-2];o=Math.min(o,b),a=Math.max(a,b)}}let c;o>=-128&&a<=127?c=Int8Array:o>=-32768&&a<=32767?c=Int16Array:c=Int32Array;const d=e.length,u=Gn+Zs*d,h=new Uint32Array(u);let f=0;h[f++]=u*Uint32Array.BYTES_PER_ELEMENT+(l-2*d)*c.BYTES_PER_ELEMENT,h[f++]=0,h[f++]=n,h[f++]=i,h[f++]=t?0:1,h[f++]=Math.max(0,Math.floor(s??0)),h[f++]=d,h[f++]=c.BYTES_PER_ELEMENT;for(const w of e)h[f++]=w.length-2,h[f++]=w[0],h[f++]=w[1];const p=new CompressionStream("deflate-raw"),g=p.writable.getWriter();await g.ready,g.write(h);const m=c.prototype.constructor;for(const w of e){const x=new m(w.length-2);for(let S=2,b=w.length;S<b;S++)x[S-2]=w[S]-w[S-2];g.write(x)}g.close();const v=await new Response(p.readable).arrayBuffer(),_=new Uint8Array(v);return xc(_)}static async decompressSignature(e){try{const t=Vy(e),{readable:s,writable:n}=new DecompressionStream("deflate-raw"),i=n.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,a=0;for await(const w of s)o||=new Uint8Array(new Uint32Array(w.buffer,0,4)[0]),o.set(w,a),a+=w.length;const l=new Uint32Array(o.buffer,0,o.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const d=l[2],u=l[3],h=l[4]===0,f=l[5],p=l[6],g=l[7],m=[],v=(Gn+Zs*p)*Uint32Array.BYTES_PER_ELEMENT;let _;switch(g){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(o.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(o.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(o.buffer,v);break}a=0;for(let w=0;w<p;w++){const x=l[Zs*w+Gn],S=new Float32Array(x+2);m.push(S);for(let b=0;b<Zs-1;b++)S[b]=l[Zs*w+Gn+b+1];for(let b=0;b<x;b++)S[b+2]=S[b]+_[a++]}return{areContours:h,thickness:f,outlines:m,width:d,height:u}}catch(t){return ie(`decompressSignature: ${t}`),null}}}class Eo extends Zc{constructor(){super(),super.updateProperties({fill:Q._defaultLineColor,"stroke-width":0})}clone(){const e=new Eo;return e.updateAll(this),e}}class To extends ki{constructor(e){super(e),super.updateProperties({stroke:Q._defaultLineColor,"stroke-width":1})}clone(){const e=new To(this._viewParameters);return e.updateAll(this),e}}class xt extends se{#e=!1;#t=null;#n=null;#s=null;static _type="signature";static _editorType=re.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Q.initialize(e,t),this._defaultDrawingOptions=new Eo,this._defaultDrawnSignatureOptions=new To(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return ae(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:n,mustSmooth:i,areContours:o,description:a,uuid:l,heightInPage:c}=this.#n,{rawDims:{pageWidth:d,pageHeight:u},rotation:h}=this.parent.viewport,f=Es.processDrawnLines({lines:n,pageWidth:d,pageHeight:u,rotation:h,innerMargin:xt._INNER_MARGIN,mustSmooth:i,areContours:o});this.addSignature(f,c,a,l)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#s=e,this.addEditToolbar()}getUuid(){return this.#s}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:s,width:n,height:i}=this.#n,o=Math.max(n,i),a=Es.processDrawnLines({lines:{curves:e.map(l=>({points:l})),thickness:s,width:n,height:i},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:a.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,s,n){const{x:i,y:o}=this,{outline:a}=this.#n=e;this.#e=a instanceof Nr,this.description=s;let l;this.#e?l=xt.getDefaultDrawingOptions():(l=xt._defaultDrawnSignatureOptions.clone(),l.updateProperties({"stroke-width":a.thickness})),this._addOutlines({drawOutlines:a,drawingOptions:l});const[,c]=this.pageDimensions;let d=t/c;d=d>=1?.5:d,this.width*=d/this.height,this.width>=1&&(d*=.9/this.width,this.width=.9),this.height=d,this.setDims(),this.x=i,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(n),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!n,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:n}=this.parent.viewport;return Es.process(e,t,s,n,xt._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:s,pageHeight:n},rotation:i}=this.parent.viewport;return Es.extractContoursFromText(e,t,s,n,i,xt._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:n}=this.parent.viewport;return Es.processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:n,innerMargin:xt._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=xt.getDefaultDrawingOptions():(this._drawingOptions=xt._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:s}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":n}}=this,i=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:n});return this.addComment(i),e?(i.paths={lines:t,points:s},i.uuid=this.#s,i.isCopy=!0):i.lines=t,this.#t&&(i.accessibilityData={type:"Figure",alt:this.#t}),i}static deserializeDraw(e,t,s,n,i,o){return o.areContours?Nr.deserialize(e,t,s,n,i,o):kn.deserialize(e,t,s,n,i,o)}static async deserialize(e,t,s){const n=await super.deserialize(e,t,s);return n.#e=e.areContours,n.description=e.accessibilityData?.alt||"",n.#s=e.uuid,n}}class Mb extends Q{#e=null;#t=null;#n=null;#s=null;#o=null;#i="";#r=null;#a=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=re.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#s=e.bitmapUrl,this.#o=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Q.initialize(e,t)}static isHandlingMimeForPasting(e){return Pr.includes(e)}static paste(e,t){t.pasteEditor({mode:re.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#i=e.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:i,height:o}=e||this.copyCanvas(null,null,!0).imageData,a=await s.guess({name:"altText",request:{data:n,width:i,height:o,channels:n.length/(i*o)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const l=a.output;return await this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#u(s,!0)).finally(()=>this.#f());return}if(this.#s){const s=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(n=>this.#u(n)).finally(()=>this.#f());return}if(this.#o){const s=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(n=>this.#u(n)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Pr.join(",");const t=this._uiManager._signal;this.#n=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(n)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#s||this.#o||this.#t||this.#a)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#a||(this.#e?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:s,bitmap:n}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#t=s,n&&(this.#e=n),this.#a=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},e)}#p(){const{div:e}=this;let{width:t,height:s}=this.#e;const[n,i]=this.pageDimensions,o=.75;if(this.width)t=this.width*n,s=this.height*i;else if(t>o*n||s>o*i){const l=Math.min(o*n/t,o*i/s);t*=l,s*=l}this._uiManager.enableWaiting(!1);const a=this.#r=document.createElement("canvas");a.setAttribute("role","img"),this.addContainer(a),this.width=t/n,this.height=s/i,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,s=!1){e||(e=224);const{width:n,height:i}=this.#e,o=new Pt;let a=this.#e,l=n,c=i,d=null;if(t){if(n>t||i>t){const b=Math.min(t/n,t/i);l=Math.floor(n*b),c=Math.floor(i*b)}d=document.createElement("canvas");const h=d.width=Math.ceil(l*o.sx),f=d.height=Math.ceil(c*o.sy);this.#l||(a=this.#d(h,f));const p=d.getContext("2d");p.filter=this._uiManager.hcmFilter;let g="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":Zy.isDarkMode&&(g="#8f8f9d",m="#42414d");const v=15,_=v*o.sx,w=v*o.sy,x=new OffscreenCanvas(_*2,w*2),S=x.getContext("2d");S.fillStyle=g,S.fillRect(0,0,_*2,w*2),S.fillStyle=m,S.fillRect(0,0,_,w),S.fillRect(_,w,_,w),p.fillStyle=p.createPattern(x,"repeat"),p.fillRect(0,0,h,f),p.drawImage(a,0,0,a.width,a.height,0,0,h,f)}let u=null;if(s){let h,f;if(o.symmetric&&a.width<e&&a.height<e)h=a.width,f=a.height;else if(a=this.#e,n>e||i>e){const m=Math.min(e/n,e/i);h=Math.floor(n*m),f=Math.floor(i*m),this.#l||(a=this.#d(h,f))}const g=new OffscreenCanvas(h,f).getContext("2d",{willReadFrequently:!0});g.drawImage(a,0,0,a.width,a.height,0,0,h,f),u={width:h,height:f,data:g.getImageData(0,0,h,f).data}}return{canvas:d,width:l,height:c,imageData:u}}#d(e,t){const{width:s,height:n}=this.#e;let i=s,o=n,a=this.#e;for(;i>2*e||o>2*t;){const l=i,c=o;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(i,o);d.getContext("2d").drawImage(a,0,0,l,c,0,0,i,o),a=d.transferToImageBitmap()}return a}#g(){const[e,t]=this.parentDimensions,{width:s,height:n}=this,i=new Pt,o=Math.ceil(s*e*i.sx),a=Math.ceil(n*t*i.sy),l=this.#r;if(!l||l.width===o&&l.height===a)return;l.width=o,l.height=a;const c=this.#l?this.#e:this.#d(o,a),d=l.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(c,0,0,c.width,c.height,0,0,o,a)}#y(e){if(e){if(this.#l){const n=this._uiManager.imageManager.getSvgUrl(this.#t);if(n)return n}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,s]=this.pageDimensions,n=Math.round(this.width*t*Ns.PDF_TO_CSS_UNITS),i=Math.round(this.height*s*Ns.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,i);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,n,i),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,s){let n=null,i=!1;if(e instanceof Yc){const{data:{rect:g,rotation:m,id:v,structParent:_,popupRef:w,richText:x,contentsObj:S,creationDate:b,modificationDate:A},container:E,parent:{page:{pageNumber:C}},canvas:k}=e;let D,q;k?(delete e.canvas,{id:D,bitmap:q}=s.imageManager.getFromCanvas(E.id,k),k.remove()):(i=!0,e._hasNoCanvas=!0);const Y=(await t._structTree.getAriaAttributes(`${ho}${v}`))?.get("aria-label")||"";n=e={annotationType:re.STAMP,bitmapId:D,bitmap:q,pageIndex:C-1,rect:g.slice(0),rotation:m,annotationElementId:v,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:Y},isSvg:!1,structParent:_,popupRef:w,richText:x,comment:S?.str||null,creationDate:b,modificationDate:A}}const o=await super.deserialize(e,t,s),{rect:a,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:u,accessibilityData:h}=e;i?(s.addMissingCanvas(e.id,o),o.#a=!0):d&&s.imageManager.isValidId(d)?(o.#t=d,l&&(o.#e=l)):o.#s=c,o.#l=u;const[f,p]=o.pageDimensions;return o.width=(a[2]-a[0])/f,o.height=(a[3]-a[1])/p,h&&(o.altTextData=h),o._initialData=n,e.comment&&o.setCommentData(e),o.#h=!!n,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(s),e)return s.bitmapUrl=this.#y(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:n,altText:i}=this.serializeAltText(!1);if(!n&&i&&(s.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const a=this.#b(s);return a.isSame?null:(a.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(t===null)return s;t.stamps||=new Map;const o=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:s}),s.bitmap=this.#y(!1);else if(this.#l){const a=t.stamps.get(this.#t);o>a.area&&(a.area=o,a.serialized.bitmap.close(),a.serialized.bitmap=this.#y(!1))}return s}#b(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,n=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&n&&i,isSameAltText:i}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Lt{#e;#t=!1;#n=null;#s=null;#o=null;#i=new Map;#r=!1;#a=!1;#c=!1;#l=null;#h=null;#u=null;#f=null;#m=null;#p=-1;#d;static _initialized=!1;static#g=new Map([Ie,Co,Mb,Ee,xt].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:n,accessibilityManager:i,annotationLayer:o,drawLayer:a,textLayer:l,viewport:c,l10n:d}){const u=[...Lt.#g.values()];if(!Lt._initialized){Lt._initialized=!0;for(const h of u)h.initialize(d,e)}e.registerEditorTypes(u),this.#d=e,this.pageIndex=t,this.div=s,this.#e=i,this.#n=o,this.viewport=c,this.#u=l,this.drawLayer=a,this._structTree=n,this.#d.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#d.getMode()===re.NONE}updateToolbar(e){this.#d.updateToolbar(e)}updateMode(e=this.#d.getMode()){switch(this.#w(),e){case re.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case re.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case re.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===re.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of Lt.#g.values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#d.setEditingState(e)}addCommands(e){this.#d.addCommands(e)}cleanUndoStack(e){this.#d.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}get#y(){return this.#i.size!==0?this.#i.values():this.#d.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const s of this.#y)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#d.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=this.#n;if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),this.#d.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}this.#c=!1,this.#d._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const s=this.#d.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",n=>{const{clientX:o,clientY:a,timeStamp:l}=n,c=this.#p;if(l-c>500){this.#p=l;return}this.#p=-1;const{classList:d}=this.div;d.toggle("getElements",!0);const u=document.elementsFromPoint(o,a);if(d.toggle("getElements",!1),!this.div.contains(u[0]))return;let h;const f=new RegExp(`^${dn}[0-9]+$`);for(const g of u)if(f.test(g.id)){h=g.id;break}if(!h)return;const p=this.#i.get(h);p?.annotationElementId===null&&(n.stopPropagation(),n.preventDefault(),p.dblclick(n))},{signal:s,capture:!0})}const e=this.#n;if(e){const s=new Map,n=new Map;for(const o of this.#y){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(e);continue}if(o.serialize()!==null){s.set(o.annotationElementId,o);continue}else n.set(o.annotationElementId,o);this.getEditableAnnotation(o.annotationElementId)?.show(),o.remove()}const i=e.getEditableAnnotations();for(const o of i){const{id:a}=o.data;if(this.#d.isDeletedAnnotationElement(a)){o.updateEdited({deleted:!0});continue}let l=n.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=s.get(a),l&&(this.#d.addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const s of Lt.#g.values())t.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#a=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#d.getActive()!==e&&this.#d.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#d.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(e){this.#d.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:s}=Fe.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#d.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Ee.startHighlighting(this,this.#d.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#d._signal}),e.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;const e=this.#d.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#s?.abort(),this.#s=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#d.isDeletedAnnotationElement(t)&&this.#d.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#a&&e.annotationElementId&&this.#d.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#d.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#d.addDeletedAnnotationElement(e.annotationElementId),Q.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#d.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#d.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#o&&(e._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#d._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of this.#i.values())if(t.uid===e)return t;return null}getNextId(){return this.#d.getId()}get#v(){return Lt.#g.get(this.#d.getMode())}combinedSignal(e){return this.#d.combinedSignal(e)}#C(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#d.updateMode(e.mode);const{offsetX:s,offsetY:n}=this.#x(),i=this.getNextId(),o=this.#C({parent:this,id:i,x:s,y:n,uiManager:this.#d,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Lt.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#d)||null}createAndAddNewEditor(e,t,s={}){const n=this.getNextId(),i=this.#C({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#d,isCentered:t,...s});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}#x(){const{x:e,y:t,width:s,height:n}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+n),c=(i+a)/2-e,d=(o+l)/2-t,[u,h]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:u,offsetY:h}}addNewEditor(e={}){this.createAndAddNewEditor(this.#x(),!0,e)}setSelected(e){this.#d.setSelected(e)}toggleSelected(e){this.#d.toggleSelected(e)}unselect(e){this.#d.unselect(e)}pointerup(e){const{isMac:t}=Fe.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#r||(this.#r=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const s=this.#d.getMode();if(s===re.STAMP||s===re.SIGNATURE){this.#d.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#d.getMode()===re.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:t}=Fe.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#r=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const s=this.#d.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#d,!1,e);return}this.#d.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#d.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#d,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#d.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#v.endDrawing(e)):null}findNewParent(e,t,s){const n=this.#d.findParent(t,s);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#d.getActive()?.parent===this&&(this.#d.commitOrRemove(),this.#d.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#d.removeLayer(this)}#w(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,us(this.div,e);for(const t of this.#d.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#d.commitOrRemove(),this.#w();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,us(this.div,{rotation:s}),t!==s)for(const n of this.#i.values())n.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#d.viewParameters.realScale}}class Oe{#e=null;#t=new Map;#n=new Map;static#s=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return ae(this,"_svgFactory",new ci)}static#o(e,[t,s,n,i]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*n}%`,o.height=`${100*i}%`}#i(){const e=Oe._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#r(e,t){const s=Oe._svgFactory.createElement("clipPath");e.append(s);const n=`clip_${t}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const i=Oe._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),n}#a(e,t){for(const[s,n]of Object.entries(t))n===null?e.removeAttribute(s):e.setAttribute(s,n)}draw(e,t=!1,s=!1){const n=Oe.#s++,i=this.#i(),o=Oe._svgFactory.createElement("defs");i.append(o);const a=Oe._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${n}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(n,a);const c=s?this.#r(o,l):null,d=Oe._svgFactory.createElement("use");return i.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(i,e),this.#t.set(n,i),{id:n,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=Oe.#s++,n=this.#i(),i=Oe._svgFactory.createElement("defs");n.append(i);const o=Oe._svgFactory.createElement("path");i.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const u=Oe._svgFactory.createElement("mask");i.append(u),l=`mask_p${this.pageIndex}_${s}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const h=Oe._svgFactory.createElement("rect");u.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const f=Oe._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${a}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=Oe._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${a}`),l&&c.setAttribute("mask",`url(#${l})`);const d=c.cloneNode();return n.append(d),c.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(n,e),this.#t.set(s,n),s}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:n,rootClass:i,path:o}=t,a=typeof e=="number"?this.#t.get(e):e;if(a){if(s&&this.#a(a,s),n&&Oe.#o(a,n),i){const{classList:l}=a;for(const[c,d]of Object.entries(i))l.toggle(c,d)}if(o){const c=a.firstChild.firstChild;this.#a(c,o)}}}updateParent(e,t){if(t===this)return;const s=this.#t.get(e);s&&(t.#e.append(s),this.#t.delete(e),t.#t.set(e,s))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Fr};globalThis.pdfjsLib={AbortException:es,AnnotationEditorLayer:Lt,AnnotationEditorParamsType:ue,AnnotationEditorType:re,AnnotationEditorUIManager:ts,AnnotationLayer:So,AnnotationMode:Gt,AnnotationType:Pe,applyOpacity:Qy,build:ob,ColorPicker:at,createValidAbsoluteUrl:bc,CSSConstants:Jy,DOMSVGFactory:ci,DrawLayer:Oe,FeatureTest:Fe,fetchData:xn,findContrastColor:ev,getDocument:Hc,getFilenameFromUrl:Wy,getPdfFilenameFromUrl:Gy,getRGB:Cn,getUuid:Ac,getXfaPageViewport:Yy,GlobalWorkerOptions:Os,ImageKind:Zn,InvalidPDFException:Tr,isDataScheme:Ci,isPdfFile:po,isValidExplicitDest:dv,MathClamp:He,noContextMenu:lt,normalizeUnicode:Uy,OPS:un,OutputScale:Pt,PasswordResponses:Oy,PDFDataRangeTransport:zc,PDFDateString:kr,PDFWorker:fn,PermissionFlag:Ry,PixelsPerInch:Ns,RenderingCancelledException:fo,renderRichText:Cc,ResponseException:ai,setLayerDimensions:us,shadow:ae,SignatureExtractor:Es,stopEvent:Ce,SupportedImageMimeTypes:Pr,TextLayer:$e,TouchManager:Ei,updateUrlHash:wc,Util:K,VerbosityLevel:Ai,version:rb,XfaLayer:Sc};const Db="/jrtech-infra-annotator/assets/pdf.worker-9aISQa3R.mjs";Os.workerSrc=Db;const Pi=vn("image",()=>{const r=U(null),e=U(new Image),t=async i=>{i.type==="application/pdf"?await n(i):await s(i)},s=i=>new Promise((o,a)=>{const l=new FileReader;l.onload=()=>{r.value=l.result,e.value.src=r.value,e.value.onload=()=>o(),e.value.onerror=a},l.onerror=a,l.readAsDataURL(i)}),n=async i=>{const o=await i.arrayBuffer(),l=await(await Hc({data:o}).promise).getPage(1),c=l.getViewport({scale:2}),d=document.createElement("canvas"),u=d.getContext("2d");d.width=c.width,d.height=c.height,await l.render({canvasContext:u,viewport:c,canvas:d}).promise,r.value=d.toDataURL("image/png"),e.value.src=r.value,await new Promise((h,f)=>{e.value.onload=()=>h(),e.value.onerror=f})};return{uploadedImageUrl:r,image:e,uploadImage:t}}),Yt=[{fill:"rgba(34,197,94,0.2)",stroke:"#22c55e",text:"#15803d"},{fill:"rgba(59,130,246,0.2)",stroke:"#3b82f6",text:"#1d4ed8"},{fill:"rgba(168,85,247,0.2)",stroke:"#a855f7",text:"#7c3aed"},{fill:"rgba(234,179,8,0.2)",stroke:"#eab308",text:"#a16207"},{fill:"rgba(239,68,68,0.2)",stroke:"#ef4444",text:"#dc2626"}];function Ib(r,e,t,s){if(!s||t.length<3)return!0;let n=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const a=t[i].x,l=t[i].y,c=t[o].x,d=t[o].y;l>e!=d>e&&r<(c-a)*(e-l)/(d-l)+a&&(n=!n)}return n}function Rb(r,e,t,s){if(!s||t.length<3)return 1e3;let n=1/0;for(let i=0;i<t.length;i++){const o=t[i],a=t[(i+1)%t.length],l=Ob(r,e,o.x,o.y,a.x,a.y);n=Math.min(n,l)}return n}function Ob(r,e,t,s,n,i){const o=n-t,a=i-s,l=Math.hypot(o,a);if(l===0)return Math.hypot(r-t,e-s);const c=Math.max(0,Math.min(1,((r-t)*o+(e-s)*a)/(l*l))),d=t+c*o,u=s+c*a;return Math.hypot(r-d,e-u)}function Lb(r,e,t,s){const n=Math.min(t.x,s.x),i=Math.max(t.x,s.x),o=Math.min(t.y,s.y),a=Math.max(t.y,s.y);return r>=n&&r<=i&&e>=o&&e<=a}const ns=vn("annotations",()=>{const r=Ke({points:[],closed:!1}),e=Ke({}),t=z(()=>{if(e.start&&e.end&&e.meters&&e.meters>0){const T=e.end.x-e.start.x,M=e.end.y-e.start.y,H=Math.hypot(T,M);return H===0?null:e.meters/H}return null}),s=Ke([]);let n=1;const i=Ke([]);let o=1;const a=Ke([]);let l=1;const c=Ke(new Set),d=Ke({active:!1}),u=(T,M)=>T<=3&&M<=2.1?{maxHorizontalDistance:10,maxVerticalDistance:12,maxHorizontalWallDistance:5,maxVerticalWallDistance:6,coverageRadius:Math.max(10,12)/2*1.15}:T>=4&&M<=2.1?{maxHorizontalDistance:12,maxVerticalDistance:14,maxHorizontalWallDistance:6,maxVerticalWallDistance:7,coverageRadius:Math.max(12,14)/2*1.15}:{maxHorizontalDistance:10,maxVerticalDistance:12,maxHorizontalWallDistance:5,maxVerticalWallDistance:6,coverageRadius:Math.max(10,12)/2*1.15},h=T=>{r.points.push(T)},f=()=>{r.closed=!0},p=()=>{r.points.length=0,r.closed=!1},g=(T,M)=>{e.start=T,e.end=M},m=T=>{e.meters=T},v=(T,M,H,V,O=3,W=2.1)=>{const oe=s.length%Yt.length,de=u(O,W);s.push({id:n++,x:T,y:M,w:H,h:V,label:`Zone ${s.length+1}`,ceilingHeight:O,shelfHeight:W,coverageRadius:de.coverageRadius,showCoverage:!1,colorIndex:oe})},_=T=>{const M=s.findIndex(H=>H.id===T);if(M!==-1){s.splice(M,1);for(let H=i.length-1;H>=0;H--)i[H].zoneId===T&&i.splice(H,1)}},w=(T,M)=>{const H=s.find(V=>V.id===T);H&&(H.colorIndex=(H.colorIndex+M+Yt.length)%Yt.length)},x=(T,M,H)=>{const V=s.find(O=>O.id===T);if(V){V.ceilingHeight=M,V.shelfHeight=H;const O=u(M,H);V.coverageRadius=O.coverageRadius}},S=T=>{const M=s.find(H=>H.id===T);M&&(M.showCoverage=!M.showCoverage)},b=(T,M,H)=>{i.push({id:o++,x:T,y:M,label:`A${i.length+1}`,zoneId:H})},A=T=>{const M=i.findIndex(H=>H.id===T);M!==-1&&(i.splice(M,1),c.delete(T))},E=(T,M,H)=>{const V=i.find(O=>O.id===T);V&&(V.x=M,V.y=H)},C=(T,M)=>{a.push({id:l++,start:T,end:M})},k=T=>{const M=a.findIndex(H=>H.id===T);M!==-1&&a.splice(M,1)},D=T=>{c.add(T)},q=T=>{c.delete(T)},Y=()=>{c.clear()};return{perimeter:r,scaleLine:e,zones:s,antennas:i,measures:a,selectedAntennas:c,selectionBox:d,metersPerPx:t,addPerimeterPoint:h,closePerimeter:f,clearPerimeter:p,setScaleLine:g,setScaleMeters:m,addZone:v,deleteZone:_,changeZoneColor:w,updateZoneParameters:x,toggleZoneCoverage:S,addAntenna:b,deleteAntenna:A,updateAntennaPosition:E,addMeasure:C,deleteMeasure:k,selectAntenna:D,deselectAntenna:q,clearSelection:Y,deleteSelectedAntennas:()=>{for(let T=i.length-1;T>=0;T--)c.has(i[T].id)&&i.splice(T,1);Y()},populateAntennasInZone:T=>{const M=s.find(de=>de.id===T);if(!M||!t.value)return;const H=u(M.ceilingHeight,M.shelfHeight);for(let de=i.length-1;de>=0;de--)i[de].zoneId===T&&i.splice(de,1);const V=H.maxHorizontalDistance*.8/t.value,O=H.maxVerticalDistance*.8/t.value,W=M.x+V/2,oe=M.y+O/2;for(let de=W;de<M.x+M.w;de+=V)for(let ye=oe;ye<M.y+M.h;ye+=O){const te=Math.round(de),Ne=Math.round(ye);if(!Ib(te,Ne,r.points,r.closed))continue;const it=Rb(te,Ne,r.points,r.closed),Ut=Math.min(H.maxHorizontalWallDistance,H.maxVerticalWallDistance)/t.value;if(it<Ut*.5)continue;let yt=!1;const vt=Math.min(V,O)*.7;for(const Us of i)if(Math.hypot(te-Us.x,Ne-Us.y)<vt){yt=!0;break}yt||b(te,Ne,T)}},exportData:()=>({perimeter:{points:[...r.points],closed:r.closed},scale:{start:e.start,end:e.end,meters:e.meters},zones:[...s],antennas:[...i],measures:[...a]}),importData:T=>{try{if(!T||typeof T!="object")throw new Error("Invalid data format");p(),s.length=0,i.length=0,a.length=0,Y();let M=0,H=0,V=0;return T.perimeter&&(Array.isArray(T.perimeter.points)&&r.points.push(...T.perimeter.points),T.perimeter.closed&&(r.closed=T.perimeter.closed)),T.scale&&(T.scale.start&&(e.start=T.scale.start),T.scale.end&&(e.end=T.scale.end),T.scale.meters&&(e.meters=T.scale.meters)),Array.isArray(T.zones)&&T.zones.forEach(O=>{O.id&&O.id>M&&(M=O.id),s.push({id:O.id||n++,x:O.x||0,y:O.y||0,w:O.w||100,h:O.h||100,label:O.label||`Zone ${s.length+1}`,ceilingHeight:O.ceilingHeight||3,shelfHeight:O.shelfHeight||2.1,coverageRadius:O.coverageRadius||6,showCoverage:O.showCoverage||!1,colorIndex:O.colorIndex||0})}),Array.isArray(T.antennas)&&T.antennas.forEach(O=>{O.id&&O.id>H&&(H=O.id),i.push({id:O.id||o++,x:O.x||0,y:O.y||0,label:O.label||`A${i.length+1}`,zoneId:O.zoneId})}),Array.isArray(T.measures)&&T.measures.forEach(O=>{O.id&&O.id>V&&(V=O.id),a.push({id:O.id||l++,start:O.start||{x:0,y:0},end:O.end||{x:0,y:0}})}),M>=n&&(n=M+1),H>=o&&(o=H+1),V>=l&&(l=V+1),!0}catch(M){return console.error("Error importing data:",M),!1}},getAntennaPlacementRules:u}}),Mi=vn("tools",()=>{const r=U("perimeter");Pi();const e=ns(),t=z(()=>[{value:"perimeter",label:"Perimeter",tooltip:"Draw the site boundary",icon:oa},{value:"scale",label:"Scale",tooltip:"Set map scale",icon:Pm,disabled:e.perimeter.closed===!1},{value:"zone",label:"Zone",tooltip:"Draw coverage zones",icon:Mm,disabled:e.scaleLine.meters===void 0},{value:"antenna",label:"Add Antenna",tooltip:"Place individual antennas",icon:ac,disabled:e.scaleLine.meters===void 0},{value:"measure",label:"Measure",tooltip:'Measure distances, press "g" to toggle grid snapping',icon:Tm,disabled:e.scaleLine.meters===void 0},{value:"select",label:"Select",tooltip:"Select and move antennas",icon:km,disabled:e.scaleLine.meters===void 0},{value:"multiselect",label:"Multi-Select",tooltip:"Select multiple antennas",icon:oa,disabled:e.scaleLine.meters===void 0}]);return{currentTool:r,tools:t,setTool:n=>{r.value=n}}}),Fb={class:"flex flex-col gap-3"},Bb=L({__name:"ToolSelector",setup(r){const e=Mi();return(t,s)=>(I(),fe("div",Fb,[(I(!0),fe(Kt,null,yn(y(e).tools,n=>(I(),N(y(eg),{key:n.value},{default:P(()=>[R(y(fm),{"as-child":""},{default:P(()=>[R(y(ze),{onClick:i=>y(e).setTool(n.value),disabled:n.disabled,class:Mt(["inline-flex items-center justify-start gap-3 h-11 px-4 rounded-md text-sm font-medium border shadow-sm cursor-pointer transition-colors",y(e).currentTool===n.value?"bg-accent text-accent-foreground border-accent hover:bg-accent hover:text-accent-foreground":"bg-background text-foreground border-input hover:bg-accent hover:text-accent-foreground"])},{default:P(()=>[(I(),N(Ur(n.icon),{class:"w-5 h-5"})),pe(" "+ut(n.label),1)]),_:2},1032,["onClick","disabled","class"])]),_:2},1024),R(y(um),{side:"right"},{default:P(()=>[pe(ut(n.tooltip),1)]),_:2},1024)]),_:2},1024))),128))]))}}),Di=vn("canvas",()=>{const r=U(null),e=U(null),t=U(0),s=U(0),n=U(1),i=1,o=10,a=m=>{r.value=m,e.value=m.getContext("2d")},l=m=>{if(!r.value)return{x:0,y:0};const v=r.value.getBoundingClientRect(),_=r.value.width/v.width,w=r.value.height/v.height,x=(("clientX"in m?m.clientX:m.x)-v.left)*_,S=(("clientY"in m?m.clientY:m.y)-v.top)*w;return{x:(x-t.value)/n.value,y:(S-s.value)/n.value}},c=()=>{e.value&&e.value.setTransform(n.value,0,0,n.value,t.value,s.value)},d=()=>{e.value&&e.value.setTransform(1,0,0,1,0,0)},u=(m,v,_,w)=>{if(!r.value)return;const x=t.value+m,S=s.value+v;if(!_||!w){t.value=x,s.value=S;return}const b=r.value.width,A=r.value.height,E=_*n.value,C=w*n.value;if(E<=b&&C<=A){t.value=(b-E)/2,s.value=(A-C)/2;return}let k,D,q,Y;E<=b?k=D=(b-E)/2:(k=0,D=b-E),C<=A?q=Y=(A-C)/2:(q=0,Y=A-C),t.value=Math.max(D,Math.min(k,x)),s.value=Math.max(Y,Math.min(q,S))},h=(m,v)=>{u(0,0,m,v)};return{canvasRef:r,ctx:e,panX:t,panY:s,zoom:n,initCanvas:a,getCanvasCoords:l,applyTransform:c,resetTransform:d,pan:u,clampPan:h,zoomAt:(m,v,_,w,x)=>{if(!r.value)return;const S=r.value.getBoundingClientRect(),b=r.value.width/S.width,A=r.value.height/S.height,E=m*b,C=v*A,k=(E-t.value)/n.value,D=(C-s.value)/n.value,q=Math.max(i,Math.min(o,n.value*_));q!==n.value&&(n.value=q,t.value=E-k*n.value,s.value=C-D*n.value,w&&x&&h(w,x))},resetView:()=>{t.value=0,s.value=0,n.value=1},fitToView:(m,v)=>{if(!r.value)return;const _=r.value.getBoundingClientRect(),w=40,x=_.width-w*2,S=_.height-w*2,b=x/m,A=S/v;n.value=Math.min(b,A,1),t.value=(_.width*(r.value.width/_.width)-m*n.value)/2,s.value=(_.height*(r.value.height/_.height)-v*n.value)/2}}}),Ii=vn("settings",()=>{const r=U(!1),e=Ke({includePerimeter:!0,includeScale:!0,includeZones:!0,includeAntennas:!0,includeMeasurements:!0}),t=Ke({enabled:!0,orthogonalSnapAngle:15,diagonalSnapAngle:10,enableDiagonalSnap:!0});return{openImportExportDialog:r,gridSnap:t,exportOptions:e,updateGridSnapSettings:i=>{Object.assign(t,i)},toggleGridSnap:()=>{t.enabled=!t.enabled}}});function vs(){const r=Di(),e=Ii(),t=Pi(),s=ns(),n=Mi();let i=!1,o=null,a=null,l=null,c=!1;const d=(b,A,E)=>{i=b,b?(A!==void 0&&(o=A,a=A),E!==void 0&&(a=E)):(o=null,a=null)},u=(b,A=!1)=>{l=b,c=A},h=(b=!1)=>{const A=r.ctx,E=r.canvasRef;!A||!E||(A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,E.width,E.height),r.applyTransform(),t.uploadedImageUrl&&A.drawImage(t.image,0,0),b?[{enabled:e.exportOptions.includePerimeter,fn:f},{enabled:e.exportOptions.includeScale,fn:p},{enabled:e.exportOptions.includeZones,fn:m},{enabled:e.exportOptions.includeAntennas,fn:_},{enabled:e.exportOptions.includeMeasurements,fn:x}].forEach(k=>k.enabled&&k.fn(A)):[f,p,g,m,v,_,w,x,S].forEach(k=>k(A)))},f=b=>{const{points:A,closed:E}=s.perimeter;if(A.length!==0){b.save(),b.lineWidth=3,b.lineJoin="round",b.lineCap="round",b.strokeStyle="#e11d48",b.beginPath(),b.moveTo(A[0].x,A[0].y);for(let C=1;C<A.length;C++)b.lineTo(A[C].x,A[C].y);E&&b.closePath(),b.stroke(),l&&!E&&A.length>0&&(b.setLineDash([4,4]),b.lineWidth=2,b.strokeStyle="#f87171",b.beginPath(),b.moveTo(A[A.length-1].x,A[A.length-1].y),b.lineTo(l.x,l.y),b.stroke(),b.setLineDash([])),A.forEach((C,k)=>{b.beginPath(),b.arc(C.x,C.y,c&&k===0?8:5,0,Math.PI*2),b.fillStyle=c&&k===0?"#fbbf24":"#e11d48",b.fill(),c&&k===0&&(b.strokeStyle="#f59e0b",b.lineWidth=2,b.stroke())}),b.restore()}},p=b=>{const{start:A,end:E,meters:C}=s.scaleLine;if(!A||!E)return;b.save(),b.lineWidth=3,b.strokeStyle="#0ea5e9",b.beginPath(),b.moveTo(A.x,A.y),b.lineTo(E.x,E.y),b.stroke(),b.fillStyle="#0ea5e9",b.font="14px sans-serif";const k=Math.hypot(E.x-A.x,E.y-A.y),D=C?`${C} m`:"? m";b.fillText(`${k.toFixed(1)} px = ${D}`,(A.x+E.x)/2+6,(A.y+E.y)/2-6),b.restore()},g=b=>{if(!i||!o||!a||n.currentTool!=="scale")return;b.save(),b.setLineDash([6,4]),b.lineWidth=2,b.strokeStyle="#60a5fa",b.beginPath(),b.moveTo(o.x,o.y),b.lineTo(a.x,a.y),b.stroke(),b.fillStyle="#60a5fa",b.font="13px sans-serif";const A=Math.hypot(a.x-o.x,a.y-o.y);b.fillText(`${A.toFixed(1)} px`,(o.x+a.x)/2+6,(o.y+a.y)/2-6),b.restore()},m=b=>{s.zones.forEach(A=>{const E=Yt[A.colorIndex];if(b.save(),s.perimeter.closed&&s.perimeter.points.length>=3){b.beginPath(),b.moveTo(s.perimeter.points[0].x,s.perimeter.points[0].y);for(let C=1;C<s.perimeter.points.length;C++)b.lineTo(s.perimeter.points[C].x,s.perimeter.points[C].y);b.closePath(),b.clip()}if(b.lineWidth=2,b.strokeStyle=E.stroke,b.strokeRect(A.x,A.y,A.w,A.h),b.fillStyle=E.fill,b.fillRect(A.x,A.y,A.w,A.h),b.restore(),b.save(),b.fillStyle=E.text,b.font="13px sans-serif",b.fillText(`${A.label}`,A.x+6,A.y+16),A.showCoverage&&s.metersPerPx!==null){const C=s.antennas.filter(k=>k.zoneId===A.id);C.length>0&&(b.fillStyle="rgba(59,130,246,0.12)",b.strokeStyle="rgba(59,130,246,0.5)",b.lineWidth=1,C.forEach(k=>{const D=A.coverageRadius/s.metersPerPx;b.beginPath(),b.arc(k.x,k.y,D,0,Math.PI*2),b.fill(),b.stroke()}))}b.restore()})},v=b=>{if(!i||!o||!a||n.currentTool!=="zone")return;const A=a.x-o.x,E=a.y-o.y,C=s.zones.length%Yt.length,k=Yt[C];b.save(),b.setLineDash([6,4]),b.lineWidth=2,b.strokeStyle=k.stroke,b.strokeRect(o.x,o.y,A,E),b.fillStyle=k.fill.replace("0.2)","0.1)"),b.fillRect(o.x,o.y,A,E),b.fillStyle=k.text,b.font="13px sans-serif",b.fillText(`Zone ${s.zones.length+1} (preview)`,o.x+6,o.y+16),b.restore()},_=b=>{s.antennas.forEach(A=>{b.save(),b.beginPath(),b.arc(A.x,A.y,5,0,Math.PI*2);const E=s.selectedAntennas.has(A.id);b.fillStyle=E?"#facc15":"#f97316",b.fill(),b.lineWidth=E?3:1,b.strokeStyle=E?"#eab308":"#7c2d12",b.stroke(),E&&(b.beginPath(),b.arc(A.x,A.y,8,0,Math.PI*2),b.lineWidth=2,b.strokeStyle="#eab308",b.stroke()),b.fillStyle="#111827",b.font="12px sans-serif",A.label&&b.fillText(A.label,A.x+8,A.y+4),b.restore()})},w=b=>{if(n.currentTool==="multiselect"&&s.selectionBox.active&&s.selectionBox.start&&s.selectionBox.end){b.save();const{start:A,end:E}=s.selectionBox,C=E.x-A.x,k=E.y-A.y;b.fillStyle="rgba(59, 130, 246, 0.1)",b.fillRect(A.x,A.y,C,k),b.strokeStyle="#3b82f6",b.lineWidth=2,b.setLineDash([5,5]),b.strokeRect(A.x,A.y,C,k),b.restore()}},x=b=>{s.measures.forEach(A=>{b.save(),b.lineWidth=2,b.strokeStyle="#7c3aed",b.beginPath(),b.moveTo(A.start.x,A.start.y),b.lineTo(A.end.x,A.end.y),b.stroke();const E=A.end.x-A.start.x,C=A.end.y-A.start.y,k=s.metersPerPx?Math.hypot(E,C)*s.metersPerPx:null;b.fillStyle="#7c3aed",b.font="13px sans-serif";const D=k?`M${A.id}: ${k.toFixed(2)} m`:`M${A.id}: ? m`;b.fillText(D,(A.start.x+A.end.x)/2+6,(A.start.y+A.end.y)/2-6),b.restore()})},S=b=>{if(!i||!o||!a||n.currentTool!=="measure")return;b.save(),b.setLineDash([6,4]),b.lineWidth=2,b.strokeStyle="#a78bfa",b.beginPath(),b.moveTo(o.x,o.y),b.lineTo(a.x,a.y),b.stroke();const A=a.x-o.x,E=a.y-o.y,C=s.metersPerPx?Math.hypot(A,E)*s.metersPerPx:null;b.fillStyle="#a78bfa",b.font="13px sans-serif";const k=C?`${C.toFixed(2)} m`:"? m";b.fillText(k,(o.x+a.x)/2+6,(o.y+a.y)/2-6),b.restore()};return{draw:h,setDrawingState:d,setPerimeterPreview:u}}const Ts=L({__name:"Checkbox",props:{defaultValue:{type:[Boolean,String]},modelValue:{type:[Boolean,String,null]},disabled:{type:Boolean},value:{},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,s=e,n=nt(t,"class"),i=st(n,s);return(o,a)=>(I(),N(y(Dh),ee({"data-slot":"checkbox"},y(i),{class:y(Te)("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t.class)}),{default:P(()=>[R(y(Rh),{"data-slot":"checkbox-indicator",class:"flex items-center justify-center text-current transition-none"},{default:P(()=>[$(o.$slots,"default",{},()=>[R(y(Sm),{class:"size-3.5"})])]),_:3})]),_:3},16,["class"]))}}),Nb=L({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const n=st(r,e);return(i,o)=>(I(),N(y(Cu),ee({"data-slot":"dialog"},y(n)),{default:P(()=>[$(i.$slots,"default")]),_:3},16))}}),$b=L({__name:"DialogOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class");return(s,n)=>(I(),N(y(rh),ee({"data-slot":"dialog-overlay"},y(t),{class:y(Te)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e.class)}),{default:P(()=>[$(s.$slots,"default")]),_:3},16,["class"]))}}),qb=L({__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,s=e,n=nt(t,"class"),i=st(n,s);return(o,a)=>(I(),N(y(lh),null,{default:P(()=>[R($b),R(y(Qu),ee({"data-slot":"dialog-content"},y(i),{class:y(Te)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t.class)}),{default:P(()=>[$(o.$slots,"default"),R(y(Tu),{class:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"},{default:P(()=>[R(y(Dm)),a[0]||(a[0]=ne("span",{class:"sr-only"},"Close",-1))]),_:1,__:[0]})]),_:3},16,["class"])]),_:3}))}}),Hb=L({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class"),s=ps(t);return(n,i)=>(I(),N(y(th),ee({"data-slot":"dialog-description"},y(s),{class:y(Te)("text-muted-foreground text-sm",e.class)}),{default:P(()=>[$(n.$slots,"default")]),_:3},16,["class"]))}}),zb=L({__name:"DialogHeader",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("div",{"data-slot":"dialog-header",class:Mt(y(Te)("flex flex-col gap-2 text-center sm:text-left",e.class))},[$(t.$slots,"default")],2))}}),Ub=L({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class"),s=ps(t);return(n,i)=>(I(),N(y(dh),ee({"data-slot":"dialog-title"},y(s),{class:y(Te)("text-lg leading-none font-semibold",e.class)}),{default:P(()=>[$(n.$slots,"default")]),_:3},16,["class"]))}});function Jc(){const r=new Date,e=t=>t.toString().padStart(2,"0");return`${r.getFullYear()}-${e(r.getMonth()+1)}-${e(r.getDate())}_${e(r.getHours())}-${e(r.getMinutes())}-${e(r.getSeconds())}`}function jb(r){const e=`annotated-map-${Jc()}.png`,t=document.createElement("a");t.download=e,t.href=r.toDataURL("image/png"),t.click()}function Vb(r){const e=`annotations-${Jc()}.json`,t=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=e,n.click(),URL.revokeObjectURL(s)}function Wb(){return new Promise((r,e)=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=s=>{const n=s.target.files?.[0];if(!n){e(new Error("No file selected"));return}const i=new FileReader;i.onload=o=>{try{const a=JSON.parse(o.target?.result);r(a)}catch{e(new Error("Invalid JSON file"))}},i.onerror=()=>e(new Error("Error reading file")),i.readAsText(n)},t.click()})}const Gb={class:"flex items-start gap-6"},Xb={class:"flex flex-col space-y-1"},Yb={class:"inline-flex items-center"},Kb={class:"inline-flex items-center"},Zb={class:"inline-flex items-center"},Jb={class:"inline-flex items-center"},Qb={class:"inline-flex items-center"},ew={class:"flex gap-4"},tw=L({__name:"ImportExportDialog",props:{open:{type:Boolean}},emits:["update:open"],setup(r){const e=Ii(),t=Di(),s=ns(),{draw:n}=vs(),i=()=>{t.canvasRef&&(n(!0),jb(t.canvasRef),n(!1))},o=()=>{const l=s.exportData();Vb(l)},a=async()=>{try{const l=await Wb();s.importData(l)?(console.log("Data imported successfully"),n()):console.error("Failed to import data")}catch(l){console.error("Import failed:",l)}};return(l,c)=>(I(),N(y(Nb),{open:l.open,"onUpdate:open":c[5]||(c[5]=d=>l.$emit("update:open",d))},{default:P(()=>[R(y(qb),{class:"w-[500px]"},{default:P(()=>[R(y(zb),null,{default:P(()=>[R(y(Ub),null,{default:P(()=>c[6]||(c[6]=[pe("Import/Export Options",-1)])),_:1,__:[6]}),R(y(Hb),null,{default:P(()=>c[7]||(c[7]=[pe(" Choose an option below to import or export data ",-1)])),_:1,__:[7]})]),_:1}),ne("div",Gb,[R(y(ze),{onClick:i,variant:"outline",class:"w-40 justify-start"},{default:P(()=>[R(y(_r),{class:"w-4 h-4 mr-2"}),c[8]||(c[8]=pe(" Export PNG ",-1))]),_:1,__:[8]}),ne("div",Xb,[ne("label",Yb,[R(y(Ts),{modelValue:y(e).exportOptions.includePerimeter,"onUpdate:modelValue":c[0]||(c[0]=d=>y(e).exportOptions.includePerimeter=d)},null,8,["modelValue"]),c[9]||(c[9]=ne("span",{class:"ml-2 text-sm"},"Include Perimeter",-1))]),ne("label",Kb,[R(y(Ts),{modelValue:y(e).exportOptions.includeScale,"onUpdate:modelValue":c[1]||(c[1]=d=>y(e).exportOptions.includeScale=d)},null,8,["modelValue"]),c[10]||(c[10]=ne("span",{class:"ml-2 text-sm"},"Include Scale",-1))]),ne("label",Zb,[R(y(Ts),{modelValue:y(e).exportOptions.includeZones,"onUpdate:modelValue":c[2]||(c[2]=d=>y(e).exportOptions.includeZones=d)},null,8,["modelValue"]),c[11]||(c[11]=ne("span",{class:"ml-2 text-sm"},"Include Zones",-1))]),ne("label",Jb,[R(y(Ts),{modelValue:y(e).exportOptions.includeAntennas,"onUpdate:modelValue":c[3]||(c[3]=d=>y(e).exportOptions.includeAntennas=d)},null,8,["modelValue"]),c[12]||(c[12]=ne("span",{class:"ml-2 text-sm"},"Include Antennas",-1))]),ne("label",Qb,[R(y(Ts),{modelValue:y(e).exportOptions.includeMeasurements,"onUpdate:modelValue":c[4]||(c[4]=d=>y(e).exportOptions.includeMeasurements=d)},null,8,["modelValue"]),c[13]||(c[13]=ne("span",{class:"ml-2 text-sm"},"Include Measurements",-1))])])]),R(y(ii),{class:"my-4"}),ne("div",ew,[R(y(ze),{onClick:o,variant:"outline",class:"w-40 justify-start"},{default:P(()=>[R(y(_r),{class:"w-4 h-4 mr-2"}),c[14]||(c[14]=pe(" Export JSON ",-1))]),_:1,__:[14]}),R(y(ze),{onClick:a,variant:"outline",class:"w-40 justify-start"},{default:P(()=>[R(y(ao),{class:"w-4 h-4 mr-2"}),c[15]||(c[15]=pe(" Import JSON ",-1))]),_:1,__:[15]})])]),_:1})]),_:1},8,["open"]))}}),sw={class:"flex h-full flex-col border-r bg-background p-4 gap-4"},nw={class:"flex-1 flex flex-col justify-between"},iw={class:"flex flex-col gap-4"},rw={class:"flex flex-col gap-2"},ow=L({__name:"Sidebar",setup(r){const{logout:e,user:t}=ud(),s=Pg(),n=Pi(),i=Di(),o=Ii(),{draw:a}=vs(),l=async d=>{const u=d.target.files?.[0];if(u)try{await n.uploadImage(u),i.canvasRef&&(i.canvasRef.width=n.image.width,i.canvasRef.height=n.image.height,a())}catch(h){console.error("Failed to upload map:",h)}},c=()=>e({logoutParams:{returnTo:window.location.origin}});return(d,u)=>(I(),fe(Kt,null,[R(tw,{open:y(o).openImportExportDialog,"onUpdate:open":u[0]||(u[0]=h=>y(o).openImportExportDialog=h)},null,8,["open"]),ne("aside",sw,[u[11]||(u[11]=ne("div",{class:"flex h-16 items-center border-b px-2"},[ne("h1",{class:"text-xl font-semibold flex items-center gap-2"},[ne("img",{src:pm,alt:"Logo",class:"h-7 w-7"}),pe(" InfraAnnotator ")])],-1)),ne("div",nw,[ne("div",iw,[R(y(Wt),{for:"file-upload",class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 cursor-pointer"},{default:P(()=>[R(y(ao),{class:"w-4 h-4 mr-2"}),pe(" "+ut(y(n).uploadedImageUrl?"Change Map":"Upload Map"),1)]),_:1}),ne("input",{id:"file-upload",type:"file",class:"sr-only",accept:"image/png,image/jpeg, application/pdf",onChange:l},null,32),R(y(ii),{class:"my-1"}),R(Bb)]),ne("div",rw,[R(y(ii),{class:"my-1"}),R(y(ze),{onClick:u[1]||(u[1]=h=>y(o).openImportExportDialog=!0),variant:"outline"},{default:P(()=>[R(y(_r),{class:"w-4 h-4 mr-2"}),u[5]||(u[5]=pe(" Import/Export ",-1))]),_:1,__:[5]}),R(y(ym),null,{default:P(()=>[R(y(Rm),{"as-child":""},{default:P(()=>[R(y(ze),{variant:"outline"},{default:P(()=>[R(y(ba),{icon:"radix-icons:moon",class:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),R(y(ba),{icon:"radix-icons:sun",class:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),u[6]||(u[6]=ne("span",{class:"sr-only"},"Toggle theme",-1))]),_:1,__:[6]})]),_:1}),R(y(Im),{align:"end"},{default:P(()=>[R(y(Vi),{onClick:u[2]||(u[2]=h=>s.value="light")},{default:P(()=>u[7]||(u[7]=[pe(" Light ",-1)])),_:1,__:[7]}),R(y(Vi),{onClick:u[3]||(u[3]=h=>s.value="dark")},{default:P(()=>u[8]||(u[8]=[pe(" Dark ",-1)])),_:1,__:[8]}),R(y(Vi),{onClick:u[4]||(u[4]=h=>s.value="auto")},{default:P(()=>u[9]||(u[9]=[pe(" System ",-1)])),_:1,__:[9]})]),_:1})]),_:1}),R(y(ze),{variant:"outline",onClick:c},{default:P(()=>u[10]||(u[10]=[pe(" Logout ",-1)])),_:1,__:[10]})])])])],64))}});function aw(r,e){return r.addEventListener("wheel",e.onWheel,{passive:!1}),r.addEventListener("pointerdown",e.onPointerDown),r.addEventListener("pointermove",e.onPointerMove),r.addEventListener("pointerup",e.onPointerUp),r.addEventListener("dblclick",e.onDblClick),()=>{r.removeEventListener("wheel",e.onWheel),r.removeEventListener("pointerdown",e.onPointerDown),r.removeEventListener("pointermove",e.onPointerMove),r.removeEventListener("pointerup",e.onPointerUp),r.removeEventListener("dblclick",e.onDblClick)}}function Ga(r,e){r.width=e.width,r.height=e.height}class lw{settings;constructor(e){this.settings=e}updateSettings(e){this.settings={...this.settings,...e}}snapLine(e,t,s,n){if(!this.settings.enabled)return{x:s,y:n,snapped:!1};const i=s-e,o=n-t,c=(Math.atan2(o,i)*180/Math.PI%360+360)%360;if(this.isCloseToAngle(c,0,this.settings.orthogonalSnapAngle)||this.isCloseToAngle(c,180,this.settings.orthogonalSnapAngle))return{x:s,y:t,snapped:!0,snapType:"horizontal"};if(this.isCloseToAngle(c,90,this.settings.orthogonalSnapAngle)||this.isCloseToAngle(c,270,this.settings.orthogonalSnapAngle))return{x:e,y:n,snapped:!0,snapType:"vertical"};if(this.settings.enableDiagonalSnap){if(this.isCloseToAngle(c,45,this.settings.diagonalSnapAngle)||this.isCloseToAngle(c,225,this.settings.diagonalSnapAngle)){const d=(Math.abs(i)+Math.abs(o))/2,u=e+d*Math.sign(i),h=t+d*Math.sign(o);return{x:u,y:h,snapped:!0,snapType:"diagonal45"}}if(this.isCloseToAngle(c,135,this.settings.diagonalSnapAngle)||this.isCloseToAngle(c,315,this.settings.diagonalSnapAngle)){const d=(Math.abs(i)+Math.abs(o))/2,u=e+d*Math.sign(i),h=t-d*Math.sign(i);return{x:u,y:h,snapped:!0,snapType:"diagonal135"}}}return{x:s,y:n,snapped:!1}}isCloseToAngle(e,t,s){return Math.min(Math.abs(e-t),Math.abs(e-t+360),Math.abs(e-t-360))<=s}}const cw={class:"flex-1 flex items-center justify-center p-8 bg-muted/40 overflow-hidden"},dw={class:"flex flex-col items-center gap-4 text-center p-10 border-2 border-dashed rounded-xl"},uw={class:"border rounded-lg overflow-hidden shadow-lg bg-background"},hw=L({__name:"MainCanvas",setup(r){const e=Ii(),{gridSnap:t}=Pn(e),s=new lw(t.value);Ae(t,M=>{s.updateSettings(M)},{deep:!0});const n=U(null),i=Di(),o=Pi(),a=ns(),l=Mi(),{draw:c,setDrawingState:d,setPerimeterPreview:u}=vs(),{uploadedImageUrl:h,image:f}=Pn(o),{currentTool:p}=Pn(l),{perimeter:g,antennas:m,selectedAntennas:v,selectionBox:_}=Pn(a);let w=null,x=null,S=null;const b=U(!1),A=U(!1);let E=null,C=1;function k(){return b.value?"grabbing":A.value?"grab":"default"}function D(M,H){for(let V=m.value.length-1;V>=0;V--){const O=m.value[V];if(Math.hypot(O.x-M,O.y-H)<8)return V}return null}function q(M){if(!n.value)return;if(M.button===1||M.button===0&&A.value){M.preventDefault(),b.value=!0,E={x:M.clientX,y:M.clientY,panX:i.panX,panY:i.panY},n.value.setPointerCapture?.(M.pointerId);return}const{x:V,y:O}=i.getCanvasCoords(M);if(n.value.setPointerCapture?.(M.pointerId),p.value==="perimeter"){if(g.value.points.length>=3){const W=g.value.points[0];if(Math.hypot(V-W.x,O-W.y)<15){a.closePerimeter(),u(null,!1),c();return}}a.addPerimeterPoint({x:V,y:O}),c()}else if(p.value==="scale")S={x:V,y:O},d(!0,{x:V,y:O});else if(p.value==="zone")S={x:V,y:O},d(!0,{x:V,y:O});else if(p.value==="measure")S={x:V,y:O},d(!0,{x:V,y:O});else if(p.value==="antenna")a.addAntenna(V,O,C),c();else if(p.value==="select"){const W=D(V,O);W!==null&&(w={idx:W,offsetX:V-m.value[W].x,offsetY:O-m.value[W].y})}else if(p.value==="multiselect"){const W=D(V,O);W!==null&&v.value.has(m.value[W].id)?x={startX:V,startY:O,antennaPositions:m.value.filter(oe=>v.value.has(oe.id)).map(oe=>({id:oe.id,x:oe.x,y:oe.y}))}:(a.selectionBox={start:{x:V,y:O},end:{x:V,y:O},active:!0},a.clearSelection())}}function Y(M){if(!n.value)return;if(b.value&&E){const O=M.clientX-E.x,W=M.clientY-E.y,oe=n.value.getBoundingClientRect(),de=n.value.width/oe.width,ye=n.value.height/oe.height;i.panX=E.panX+O*de,i.panY=E.panY+W*ye,f.value.complete&&i.clampPan(f.value.width,f.value.height),c();return}const{x:H,y:V}=i.getCanvasCoords(M);if(p.value==="perimeter"&&g.value.points.length>0&&!g.value.closed){let O=!1;if(g.value.points.length>=3){const W=g.value.points[0];O=Math.hypot(H-W.x,V-W.y)<15}u({x:H,y:V},O),c()}else if(w){const O=m.value[w.idx];a.updateAntennaPosition(O.id,H-w.offsetX,V-w.offsetY),c()}else if(p.value==="multiselect"){if(_.value.active&&_.value.start)a.selectionBox={start:_.value.start,end:{x:H,y:V},active:!0},c();else if(x){const O=H-x.startX,W=V-x.startY;m.value.forEach(oe=>{if(v.value.has(oe.id)){const de=x.antennaPositions.find(ye=>ye.id===oe.id);de&&a.updateAntennaPosition(oe.id,de.x+O,de.y+W)}}),c()}}else if(p.value==="measure"&&S){const O=s.snapLine(S.x,S.y,H,V);d(!0,void 0,{x:O.x,y:O.y}),c()}else(p.value==="scale"||p.value==="zone")&&(d(!0,void 0,{x:H,y:V}),c())}function F(M){if(!n.value)return;if(b.value){b.value=!1,E=null,n.value.releasePointerCapture?.(M.pointerId);return}const{x:H,y:V}=i.getCanvasCoords(M);if(n.value.releasePointerCapture?.(M.pointerId),p.value==="scale")S&&a.setScaleLine(S,{x:H,y:V}),d(!1);else if(p.value==="zone"){if(S){const O=H-S.x,W=V-S.y;a.addZone(S.x,S.y,O,W)}d(!1)}else if(p.value==="measure"){if(S){const O=s.snapLine(S.x,S.y,H,V);a.addMeasure(S,{x:O.x,y:O.y})}d(!1)}else if(p.value==="multiselect"&&_.value.active&&_.value.start&&_.value.end){const O=m.value.filter(W=>Lb(W.x,W.y,_.value.start,_.value.end));a.selectedAntennas=new Set(O.map(W=>W.id)),a.selectionBox={active:!1}}S=null,w=null,x=null,u(null,!1),c()}function G(M){if(M.preventDefault(),!n.value)return;const H=n.value.getBoundingClientRect(),V=M.clientX-H.left,O=M.clientY-H.top,W=M.ctrlKey;if(!M.ctrlKey&&!M.shiftKey&&f.value.complete){const de=n.value.width/H.width,ye=n.value.height/H.height,te=-M.deltaX*de,Ne=-M.deltaY*ye;i.pan(te,Ne,f.value.width,f.value.height),c()}else if(W){const de=1-M.deltaY*.01,ye=f.value.complete?f.value.width:void 0,te=f.value.complete?f.value.height:void 0;i.zoomAt(V,O,de,ye,te),c()}else{const de=M.deltaY<0?1.05:.95,ye=f.value.complete?f.value.width:void 0,te=f.value.complete?f.value.height:void 0;i.zoomAt(V,O,de,ye,te),c()}}function B(){p.value==="perimeter"&&g.value.points.length>=3&&(a.closePerimeter(),c())}function j(M){M.code==="Space"&&!A.value&&(M.preventDefault(),A.value=!0),p.value==="multiselect"&&v.value.size>0&&(M.key==="Delete"||M.key==="Backspace"?(M.preventDefault(),a.deleteSelectedAntennas(),c()):M.key==="Escape"&&(M.preventDefault(),a.clearSelection(),c())),(M.key==="g"||M.key==="G")&&(M.preventDefault(),e.toggleGridSnap()),M.key==="0"&&(M.preventDefault(),i.resetView(),c()),(M.key==="f"||M.key==="F")&&(M.preventDefault(),f.value.complete&&(i.fitToView(f.value.width,f.value.height),c()))}function T(M){M.code==="Space"&&(M.preventDefault(),A.value=!1,b.value&&(b.value=!1,E=null))}return tt(()=>{if(!n.value)return;i.initCanvas(n.value),h.value&&(f.value.onload=()=>{n.value&&(Ga(n.value,f.value),c())},f.value.complete&&(Ga(n.value,f.value),c()));const M=aw(n.value,{onPointerDown:q,onPointerMove:Y,onPointerUp:F,onDblClick:B,onWheel:G});document.addEventListener("keydown",j),document.addEventListener("keyup",T),sr(()=>{M(),document.removeEventListener("keydown",j),document.removeEventListener("keyup",T)})}),sr(()=>{}),(M,H)=>(I(),fe("main",cw,[nr(ne("div",dw,[R(y(Em),{class:"h-24 w-24 text-muted-foreground"}),H[1]||(H[1]=ne("h3",{class:"text-2xl font-bold tracking-tight"},"Ready to Annotate?",-1)),H[2]||(H[2]=ne("p",{class:"text-sm text-muted-foreground"},"Upload a PNG, JPEG, or PDF map to get started.",-1)),R(y(Wt),{for:"file-upload",class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-10 px-4 py-2 mt-4 cursor-pointer"},{default:P(()=>[R(y(ao),{class:"w-4 h-4 mr-2"}),H[0]||(H[0]=pe(" Upload Map ",-1))]),_:1,__:[0]})],512),[[Do,!y(h)]]),nr(ne("div",uw,[ne("canvas",{ref_key:"canvasRef",ref:n,style:mn([{"max-width":"100%","max-height":"85vh",height:"auto","touch-action":"none",display:"block"},{cursor:k()}])},null,4)],512),[[Do,y(h)]])]))}}),Qc=L({__name:"Card",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("div",{"data-slot":"card",class:Mt(y(Te)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e.class))},[$(t.$slots,"default")],2))}}),ed=L({__name:"CardContent",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("div",{"data-slot":"card-content",class:Mt(y(Te)("px-6",e.class))},[$(t.$slots,"default")],2))}}),td=L({__name:"CardDescription",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("p",{"data-slot":"card-description",class:Mt(y(Te)("text-muted-foreground text-sm",e.class))},[$(t.$slots,"default")],2))}}),sd=L({__name:"CardHeader",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("div",{"data-slot":"card-header",class:Mt(y(Te)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e.class))},[$(t.$slots,"default")],2))}}),nd=L({__name:"CardTitle",props:{class:{}},setup(r){const e=r;return(t,s)=>(I(),fe("h3",{"data-slot":"card-title",class:Mt(y(Te)("leading-none font-semibold",e.class))},[$(t.$slots,"default")],2))}}),nn=L({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,n=Mg(t,"modelValue",e,{passive:!0,defaultValue:t.defaultValue});return(i,o)=>nr((I(),fe("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>tn(n)?n.value=a:null),"data-slot":"input",class:Mt(y(Te)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t.class))},null,2)),[[hd,y(n)]])}}),fw={class:"text-sm text-muted-foreground"},pw=L({__name:"ScaleSection",setup(r){const e=ns(),{draw:t}=vs(),s=n=>{const i=parseFloat(n.target.value);isNaN(i)||(e.setScaleMeters(i),t())};return(n,i)=>y(e).scaleLine.start&&y(e).scaleLine.end?(I(),N(y(Qc),{key:0},{default:P(()=>[R(y(sd),null,{default:P(()=>[R(y(nd),null,{default:P(()=>i[0]||(i[0]=[pe("Map Scale",-1)])),_:1,__:[0]}),R(y(td),null,{default:P(()=>i[1]||(i[1]=[pe("Enter the real-world length of the line you drew.",-1)])),_:1,__:[1]})]),_:1}),R(y(ed),{class:"space-y-2"},{default:P(()=>[R(y(Wt),{for:"scale-meters"},{default:P(()=>i[2]||(i[2]=[pe("Scale Line Length (meters)",-1)])),_:1,__:[2]}),R(y(nn),{id:"scale-meters",type:"number",step:"0.01","model-value":y(e).scaleLine.meters,onInput:s,placeholder:"e.g., 10"},null,8,["model-value"]),ne("p",fw," 1 px  "+ut(y(e).metersPerPx?y(e).metersPerPx.toFixed(4):"?")+" m ",1)]),_:1})]),_:1})):Bt("",!0)}}),gw=L({__name:"Accordion",props:{collapsible:{type:Boolean},disabled:{type:Boolean},dir:{},orientation:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},type:{},modelValue:{},defaultValue:{}},emits:["update:modelValue"],setup(r,{emit:e}){const n=st(r,e);return(i,o)=>(I(),N(y(fu),ee({"data-slot":"accordion"},y(n)),{default:P(()=>[$(i.$slots,"default")]),_:3},16))}}),mw=L({__name:"AccordionContent",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class");return(s,n)=>(I(),N(y(vu),ee({"data-slot":"accordion-content"},y(t),{class:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm"}),{default:P(()=>[ne("div",{class:Mt(y(Te)("pt-0 pb-4",e.class))},[$(s.$slots,"default")],2)]),_:3},16))}}),yw=L({__name:"AccordionItem",props:{disabled:{type:Boolean},value:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class"),s=ps(t);return(n,i)=>(I(),N(y(mu),ee({"data-slot":"accordion-item"},y(s),{class:y(Te)("border-b last:border-b-0",e.class)}),{default:P(()=>[$(n.$slots,"default")]),_:3},16,["class"]))}}),vw=L({__name:"AccordionTrigger",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=nt(e,"class");return(s,n)=>(I(),N(y(wu),{class:"flex"},{default:P(()=>[R(y(Au),ee({"data-slot":"accordion-trigger"},y(t),{class:y(Te)("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e.class)}),{default:P(()=>[$(s.$slots,"default"),$(s.$slots,"icon",{},()=>[R(y(Cm),{class:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})])]),_:3},16,["class"])]),_:3}))}}),bw={key:0,class:"text-sm text-muted-foreground"},ww={class:"flex items-center gap-2 flex-1 mr-4"},_w={class:"truncate"},Aw={class:"space-y-1"},xw={class:"space-y-1"},Sw={class:"space-y-1"},Cw={class:"flex items-center space-x-2"},Ew={class:"flex items-center gap-2"},Tw=L({__name:"ZonesSection",setup(r){const e=ns(),{draw:t}=vs(),s=a=>{e.deleteZone(a),t()},n=a=>{a.showCoverage=!a.showCoverage,t()},i=(a,l)=>{e.changeZoneColor(a,l),t()},o=a=>{if(!e.metersPerPx){alert("Please set a scale first (draw scale line and enter meters).");return}e.populateAntennasInZone(a),t()};return(a,l)=>(I(),fe("div",null,[l[8]||(l[8]=ne("h3",{class:"text-lg font-semibold mb-2"},"Zones",-1)),y(e).zones.length?(I(),N(y(gw),{key:1,type:"multiple",class:"w-full",collapsible:""},{default:P(()=>[(I(!0),fe(Kt,null,yn(y(e).zones,c=>(I(),N(y(yw),{key:c.id,value:`zone-${c.id}`},{default:P(()=>[R(y(vw),null,{default:P(()=>[ne("div",ww,[ne("div",{class:"w-4 h-4 border border-gray-400 rounded-sm shrink-0",style:mn({backgroundColor:y(Yt)[c.colorIndex].fill,borderColor:y(Yt)[c.colorIndex].stroke})},null,4),ne("span",_w,ut(c.label),1)]),R(y(ze),{onClick:hi(d=>s(c.id),["stop"]),variant:"ghost",size:"icon",class:"h-7 w-7"},{default:P(()=>[R(y(ri),{class:"w-4 h-4 text-destructive"})]),_:2},1032,["onClick"])]),_:2},1024),R(y(mw),{class:"space-y-4 pt-2"},{default:P(()=>[ne("div",Aw,[R(y(Wt),{for:`zone-label-${c.id}`},{default:P(()=>l[2]||(l[2]=[pe("Zone Label",-1)])),_:2,__:[2]},1032,["for"]),R(y(nn),{id:`zone-label-${c.id}`,modelValue:c.label,"onUpdate:modelValue":d=>c.label=d,onInput:l[0]||(l[0]=d=>y(t)())},null,8,["id","modelValue","onUpdate:modelValue"])]),ne("div",xw,[R(y(Wt),{for:`zone-ceilingheight-${c.id}`},{default:P(()=>l[3]||(l[3]=[pe("Ceiling height (m)",-1)])),_:2,__:[3]},1032,["for"]),R(y(nn),{id:`zone-ceilingheight-${c.id}`,type:"number",step:"0.1",modelValue:c.ceilingHeight,"onUpdate:modelValue":d=>c.ceilingHeight=d,modelModifiers:{number:!0}},null,8,["id","modelValue","onUpdate:modelValue"])]),ne("div",Sw,[R(y(Wt),{for:`zone-shelfheight-${c.id}`},{default:P(()=>l[4]||(l[4]=[pe("Shelf height (m)",-1)])),_:2,__:[4]},1032,["for"]),R(y(nn),{id:`zone-shelfheight-${c.id}`,type:"number",step:"0.1",modelValue:c.shelfHeight,"onUpdate:modelValue":d=>c.shelfHeight=d,modelModifiers:{number:!0},onInput:l[1]||(l[1]=d=>y(t)())},null,8,["id","modelValue","onUpdate:modelValue"])]),ne("div",Cw,[R(y(Ts),{id:`show-coverage-${c.id}`,checked:c.showCoverage,onClick:d=>n(c)},null,8,["id","checked","onClick"]),R(y(Wt),{for:`show-coverage-${c.id}`,class:"text-sm font-medium leading-none"},{default:P(()=>l[5]||(l[5]=[pe(" Show coverage circles ",-1)])),_:2,__:[5]},1032,["for"])]),ne("div",Ew,[R(y(Wt),{class:"text-sm"},{default:P(()=>l[6]||(l[6]=[pe("Color:",-1)])),_:1,__:[6]}),R(y(ze),{onClick:d=>i(c.id,-1),variant:"outline",size:"icon",class:"h-7 w-7"},{default:P(()=>[R(y(Am),{class:"w-4 h-4"})]),_:2},1032,["onClick"]),R(y(ze),{onClick:d=>i(c.id,1),variant:"outline",size:"icon",class:"h-7 w-7"},{default:P(()=>[R(y(xm),{class:"w-4 h-4"})]),_:2},1032,["onClick"])]),R(y(ze),{onClick:d=>o(c.id),class:"w-full"},{default:P(()=>[R(y(ac),{class:"w-4 h-4 mr-2"}),l[7]||(l[7]=pe(" Populate Antennas ",-1))]),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})):(I(),fe("p",bw," Use the 'Zone' tool to draw deployment areas. "))]))}}),kw={class:"flex gap-2"},Pw={key:1,class:"text-sm text-muted-foreground"},Mw={key:2,class:"space-y-2"},Dw={key:0,class:"text-xs text-muted-foreground whitespace-nowrap"},Iw={key:1,class:"w-2 h-2 bg-yellow-500 rounded-full",title:"Selected"},Rw=L({__name:"AntennasSection",setup(r){const e=Mi(),t=ns(),{draw:s}=vs(),n=l=>t.zones.find(d=>d.id===l)?.label||"?",i=()=>{t.clearSelection(),s()},o=()=>{t.deleteSelectedAntennas(),s()},a=(l,c)=>{t.selectedAntennas.delete(l),t.antennas.splice(c,1),s()};return(l,c)=>(I(),fe("div",null,[y(e).currentTool==="multiselect"&&y(t).selectedAntennas.size>0?(I(),N(y(Qc),{key:0,class:"mb-4"},{default:P(()=>[R(y(sd),null,{default:P(()=>[R(y(nd),null,{default:P(()=>c[1]||(c[1]=[pe("Selected Antennas",-1)])),_:1,__:[1]}),R(y(td),null,{default:P(()=>[pe(ut(y(t).selectedAntennas.size)+" antenna"+ut(y(t).selectedAntennas.size>1?"s":"")+" selected ",1)]),_:1})]),_:1}),R(y(ed),{class:"space-y-2"},{default:P(()=>[ne("div",kw,[R(y(ze),{onClick:i,variant:"outline",size:"sm"},{default:P(()=>c[2]||(c[2]=[pe(" Clear Selection ",-1)])),_:1,__:[2]}),R(y(ze),{onClick:o,variant:"destructive",size:"sm"},{default:P(()=>[R(y(ri),{class:"w-4 h-4 mr-2"}),c[3]||(c[3]=pe(" Delete Selected ",-1))]),_:1,__:[3]})]),c[4]||(c[4]=ne("p",{class:"text-xs text-muted-foreground"}," Use Delete key or drag to move selected antennas together. ",-1))]),_:1,__:[4]})]),_:1})):Bt("",!0),R(y(ii),{class:"mb-4"}),c[5]||(c[5]=ne("h3",{class:"text-lg font-semibold mb-2"},"Antennas",-1)),y(t).antennas.length?(I(),fe("ul",Mw,[(I(!0),fe(Kt,null,yn(y(t).antennas,(d,u)=>(I(),fe("li",{key:d.id,class:"flex items-center gap-2 text-sm"},[R(y(nn),{modelValue:d.label,"onUpdate:modelValue":h=>d.label=h,onInput:c[0]||(c[0]=h=>y(s)()),class:"h-8 flex-1"},null,8,["modelValue","onUpdate:modelValue"]),d.zoneId?(I(),fe("span",Dw," In "+ut(n(d.zoneId)),1)):Bt("",!0),y(t).selectedAntennas.has(d.id)?(I(),fe("div",Iw)):Bt("",!0),R(y(ze),{onClick:h=>a(d.id,u),variant:"ghost",size:"icon",class:"h-7 w-7"},{default:P(()=>[R(y(ri),{class:"w-4 h-4 text-destructive"})]),_:2},1032,["onClick"])]))),128))])):(I(),fe("p",Pw," Use the 'Add Antenna' tool or populate a zone. "))]))}}),Ow={key:0,class:"text-sm text-muted-foreground"},Lw={key:1,class:"space-y-2"},Fw={class:"flex items-baseline gap-2"},Bw={class:"font-medium"},Nw=L({__name:"MeasurementsSection",setup(r){const e=ns(),{draw:t}=vs(),s=i=>{const o=i.end.x-i.start.x,a=i.end.y-i.start.y,l=e.metersPerPx?Math.hypot(o,a)*e.metersPerPx:null;return l?`${l.toFixed(2)} m`:"? m"},n=i=>{e.deleteMeasure(i),t()};return(i,o)=>(I(),fe("div",null,[o[0]||(o[0]=ne("h3",{class:"text-lg font-semibold mb-2"},"Measurements",-1)),y(e).measures.length?(I(),fe("ul",Lw,[(I(!0),fe(Kt,null,yn(y(e).measures,a=>(I(),fe("li",{key:a.id,class:"flex items-center justify-between text-sm"},[ne("div",Fw,[ne("span",Bw,"M"+ut(a.id)+":",1),ne("span",null,ut(s(a)),1)]),R(y(ze),{onClick:l=>n(a.id),variant:"ghost",size:"icon",class:"h-7 w-7"},{default:P(()=>[R(y(ri),{class:"w-4 h-4 text-destructive"})]),_:2},1032,["onClick"])]))),128))])):(I(),fe("p",Ow," Use the 'Measure' tool to create measurements. "))]))}}),$w={class:"flex h-full flex-col border-l bg-background p-4 gap-6 overflow-y-auto"},qw=L({__name:"PropertiesPanel",setup(r){return(e,t)=>(I(),fe("aside",$w,[t[0]||(t[0]=ne("div",{class:"flex h-16 items-center border-b px-2"},[ne("h2",{class:"text-xl font-semibold"},"Properties")],-1)),R(pw),R(Tw),R(Rw),R(Nw)]))}}),Hw={class:"grid h-screen w-full grid-cols-[240px_1fr_380px] bg-muted/40"},Ww=L({__name:"Home",setup(r){return(e,t)=>(I(),N(y(hm),{"delay-duration":100},{default:P(()=>[ne("div",Hw,[R(ow),R(hw),R(qw)])]),_:1}))}});export{Ww as default};
